#define a.chest o3#define open.close.chest    f34#define near.chest  f35if (newRoom)  {  load.sound(Sound29);  load.logics(lgc.dracula);  load.view(View8);  load.view(View54);  load.pic(currentRoom);  draw.pic(currentRoom);  animate.obj(a.chest);  set.view(a.chest, View54);  if (castle.chest.state == 2)    {    set.cel(a.chest, 3);    }  else    {    set.cel(a.chest, 0);    }  position(a.chest, 124, 126);  set.priority(a.chest, 11);  draw(a.chest);  stop.cycling(a.chest);  position(ego, 47, 165);  set.loop(ego, 0);  draw(ego);  start.motion(ego);  ignore.objs(ego);  set.horizon(96);  show.pic();  }if (egoHitSpecial)  {  if (!posn(ego, 80, 0, 159, 167))    {    sound(Sound29, done);    set(keep.cycling);    set.view(ego, View8);    work = 2;    cycle.time(ego, work);    work = 3;    step.size(ego, work);    v60 = 1;    set.priority(ego, 15);    move.obj(ego, 36, 154, 4, f145);    }  else    {    set(near.chest);    }  }else  {  reset(near.chest);  }if (open.close.chest)  {  reset(open.close.chest);  if (castle.chest.state == 1)    {    castle.chest.state = 2;    if (!got.tiara)      {      print("With a creak and a groan, the old lid opens, dragging cobwebs with "            "it.");      print("Looking into the interior of the musty chest, you see a dazzling "            "diamond and sapphire tiara!");      }    else      {      print("You open the heavy lid of the dusty old chest and peer into it.");      print("It is empty.");      }    }  else    {    castle.chest.state = 1;    }  }if (!haveInput)  {  goto(Label1);  }if ((said("check out") ||     said("check out", "antique shop") ||     said("check out", "swim")))  {  print("There is not much here at the top of the tower but an aging chest "        "against the wall.");  }if (said("look in", "chest"))  {  if (castle.chest.state != 2)    {    print("The dusty old chest is closed.");    }  else    {    if (!got.tiara)      {      print("Looking into the interior of the musty chest, you see a dazzling "            "diamond and sapphire tiara!");      }    else      {      print("It is empty.");      }    }  }if (said("check out", "chest"))  {  if (castle.chest.state != 2)    {    print("The dusty old chest is closed.");    }  else    {    print("The dusty old chest is open.");    }  }if (said("unlock", "chest"))  {  if (castle.chest.state == 0)    {    if (has("Silver Key"))      {      if (near.chest)        {        print("With hands trembling, you fit the little silver key into the "              "lock. Slowly, you turn it until you hear a click. The old chest "              "is now unlocked.");        castle.chest.state = 1;        ++currentScore;        }      else        {        print("You can't reach it from where you are standing.");        }      }    else      {      print("You do not have the key that will unlock this old chest.");      }    }  else    {    print("The aging chest is already unlocked.");    }  }if (said("open", "chest"))  {  if (castle.chest.state != 2)    {    if (isset(near.chest))      {      if (castle.chest.state == 0)        {        print("The old chest is locked shut. You need to unlock it.");        }      else        {        end.of.loop(a.chest, open.close.chest);        }      }    else      {      print("You can't reach it from where you are standing.");      }    }  else    {    print("The aging chest is already open.");    }  }if (said("close", "chest"))  {  if (castle.chest.state == 2)    {    if (near.chest)      {      reverse.loop(a.chest, open.close.chest);      }    else      {      print("You can't reach it from where you are standing.");      }    }  else    {    print("The aging chest is already closed.");    }  }if (said("acquire", "diamond and sapphire tiara"))  {  if (!got.tiara &&       castle.chest.state == 2)    {    if (near.chest)      {      print("You pick it up and carry it with you.");      get("Tiara");      set(got.tiara);      currentScore  += 7;      }    else      {      print("You can't reach it from where you are standing.");      }    }  else    {    if (has("Tiara"))      {      print("You already have it.");      }    else      {      print("You don't see it here.");      }    }  }if (said("acquire", "chest"))  {  print("You couldn't possibly carry this heavy chest around with you.");  }if (said("break", "chest"))  {  if (near.chest)    {    print("This old chest is stronger than it looks.");    }  else    {    print("You can't reach it from where you are standing.");    }  }if (said("check out", "stairs"))  {  print("The stairs spiral steeply downward. Be careful, you don't want to "        "fall.");  }Label1:if ((posn(ego, 41, 164, 46, 167) ||     v60 > 0))  {  observe.objs(ego);  new.room(Logic63); [ ##LE001##  }call(lgc.dracula);return();[ Messages#message 1 "There is not much here at the top of the tower but an aging chest against the wall."#message 2 "The dusty old chest is closed."#message 3 "The dusty old chest is open."#message 4 "The old chest is locked shut. You need to unlock it."#message 5 "With a creak and a groan, the old lid opens, dragging cobwebs with it."#message 6 "You open the heavy lid of the dusty old chest and peer into it."#message 7 "The aging chest is already open."#message 8 "The aging chest is already closed."#message 9 "You do not have the key that will unlock this old chest."#message 10 "The aging chest is already unlocked."#message 11 "With hands trembling, you fit the little silver key into the lock. Slowly, you turn it until you hear a click. The old chest is now unlocked."#message 12 "You couldn't possibly carry this heavy chest around with you."#message 13 "It is empty."#message 14 "You pick it up and carry it with you."#message 15 "The bed looks too lumpy and dusty. You wouldn't want to."#message 16 "You can't reach it from where you are standing."#message 17 "The stairs spiral steeply downward. Be careful, you don't want to fall."#message 18 "You don't see it here."#message 19 "You already have it."#message 20 "Looking into the interior of the musty chest, you see a dazzling diamond and sapphire tiara!"#message 21 "This old chest is stronger than it looks."
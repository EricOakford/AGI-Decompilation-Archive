#define ghost.1 o2#define ghost.2 o3#define a.door  o4#define catch.ego   f30#define move.to.thorns  f31#define possess.ego f32#define door.opens  f33#define turn.to.zombie  f36#define ego.is.zombie   f37#define music.done f40#define moan.sound  f41#define prevent.entry   f45#define dist.to.door v41if (newRoom)  {  load.sound(m.thriller);  load.sound(Sound21);  load.sound(Sound32);  load.view(View15);  load.view(View16);  load.view(View94);  load.view(View17);  load.view(View93);  load.view(View91);  load.logics(lgc.poison.lake);  load.logics(lgc.thorns);  load.pic(currentRoom);  draw.pic(currentRoom);  call(lgc.poison.lake);  animate.obj(ghost.1);  animate.obj(ghost.2);  animate.obj(a.door);  set.view(a.door, View15);  set.view(ego, View0);  set.view(ghost.1, View16);  set.view(ghost.2, View16);  set.cel(a.door, 0);  set.priority(a.door, 5);  position(a.door, 68, 142);  position(ghost.1, 67, 130);  position(ghost.2, 73, 115);  position(ego, 49, 166);  work = 2;  cycle.time(a.door, work);  cycle.time(ghost.1, work);  cycle.time(ghost.2, work);  if (previousRoom == 61)    {    position(ego, 71, 146);    set.loop(ego, 2);    }  ignore.blocks(ego);  draw(ego);  draw(a.door);  stop.cycling(a.door);  if (ghosts.guard.castle)    {    draw(ghost.1);    draw(ghost.2);    }  show.pic();  if (ghosts.guard.castle)    {    print("There are two spooky ghosts guarding the door of the gloomy castle. "          "This situation looks bad.");    follow.ego(ghost.1, 10, catch.ego);    wander(ghost.2);    sound(m.thriller, music.done);    }  }if ((!haveInput || possess.ego || turn.to.zombie || ego.is.zombie))  {  goto(Label3);  }if ((said("check out", "antique shop") ||     said("check out")))  {  print("The castle looks cold and forbidding. Two dark towers rise on either "        "side of it. The castle is surrounded by deadly thorns and brambles.");  }if (said("check out", "door"))  {  print("The heavy wooden door of the castle is closed.");  }if (said("check out", "island"))  {  print("There is a dark castle set in the middle of the dismal island. Thorns "        "and brambles grow everywhere. The stink of the foul lake is "        "oppressive.");  }if (has("Oil Lamp") &&     said("pat", "lamp"))  {  print("You rub and rub, but nothing happens!");  }if (has("Carpet") &&     said("anyword", "carpet"))  {  print("Evil forces prevent you from doing that.");  }if (!ghosts.guard.castle)  {  goto(Label1);  }if (said("check out", "ghost"))  {  print("These ghostly apparitions guard an evil being lurking within the "        "castle walls.");  }if ((said("capture", "ghost") ||     said("acquire", "ghost")))  {  print("Are you kidding!? How do you capture a ghost?");  }if (said("kill", "ghost"))  {  print("Don't you know that spooks are already dead?");  }if ((said("speak", "ghost") ||     said("hello", "anyword") ||     said("say", "hello")))  {  print("When you speak to the ghosts they utter a mournful wail.");  }Label1:if (ghosts.guard.castle)  {  if (said("anyword", "door"))    {    print("The ghosts won't let you reach the door.");    goto(Label2);    }  }if ((said("open", "door") ||     said("knock", "door")))  {  distance(ego, a.door, dist.to.door);  if (dist.to.door > 15)    {    print("Your arms won't reach.");    goto(Label2);    }  else    {    reset(haveMatch);    if (said("knock", "door"))      {      print("When you knock on the wooden door of the castle, the sound echoes "            "inside. There is no answer.");      }    else      {      sound(Sound21, done);      end.of.loop(a.door, door.opens);      set(haveMatch);      }    }  }if (said("anyword", "tree"))  {  print("There are no trees on this island. Only brambles and thorns.");  }Label2:if (said("give", "anyword"))  {  print("The spooks want nothing but you gone!");  }Label3:if (catch.ego)  {  reset(catch.ego);  if (wearing.ring && wearing.cloak)    {    print("The two spirits are fooled by the black cloak and the large ruby "          "ring that you are wearing. They slowly float away.... Maybe you "          "remind them of someone else.");    goto(Label4);    }  else    {    if (wearing.cross)      {      print("The two spirits are afraid of the silver cross you are wearing "            "around your neck. They slowly float away and disappear.");      goto(Label4);      }    else      {      reset(ghosts.guard.castle);      set(possess.ego);      print("Oh, no! The two spooks float toward you and enter your body. In a "            "trance, you walk toward the thorn covered brambles.");      program.control();      set(prevent.entry);      }    }  }goto(Label5);Label4:reset(ghosts.guard.castle);set.view(ghost.1, View17);set.view(ghost.2, View17);end.of.loop(ghost.1, lf8);end.of.loop(ghost.2, done);goto(Label5);Label5:if (possess.ego)  {  reset(possess.ego);  set.view(ghost.1, View17);  set.cel(ghost.1, 0);  set.view(ghost.2, View17);  set.cel(ghost.2, 0);  end.of.loop(ghost.1, lf8);  end.of.loop(ghost.2, done);  start.motion(ego);  program.control();  set.view(ego, View93);  work = 2;  cycle.time(ego, work);  set(keep.cycling);  set.cel(ego, 0);  end.of.loop(ego, turn.to.zombie);  }if (turn.to.zombie)  {  reset(turn.to.zombie);  set(ego.is.zombie);  set.view(ego, View94);  work = 3;  cycle.time(ego, work);  get.posn(ego, temp.x, temp.y);  temp.x = 0;  if (temp.y < 146)    {    temp.y = 146;    }  if (sugar.cube.timer.2 > 0)    {    sugar.cube.timer = 0;    sugar.cube.timer.2 = 2;    }  dist.to.door = 0;  move.obj.v(ego, temp.x, temp.y, dist.to.door, move.to.thorns);  ignore.blocks(ego);  }if (ego.is.zombie && !move.to.thorns)  {  get.posn(ego, temp.x, temp.y);  if (temp.y < 146 &&       temp.x == delta.x &&       temp.y == delta.y)    {    delta.y  += 1;    temp.x = 0;    temp.y = 1;    reposition(ego, temp.x, temp.y);    stop.motion(ego);    }  else    {    delta.x = temp.x;    delta.y = temp.y;    }  }if (isset(f44))  {  reset(f44);  stop.update(ghost.2);  stop.update(ghost.1);  }if (isset(lf8))  {  reset(lf8);  set(f44);  set.priority(ghost.2, 4);  set.priority(ghost.1, 4);  }if (door.opens)  {  if (!isset(prevent.entry))    {    new.room(Logic61); [ ##LE001##    }  }if (edgeEgoHit == BOTTOM_EDGE)  {  observe.blocks(ego);  new.room(Logic25); [ ##LE002##  }if (ghosts.guard.castle && moan.sound)  {  sound(Sound32, moan.sound);  }if (music.done)  {  reset(music.done);  set(moan.sound);  }call(lgc.poison.lake);call(lgc.thorns);return();[ Messages#message 1 "The castle looks cold and forbidding. Two dark towers rise on either side of it. The castle is surrounded by deadly thorns and brambles."#message 2 "The heavy wooden door of the castle is closed."#message 3 "These ghostly apparitions guard an evil being lurking within the castle walls."#message 4 "There is a dark castle set in the middle of the dismal island. Thorns and brambles grow everywhere. The stink of the foul lake is oppressive."#message 5 "There are two spooky ghosts guarding the door of the gloomy castle. This situation looks bad."#message 6 "The two spirits are fooled by the black cloak and the large ruby ring that you are wearing. They slowly float away.... Maybe you remind them of someone else."#message 7 "The two spirits are afraid of the silver cross you are wearing around your neck. They slowly float away and disappear."#message 8 "Oh, no! The two spooks float toward you and enter your body. In a trance, you walk toward the thorn covered brambles."#message 9 "Are you kidding!? How do you capture a ghost?"#message 10 "Don't you know that spooks are already dead?"#message 11 "When you speak to the ghosts they utter a mournful wail."#message 12 "When you knock on the wooden door of the castle, the sound echoes inside. There is no answer."#message 13 "The ghosts won't let you reach the door."#message 14 "Your arms won't reach."#message 15 "There are no trees on this island. Only brambles and thorns."#message 16 "The spooks want nothing but you gone!"#message 17 "You rub and rub, but nothing happens!"#message 18 "Evil forces prevent you from doing that."
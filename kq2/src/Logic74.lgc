#define a.trunk o2#define a.fire  o3#define a.dwarf o4#define dwarf.is.home f33#define catch.ego   f34#define throw.him.out   f35#define trunk.open  f36#define burn.msg    f37if (newRoom)  {  load.view(View78);  load.view(View28);  load.view(View76);  load.view(View77);  load.view(View115);  load.sound(m.badguy);  load.pic(currentRoom);  draw.pic(currentRoom);  animate.obj(a.fire);  animate.obj(a.trunk);  work = 3;  cycle.time(a.trunk, work);  animate.obj(a.dwarf);  work = 3;  step.size(a.dwarf, work);  position(a.fire, 47, 111);  if (took.soup)    {    set.view(a.fire, View77);    }  else    {    set.view(a.fire, View76);    }  draw(a.fire);  random(0, 255, work);  reset(dwarf.is.home);  if (fairy.spell.timer == 0 &&       fairy.spell.timer.2 == 0)    {    if (work < 185)      {      set(dwarf.is.home);      set.view(a.dwarf, View28);      position(a.dwarf, 50, 119);      follow.ego(a.dwarf, 7, catch.ego);      draw(a.dwarf);      }    }  set.priority(a.trunk, 12);  position(a.trunk, 105, 141);  set.view(a.trunk, View78);  if (trunk.state == 0)    {    set.cel(a.trunk, 0);    }  else    {    set.cel(a.trunk, 3);    }  ignore.objs(a.trunk);  ignore.objs(a.dwarf);  ignore.objs(ego);  draw(a.trunk);  stop.cycling(a.trunk);  get.posn(ego, work.2, work.3);  if (work.3 < 117)    {    work.3 = 117;    position.v(ego, work.2, work.3);    }  draw(ego);  show.pic();  if (dwarf.is.home)    {    sound(m.badguy, done);    print("You have stumbled onto the home of the thieving dwarf! Unfortunately "          "for you, he is home!");    }  }if ((said("check out", "antique shop") ||     said("check out", "area") ||     said("check out")))  {  if (took.soup)    {    print("It seems you have entered the underground home of the little dwarf. "          "It is cozy, with a fire crackling in the hearth. There is a trunk "          "tucked away in the corner.");    }  else    {    print("It seems you have entered the underground home of the little dwarf. "          "It is cozy, with a fire crackling in the hearth. A pot of chicken "          "soup bubbling above the fire gives a delicious aroma to the room. "          "There is a trunk tucked away in the corner.");    }  }if (said("check out", "fire"))  {  if (took.soup)    {    print("The fire is crackling merrily in the fireplace.");    }  else    {    print("There is a pot of chicken soup boiling over the fire.");    }  }if (said("check out", "chest"))  {  print("The trunk looks old and worn. The hinges are loose.");  }if (said("check out", "cap"))  {  print("The stocking hats of the dwarf are sitting on the table.");  }if (!haveMatch &&     said("anyword", "cap"))  {  print("Those hats wouldn't fit you.");  }if ((said("open", "chest") ||     said("lift", "lid")))  {  if (!posn(ego, 95, 120, 122, 147))    {    print("You are too far away.");    }  else    {    if (trunk.state == 1)      {      print("The trunk lid is already open.");      }    if (trunk.state == 0)      {      end.of.loop(a.trunk, done);      trunk.state = 1;      set(trunk.open);      }    }  }if ((said("close", "chest") ||     said("close", "lid")))  {  if (!posn(ego, 95, 120, 122, 147))    {    print("You are too far away.");    }  else    {    if (trunk.state == 0)      {      print("The lid of the trunk is already closed.");      }    if (trunk.state == 1)      {      reverse.loop(a.trunk, done);      trunk.state = 0;      }    }  }if (said("look in", "chest"))  {  if (trunk.state != 1)    {    print("You will have to open it to see inside.");    }  else    {    if ((dwarf.stole.earrings ||         !took.earrings ||         dwarf.stole.bracelet ||         dwarf.stole.necklace ||         dwarf.stole.brooch ||         dwarf.stole.tiara))      {      print("You look inside and notice...");      if ((dwarf.stole.earrings || !took.earrings))        {        print("earrings");        }      if (dwarf.stole.bracelet)        {        print("bracelet");        }      if (dwarf.stole.necklace)        {        print("necklace");        }      if (dwarf.stole.brooch)        {        print("brooch");        }      if (dwarf.stole.tiara)        {        print("tiara");        }      }    else      {      print("You look inside and notice...nothing.");      }    }  }if (!took.soup &&     (said("acquire", "broth") ||     said("acquire", "cauldron")))  {  distance(ego, a.fire, work);  if (work > 15)    {    print("You are too far away.");    }  else    {    print("You grab the wooden handle of the bubbling pot of chicken soup. You "          "take the pot with you.");    get("Chicken Soup");    set.view(a.fire, View77);    set(took.soup);    currentScore  += 2;    }  }if (trunk.state == 1 &&     said("acquire", "earrings"))  {  if ((dwarf.stole.earrings || !took.earrings))    {    set(took.earrings);    reset(dwarf.stole.earrings);    print("You reach into the trunk and get it.");    get("Earrings");    currentScore  += 7;    }  else    {    reset(haveMatch);    }  }if (trunk.state == 1 &&     dwarf.stole.bracelet &&     said("acquire", "bracelet"))  {  print("You reach into the trunk and get it.");  reset(dwarf.stole.bracelet);  get("Bracelet");  currentScore  += 7;  }if (trunk.state == 1 &&     dwarf.stole.necklace &&     said("acquire", "diamond and sapphire necklace"))  {  reset(dwarf.stole.necklace);  print("You reach into the trunk and get it.");  get("Necklace");  currentScore  += 7;  }if (trunk.state == 1 &&     dwarf.stole.brooch &&     said("acquire", "brooch"))  {  print("You reach into the trunk and get it.");  reset(dwarf.stole.brooch);  get("Brooch");  currentScore  += 7;  }if (trunk.state == 1 &&     dwarf.stole.tiara &&     said("acquire", "diamond and sapphire tiara"))  {  reset(dwarf.stole.tiara);  print("You reach into the trunk and get it.");  get("Tiara");  currentScore  += 7;  }if (posn(ego, 40, 113, 64, 130) &&     said("light", "candle"))  {  set(candle.lit);  }if (posn(ego, 40, 113, 64, 120))  {  if (!burn.msg)    {    print("OUCH!!!! This fire is HOT! You're going to burn yourself.");    set(burn.msg);    }  }else  {  reset(burn.msg);  }if (edgeEgoHit == LEFT_EDGE)  {  new.room(Logic73); [ ##LE001##  }if (catch.ego)  {  reset(catch.ego);  set.view(ego, View115);  if (posn(ego, 16, 117, 60, 167))    {    erase(ego);    get.posn(ego, work.2, work.3);    work.2 -= 15;    position.v(ego, work.2, work.3);    draw(ego);    }  stop.motion(ego);  set(keep.cycling);  end.of.loop(ego, throw.him.out);  set.priority(ego, 15);  ignore.objs(ego);  }if (throw.him.out)  {  reset(keep.cycling);  reset(throw.him.out);  set.view(ego, View0);  release.priority(ego);  new.room(Logic46); [ ##LE002##  }return();[ Messages#message 1 "You have stumbled onto the home of the thieving dwarf! Unfortunately for you, he is home!"#message 2 "It seems you have entered the underground home of the little dwarf. It is cozy, with a fire crackling in the hearth. A pot of chicken soup bubbling above the fire gives a delicious aroma to the room. There is a trunk tucked away in the corner."#message 3 "It seems you have entered the underground home of the little dwarf. It is cozy, with a fire crackling in the hearth. There is a trunk tucked away in the corner."#message 4 "There is a pot of chicken soup boiling over the fire."#message 5 "The fire is crackling merrily in the fireplace."#message 6 "The trunk looks old and worn. The hinges are loose."#message 7 "You look inside and notice..."#message 8 "You look inside and notice...nothing."#message 9 "The trunk lid is already open."#message 10 "earrings"#message 11 "bracelet"#message 12 "necklace"#message 13 "brooch"#message 14 "tiara"#message 15 "The lid of the trunk is already closed."#message 16 "You grab the wooden handle of the bubbling pot of chicken soup. You take the pot with you."#message 17 "You reach into the trunk and get it."#message 19 "You are too far away."#message 20 "You will have to open it to see inside."#message 21 "The stocking hats of the dwarf are sitting on the table."#message 22 "Those hats wouldn't fit you."#message 23 "OUCH!!!! This fire is HOT! You're going to burn yourself."
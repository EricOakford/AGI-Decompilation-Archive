#define a.gnome o1#define a.beans   o2#define a.key   o3#define beans.in.room   f20#define key.in.room     f21#define gnome.asks  f22#define gnome.in.room   f23#define see.gnome.msg   f24#define drown.msg f25if (newRoom)  {  load.pic(currentRoom);  draw.pic(currentRoom);  discard.pic(currentRoom);  set.horizon(42);  load.logics(lgc.swim);  call(lgc.swim);  ignore.blocks(ego);  if (gnome.reward <= 0)    {    load.view(View27);    animate.obj(a.gnome);    set.view(a.gnome, View27);    position(a.gnome, 34, 104);    observe.blocks(a.gnome);    wander(a.gnome);    load.view(View29);    animate.obj(a.beans);    set.view(a.beans, View29);    position(a.beans, 39, 118);    ignore.objs(a.beans);    load.view(View28);    animate.obj(a.key);    set.view(a.key, View28);    position(a.key, 39, 118);    ignore.objs(a.key);    }  if (gnome.reward == 1 &&       took.gnome.reward != 2)    {    set(beans.in.room);    load.view(View29);    animate.obj(a.beans);    set.view(a.beans, View29);    position(a.beans, 39, 118);    }  if (gnome.reward == 2 &&       took.gnome.reward != 1)    {    set(key.in.room);    load.view(View28);    animate.obj(a.key);    set.view(a.key, View28);    position(a.key, 39, 118);    }  if (gnome.reward <= 0)    {    draw(a.gnome);    set(gnome.in.room);    }  if (key.in.room)    {    draw(a.key);    stop.update(a.key);    }  if (beans.in.room)    {    draw(a.beans);    stop.update(a.beans);    }  set(deadly.water);  draw(ego);  show.pic();  }if (said("check", "building"))  {  print("The gnome's lean-to doesn't look very sturdy.");  }if (gnome.in.room && !see.gnome.msg)  {  print("You see a crotchety old gnome pacing around his lean-to.");  set(see.gnome.msg);  }if (gnome.in.room)  {  distance(ego, a.gnome, work);  if (gnome.asks)    {    if ((said("speak", "dwarf") ||         said("hello") ||         said("say", "hello")))      {      if (work < 50)        {        print("You still haven't guessed my name!");        goto(Label1);        }      else        {        print("The gnome can't hear you from there.");        goto(Label1);        }      }    }  if (!gnome.asks)    {    if ((said("speak", "dwarf") ||         said("hello") ||         said("say", "hello")))      {      if (work < 50)        {        set(gnome.asks);        print("The old gnome tells you he has something that may be very useful "              "to you.  Your task is to guess his name in three guesses and his "              "gift will be yours.  Good luck!  What is your first guess?");        goto(Label1);        }      else        {        print("The gnome can't hear you from there.");        goto(Label1);        }      }    }  if (said("check", "dwarf"))    {    if (work < 80)      {      print("The gnome is old and bent under the weight of years, but a playful "            "wisdom still brightens his eyes.");      goto(Label1);      }    else      {      print("You should get a little closer.");      goto(Label1);      }    }  if (said("kill", "dwarf"))    {    print("It would be unwise to kill a gnome.");    goto(Label1);    }  }if (gnome.asks)  {  if (said("rumpelstiltskin") &&       gnome.guesses != 2)    {    print("That is very close but not quite right!");    ++gnome.guesses;    goto(Label1);    }  if (said("nikstlitselpmur") && [ became a valid response in the remake      gnome.guesses != 2)    {    print("You have the right idea, but your thinking is just a little bit off.");    ++gnome.guesses;    goto(Label1);    }  if (said("mikel") &&       gnome.guesses != 2)    {    print("What do you think I am, a car?  This also won't get you a raise.  "          "Nice try.");    ++gnome.guesses;    goto(Label1);    }  if (said("ifnkovhgroghprm"))  [ this can't even be pronounced!    {    erase(a.gnome);    reset(gnome.asks);    reset(gnome.in.room);    draw(a.beans);    set(beans.in.room);    stop.update(a.beans);    gnome.reward = 1;    print("That's right!!!  You've guessed it!!  Here are some magic beans for "          "your outstanding accomplishment!");    if (gnome.guesses <= 0)      {      currentScore  += 5;      }    if (gnome.guesses == 1)      {      currentScore  += 4;      }    if (gnome.guesses == 2)      {      currentScore  += 3;      }    goto(Label1);    }  if (gnome.guesses <= 0)    {    if ((said("anyword") ||         said("anyword", "anyword")))      {      accept.input();      print("Where did you get that idea?  That's not even close!");      ++gnome.guesses;      goto(Label1);      }    }  if (gnome.guesses == 1)    {    if ((said("anyword") ||         said("anyword", "anyword")))      {      accept.input();      print("You know that's not right!");      print("What is your next guess?");      ++gnome.guesses;      goto(Label1);      }    }  if (gnome.guesses == 2)    {    if ((said("anyword") ||         said("anyword", "anyword")))      {      accept.input();      erase(a.gnome);      reset(gnome.asks);      reset(gnome.in.room);      draw(a.key);      set(key.in.room);      stop.update(a.key);      gnome.reward = 2;      print("You didn't guess the gnome's name, but he left you a gold key "            "anyway.  Better luck next time!");      gnome.guesses = 3;      goto(Label1);      }    }  }if (!gnome.in.room)  {  if (said("anyword", "dwarf"))    {    print("There is no gnome here.");    }  if (beans.in.room)    {    distance(ego, a.beans, work.2);    if (said("check", "bean"))      {      if (work.2 > 40)        {        print("That's too far away.");        }      else        {        print("They look like beans.  Interesting.");        }      }    if (said("acquire", "bean"))      {      if (work.2 > 20)        {        print("That's too far away.");        }      else        {        print("Being careful that you get every one of them, you place the "              "beans in your pocket.");        reset(beans.in.room);        start.update(a.beans);        erase(a.beans);        set(have.beans);        get("beans");        took.gnome.reward = 2;        currentScore  += 4;        }      }    }  if (key.in.room)    {    distance(ego, a.key, work.3);    if (said("check", "gold key"))      {      if (work.3 > 40)        {        print("That's too far away.");        }      else        {        print("It is a heavy, gold, skeleton key.");        }      }    if (said("acquire", "gold key"))      {      if (work.3 > 20)        {        print("That's too far away.");        }      else        {        print("It is heavy and cold.");        reset(key.in.room);        start.update(a.key);        erase(a.key);        set(have.gold.key);        get("key");        took.gnome.reward = 1;        currentScore  += 3;        }      }    }  }if (!beans.in.room && !have.beans)  {  if (said("anyword", "bean"))    {    print("There are no beans here.");    }  }if (!key.in.room && !have.gold.key)  {  if (said("anyword", "gold key"))    {    print("The key to your problems is elsewhere.");    }  }if (onWater && !drown.msg)  {  set(drown.msg);  print("You slip down the bank into the river far below.  Your cries for help "        "are not heard.");  }if (drown.swim <= 0 && onWater)  {  delta.x = 255;  if (posn(ego, 0, 34, 34, 67))    {    delta.x = 6;    delta.y = 54;    }  if (delta.x == 255)    {    delta.x = 0;    }  else    {    get.posn(ego, temp.x, temp.y);    delta.x -= temp.x;    delta.y -= temp.y;    set(override.splash.loc);    }  }if (!have.water && !onWater && !drank.water)  {  if ((said("drink", "water") ||       said("acquire", "drink")))    {    print("There is no place to safely get a drink.");    }  }if (!have.water && have.bucket && !onWater &&     said("acquire", "water"))  {  print("There is no place to safely get water.");  }Label1:if (edgeEgoHit == TOP_EDGE)  {  new.room(Logic41);  }if (edgeEgoHit == RIGHT_EDGE)  {  new.room(Logic39);  }if (edgeEgoHit == LEFT_EDGE)  {  new.room(Logic33);  }if (edgeEgoHit == BOTTOM_EDGE)  {  new.room(Logic25);  }call(lgc.swim);return();[ Messages#message 1 "You see a crotchety old gnome pacing around his lean-to."#message 2 "That is very close but not quite right!"#message 3 "You have the right idea, but your thinking is just a little bit off."#message 4 "That's right!!!  You've guessed it!!  Here are some magic beans for your outstanding accomplishment!"#message 5 "The old gnome tells you he has something that may be very useful to you.  Your task is to guess his name in three guesses and his gift will be yours.  Good luck!  What is your first guess?"#message 6 "You still haven't guessed my name!"#message 7 "The gnome is old and bent under the weight of years, but a playful wisdom still brightens his eyes."#message 8 "They look like beans.  Interesting."#message 9 "It is a heavy, gold, skeleton key."#message 10 "It would be unwise to kill a gnome."#message 11 "Being careful that you get every one of them, you place the beans in your pocket."#message 12 "It is heavy and cold."#message 13 "The gnome can't hear you from there."#message 14 "You should get a little closer."#message 15 "There are no beans here."#message 16 "The key to your problems is elsewhere."#message 17 "There is no gnome here."#message 18 "That's too far away."#message 19 "Where did you get that idea?  That's not even close!"#message 20 "You know that's not right!"#message 21 "What is your next guess?"#message 22 "You didn't guess the gnome's name, but he left you a gold key anyway.  Better luck next time!"#message 23 "There is no place to safely get a drink."#message 24 "There is no place to safely get water."#message 25 "You slip down the bank into the river far below.  Your cries for help are not heard."#message 26 "The gnome's lean-to doesn't look very sturdy."#message 27 "What do you think I am, a car?  This also won't get you a raise.  Nice try."
#define a.note  o1#define a.cabinet   o2#define a.cheese    o3#define a.witch o4#define dropped.in.cage f20#define witch.at.oven   f21#define stun.done   f22#define ego.prisoner    f25#define witch.catch.ego f26#define witch.already.home  f27#define witch.came.home f29#define too.close  f30#define music.played  f32#define fall.sound.played   f33#define witch.timer.1   v30#define witch.timer.2   v31#define stun.timer  v32#define cage.timer  v33#define dist.from.witch v34if (newRoom)  {  load.pic(currentRoom);  draw.pic(currentRoom);  discard.pic(currentRoom);  load.sound(m.badguy);  load.sound(Sound4);  load.sound(s.ego.fall);  if (!have.note)    {    load.view(View42);    animate.obj(a.note);    set.view(a.note, View42);    position(a.note, 118, 140);    set.priority(a.note, 14);    }  if (cheese.cabinet.state == 2)    {    load.view(View40);    animate.obj(a.cabinet);    set.view(a.cabinet, View40);    position(a.cabinet, 33, 76);    set.cel(a.cabinet, 0);    stop.cycling(a.cabinet);    }  if (cheese.cabinet.state == 0)    {    load.view(View40);    animate.obj(a.cabinet);    set.view(a.cabinet, View40);    position(a.cabinet, 33, 76);    set.cel(a.cabinet, 0);    stop.cycling(a.cabinet);    load.view(View41);    animate.obj(a.cheese);    set.view(a.cheese, View41);    position(a.cheese, 41, 61);    set.priority(a.cheese, 8);    }  if (cheese.cabinet.state == 3)    {    load.view(View40);    animate.obj(a.cabinet);    set.view(a.cabinet, View40);    position(a.cabinet, 33, 76);    set.cel(a.cabinet, 5);    stop.cycling(a.cabinet);    }  if (cheese.cabinet.state == 1)    {    load.view(View40);    animate.obj(a.cabinet);    set.view(a.cabinet, View40);    position(a.cabinet, 33, 76);    set.cel(a.cabinet, 5);    stop.cycling(a.cabinet);    load.view(View41);    animate.obj(a.cheese);    set.view(a.cheese, View41);    position(a.cheese, 41, 61);    set.priority(a.cheese, 8);    }  if (previousRoom == 80)    {    load.view(View105);    load.view(View103);    load.view(View104);    set.view(ego, View105);    ignore.blocks(ego);    position(ego, 80, 45);    set(keep.cycling);    set(ego.prisoner);    program.control();    move.obj(ego, 80, 84, 6, dropped.in.cage);    witch.state = witchOUT;    }  if (previousRoom == 28)    {    position(ego, 49, 163);    }  if (!protected.spell &&       witch.state != witchDEAD &&       previousRoom != 80 &&       !ego.invisible)    {    if (witch.state == witchOUT)      {      random(0, 250, work);      if (work < 180)        {        load.view(View43);        animate.obj(a.witch);        set.view(a.witch, View43);        witch.timer.1 = 250;        witch.timer.2 = 3;        }      }    }  if (witch.state == witchHOME)    {    if (!protected.spell && !ego.invisible)      {      set(witch.already.home);      load.view(View43);      animate.obj(a.witch);      set.view(a.witch, View43);      position(a.witch, 26, 120);      }    }  if (!have.note)    {    draw(a.note);    stop.update(a.note);    }  draw(a.cabinet);  if (cheese.cabinet.state == 1)    {    draw(a.cheese);    }  ignore.blocks(ego);  observe.blocks(a.witch);  draw(ego);  show.pic();  if (protected.spell)    {    print("Be thankful that you have a protective spell or the witch may have "          "stuck around to try and catch you!");    }  if (ego.invisible)    {    print("Be thankful that you are invisible or the witch may have stuck "          "around to try and catch you!");    }  if (witch.already.home)    {    draw(a.witch);    follow.ego(a.witch, 10, witch.catch.ego);    print("Surprise!  Surprise!  The wicked witch is home and now she's after "          "you!");    }  }if (witch.already.home && !music.played)  {  set(music.played);  sound(m.badguy, done);  }if (goat.following)  {  reset(goat.following);  set(goat.gone);  print("As soon as you entered the house the goat ran away.");  currentScore -= 5;  }if (witch.state == witchDEAD)  {  if (said("anyword", "witch"))    {    print("The witch is dead.");    }  }if (previousRoom == 80)  {  if (!dropped.in.cage && !lf13 && !witch.already.home)    {    sound(s.ego.fall, fall.sound.done);    set(lf13);    }  }--stun.timer;if (dropped.in.cage)  {  stop.sound();  set(lf14);  reset(dropped.in.cage);  observe.blocks(ego);  set.view(ego, View103);  shake.screen(1);  print("OUCH!");  stun.timer = 20;  set(keep.cycling);  sound(Sound4, sound.done);  }if (sound.done)  {  if (stun.timer > 0)    {    reset(sound.done);    sound(Sound4, sound.done);    }  }if (stun.timer == 1)  {  set.view(ego, View104);  end.of.loop(ego, stun.done);  print("As the wicked witch flew over her house, she dropped you... into her "        "cage!  If you can't get out, you may become the secret ingredient in "        "this witches' brew!");  player.control();  }--cage.timer;if (isset(stun.done))  {  reset(stun.done);  reset(keep.cycling);  set.view(ego, View0);  cage.timer = 100;  }if (cage.timer == 1)  {  if ((witch.already.home || witch.came.home))    {    print("With a flash, you hear her joyously exclaim, \"This has made me feel "          "like flying!\"");    erase(a.witch);    reset(witch.already.home);    }  else    {    print("Try as you will to escape, your labor will be in vain.");    }  set(fFlag95);  stop.cycling(ego);  set(certain.death);  }if (witch.already.home)  {  distance(ego, a.witch, dist.from.witch);  if (dist.from.witch == 30 &&       !too.close)    {    set(too.close);    stop.motion(ego);    print("Rats!  She has cast some spell to keep you from escaping!. The witch "          "remarks, \"Oh, how nice of you to come for dinner (cackle, cackle)\"");    }  if (witch.catch.ego)    {    reset(witch.catch.ego);    print("She pokes and pinches you, then states, \"This one is too scrawny, "          "so it's into the cage until you fatten up (smack, yum)!\"");    erase(ego);    position(ego, 80, 80);    draw(ego);    start.motion(ego);    set(stun.done);    set(ego.prisoner);    }  }--witch.timer.1;if (witch.timer.1 == 0)  {  if (witch.timer.2 > 0)    {    --witch.timer.2;    witch.timer.1 = 250;    }  }if (witch.timer.1 == 1 &&     witch.timer.2 == 3)  {  print("Off in the distance you hear a high, squeaky voice say, \"I can smell "        "someone tasty in my house.\"");  }if (witch.timer.1 == 1 &&     witch.timer.2 == 2)  {  position(a.witch, 49, 160);  draw(a.witch);  sound(m.badguy, done);  set(witch.came.home);  if (posn(ego, 105, 1, 158, 166))    {    move.obj(a.witch, 26, 120, 2, witch.at.oven);    set(lf11);    print("The witch mutters, \"I am going to get my oven ready to cook someone "          "for dinner (yum).\"");    }  }if (witch.came.home &&     !witch.at.oven &&     !isset(lf11))  {  witch.timer.1 = 0;  witch.timer.2 = 0;  if (posn(ego, 105, 1, 158, 166) &&       !fall.sound.played)    {    wander(a.witch);    }  else    {    if (!fall.sound.played)      {      set(fall.sound.played);      ignore.blocks(a.witch);      follow.ego(a.witch, 10, witch.catch.ego);      }    distance(ego, a.witch, dist.from.witch);    if (dist.from.witch < 30 &&         !too.close &&         !posn(ego, 105, 132, 158, 166))      {      set(too.close);      stop.motion(ego);      print("Rats!  She has cast some spell to keep you from escaping!. The "            "witch remarks, \"Oh, how nice of you to come for dinner (cackle, "            "cackle)\"");      }    if (witch.catch.ego)      {      reset(witch.catch.ego);      print("She pokes and pinches you, then states, \"This one is too scrawny, "            "so it's into the cage until you fatten up (smack, yum)!\"");      reposition.to(ego, 80, 80);      start.motion(ego);      set(stun.done);      set(ego.prisoner);      }    }  }if (witch.at.oven)  {  if (said("check", "witch"))    {    print("This ugly old witch is one of the most hideous sights you have ever "          "seen.  I would never trust her.");    }  distance(ego, a.witch, work.2);  if (work.2 < 15)    {    if ((said("move", "witch") ||         said("kill", "witch")))      {      erase(a.witch);      print("Courageously, you manage to push the witch into the oven where she "            "flashes and melts away into a harmless blob. Congratulations!");      witch.state = 3;      witch.timer.1 = 0;      witch.timer.2 = 0;      reset(witch.came.home);      reset(witch.at.oven);      currentScore  += 7;      }    }  if (work.2 > 14)    {    if ((said("move", "witch") ||         said("kill", "witch")))      {      print("You are in no position to do that!");      }    }  if (witch.timer.1 == 1 &&       witch.timer.2 == 3)    {    print("The witch mumbles, \"After I get the oven nice and hot, I will be "          "ready to have someone for dinner (giggle).\"");    }  if (witch.timer.1 == 1 &&       witch.timer.2 == 2)    {    print("The witch mutters, \"The oven is heating up nicely.  I wonder who "          "will be my dinner guest!\"");    }  if (witch.timer.1 == 1 &&       witch.timer.2 == 0)    {    witch.timer.1 = 0;    witch.timer.2 = 0;    print("The witch says, \"My oven is now the perfect temperature. It is time "          "to invite someone for dinner (cackle, cackle)!\"");    reset(witch.at.oven);    reset(lf11);    if (posn(ego, 100, 1, 158, 166))      {      wander(a.witch);      }    }  }if (!isset(witch.at.oven))  {  if ((isset(witch.came.home) ||       isset(witch.already.home)))    {    if (said("move", "witch"))      {      print("You are in no position to do that!");      }    if (said("kill", "witch"))      {      print("If I were you, I wouldn't try it!  This witch is mean!");      }    if (said("check", "witch"))      {      print("This ugly old witch is one of the most hideous sights you have "            "ever seen.  I would never trust her.");      }    }  }if (witch.state != witchDEAD)  {  if (!isset(witch.came.home) &&       !isset(witch.already.home))    {    if (said("anyword", "witch"))      {      print("There is no witch here...RIGHT NOW!!");      }    }  }if ((isset(witch.came.home) ||     isset(witch.already.home)))  {  if (said("speak", "witch"))    {    print("Now is not a good time to try and start a conversation!");    }  if ((said("hello") ||       said("say", "hello")))    {    print("Now is not a good time to try and start a conversation!");    }  }if (said("open", "cage"))  {  print("It is fastened with a very strong lock.  There is no way for you to "        "open it.");  }if (said("check", "building"))  {  print("The little house is surprisingly neat considering a wicked witch lives "        "here.");  }if (said("check", "room"))  {  print("You need to be more specific.");  }if (posn(ego, 23, 89, 55, 100))  {  if ((said("check", "cabinet") ||       said("look in", "cabinet")))    {    if (cheese.cabinet.state == 3)      {      print("There is nothing but a bare shelf here.");      }    if (cheese.cabinet.state == 1)      {      print("Sitting on the shelf is a delicious piece of Swiss cheese.");      }    if ((cheese.cabinet.state == 0 ||         cheese.cabinet.state == 2))      {      print("The cabinet on the wall is rather plain and simple.");      }    }  if (said("open", "cabinet"))    {    if ((cheese.cabinet.state == 1 ||         cheese.cabinet.state == 3))      {      print("It is already open.");      }    if (cheese.cabinet.state == 2)      {      start.cycling(a.cabinet);      end.of.loop(a.cabinet, done);      cheese.cabinet.state = 3;      }    if (cheese.cabinet.state == 0)      {      prevent.input();      start.cycling(a.cabinet);      end.of.loop(a.cabinet, lf4);      cheese.cabinet.state = 1;      if (!isset(opened.cabinet))        {        set(opened.cabinet);        currentScore  += 2;        }      }    }  if (said("close", "cabinet"))    {    if ((cheese.cabinet.state == 0 ||         cheese.cabinet.state == 2))      {      print("It is already closed.");      }    if (cheese.cabinet.state == 3)      {      reverse.loop(a.cabinet, done);      cheese.cabinet.state = 2;      }    if (cheese.cabinet.state == 1)      {      reverse.loop(a.cabinet, done);      erase(a.cheese);      cheese.cabinet.state = 0;      }    }  if (!have.cheese)    {    if (said("acquire", "cheese"))      {      if (cheese.cabinet.state == 1)        {        erase(a.cheese);        get("cheese");        set(have.cheese);        currentScore  += 2;        print("You pluck the Swiss cheese from the shelf.");        cheese.cabinet.state = 3;        }      if ((cheese.cabinet.state == 0 ||           cheese.cabinet.state == 2))        {        print("I don't see any here.");        }      }    if (said("check", "cheese"))      {      if ((cheese.cabinet.state == 0 ||           cheese.cabinet.state == 2))        {        print("I don't see any here.");        }      if (cheese.cabinet.state == 3)        {        print("I don't see any here.");        }      if (cheese.cabinet.state == 1)        {        print("Sitting on the shelf is a delicious piece of Swiss cheese.");        }      }    }  }if (!posn(ego, 23, 89, 55, 100))  {  if (said("check", "cabinet"))    {    print("You need to be a little closer for a good look.");    }  if ((said("open", "cabinet") ||       said("close", "cabinet")))    {    print("You need to be closer to do that.");    }  if (!have.cheese)    {    if (said("check", "cheese"))      {      print("You cannot see it from here.");      }    if (said("acquire", "cheese"))      {      print("I don't see any here.");      }    }  }if (isset(lf4))  {  accept.input();  reset(lf4);  draw(a.cheese);  }if (said("check", "oven"))  {  if (posn(ego, 4, 88, 106, 160))    {    print("It is an old wood stove, and very hot.  The fire must have been "          "burning for some time.");    }  else    {    print("You may have seen one in the other room, but I am not sure.");    }  }if (said("check", "cage"))  {  if (ego.prisoner)    {    if (previousRoom == 80)      {      print("This cage will be your new home for the rest of your life.");      }    if (previousRoom == 28)      {      print("You look for a way to escape, but there is none.");      }    }  if (!ego.prisoner)    {    if (posn(ego, 4, 88, 106, 160))      {      print("It is made from rusty, but strong, iron bars.");      }    else      {      print("You cannot see it from here.");      }    }  }if (said("feel", "oven"))  {  if (posn(ego, 8, 88, 40, 144))    {    print("The oven is very, very hot.  Someone must have just put some wood in "          "it.");    }  else    {    print("You are not close enough to touch it.");    }  }if (said("open", "oven"))  {  if (posn(ego, 8, 88, 40, 144))    {    print("You open the door and see a roaring fire burning in the oven.");    }  else    {    print("From here it would be rather difficult to open the oven.");    }  }if (posn(ego, 105, 88, 158, 160))  {  if (said("check", "bedroom"))    {    print("It looks like an ordinary bedroom.");    }  if (said("check", "table"))    {    if (have.note)      {      print("It is just a plain, wooden bedside table.");      }    else      {      print("There is a note lying on top of it.");      }    }  if (said("check", "bed"))    {    print("The witch's bed looks hard and uncomfortable.");    }  if ((said("sleep") ||       said("sleep", "bed") ||       said("acquire", "nap")))    {    print("You wouldn't want to sleep on a witch's bed.");    }  }if (!posn(ego, 105, 88, 158, 160))  {  if (said("check", "bedroom"))    {    print("You cannot see it from here.");    }  if (said("check", "table"))    {    print("That is the table where she eats her (gulp) food.");    }  if (said("check", "bed"))    {    print("The bed is not here.");    }  if ((said("sleep") ||       said("sleep", "bed") ||       said("acquire", "nap")))    {    print("The bed is not here.");    }  }if (said("check", "window"))  {  if (posn(ego, 115, 88, 140, 108))    {    print("You see the forest outside.");    }  else    {    print("There is little to see from here.");    }  }if (!have.note)  {  if (said("check", "note"))    {    if (posn(ego, 114, 132, 140, 160))      {      print("It is written in a familiar language.");      }    else      {      print("Your eyes are not sharp enough to see it from here.");      }    }  if (said("acquire", "note"))    {    if (posn(ego, 114, 132, 140, 160))      {      start.update(a.note);      erase(a.note);      set(have.note);      get("note");      print("You grab the note from the table.");      currentScore  += 2;      }    else      {      print("You cannot reach it from here.");      }    }  }if (posn(ego, 39, 164, 56, 166))  {  new.room(Logic28);  }return();[ Messages#message 1 "As the wicked witch flew over her house, she dropped you... into her cage!  If you can't get out, you may become the secret ingredient in this witches' brew!"#message 2 "Surprise!  Surprise!  The wicked witch is home and now she's after you!"#message 3 "Be thankful that you have a protective spell or the witch may have stuck around to try and catch you!"#message 4 "This is not a good place to give up your protection!"#message 5 "There is no reason to jump or duck here."#message 6 "Off in the distance you hear a high, squeaky voice say, \"I can smell someone tasty in my house.\""#message 7 "The witch mutters, \"I am going to get my oven ready to cook someone for dinner (yum).\""#message 8 "The witch mumbles, \"After I get the oven nice and hot, I will be ready to have someone for dinner (giggle).\""#message 9 "The witch mutters, \"The oven is heating up nicely.  I wonder who will be my dinner guest!\""#message 10 "The witch says, \"My oven is now the perfect temperature. It is time to invite someone for dinner (cackle, cackle)!\""#message 11 "Rats!  She has cast some spell to keep you from escaping!. The witch remarks, \"Oh, how nice of you to come for dinner (cackle, cackle)\""#message 13 "She pokes and pinches you, then states, \"This one is too scrawny, so it's into the cage until you fatten up (smack, yum)!\""#message 14 "With a flash, you hear her joyously exclaim, \"This has made me feel like flying!\""#message 15 "Courageously, you manage to push the witch into the oven where she flashes and melts away into a harmless blob. Congratulations!"#message 16 "Try as you will to escape, your labor will be in vain."#message 17 "It is fastened with a very strong lock.  There is no way for you to open it."#message 18 "This ugly old witch is one of the most hideous sights you have ever seen.  I would never trust her."#message 19 "There is no witch here."#message 20 "There is nothing but a bare shelf here."#message 21 "Sitting on the shelf is a delicious piece of Swiss cheese."#message 22 "The cabinet on the wall is rather plain and simple."#message 23 "It is already open."#message 24 "It is already closed."#message 25 "You pluck the Swiss cheese from the shelf."#message 26 "I don't see any here."#message 27 "You need to be a little closer for a good look."#message 28 "You need to be closer to do that."#message 29 "You cannot see it from here."#message 30 "This cage will be your new home for the rest of your life."#message 31 "You look for a way to escape, but there is none."#message 32 "It is an old wood stove, and very hot.  The fire must have been burning for some time."#message 33 "It is made from rusty, but strong, iron bars."#message 34 "You cannot see it from here."#message 35 "You may have seen one in the other room, but I am not sure."#message 36 "The oven is very, very hot.  Someone must have just put some wood in it."#message 37 "You open the door and see a roaring fire burning in the oven."#message 38 "You are in no position to do that!"#message 39 "You are not close enough to touch it."#message 40 "From here it would be rather difficult to open the oven."#message 41 "There is a note lying on top of it."#message 42 "It is just a plain, wooden bedside table."#message 43 "The witch's bed looks hard and uncomfortable."#message 44 "You wouldn't want to sleep on a witch's bed."#message 45 "That is the table where she eats her (gulp) food."#message 46 "The bed is not here."#message 47 "You see the forest outside."#message 48 "There is little to see from here."#message 49 "It is written in a familiar language."#message 50 "You grab the note from the table."#message 51 "The note was here at one time, but now you can`t seem to locate it."#message 52 "Your eyes are not sharp enough to see it from here."#message 53 "You cannot reach it from here."#message 54 "You don't have the note."#message 55 "If I were you, I wouldn't try it!  This witch is mean!"#message 56 "The little house is surprisingly neat considering a wicked witch lives here."#message 57 "OUCH!"#message 58 "There is no witch here...RIGHT NOW!!"#message 59 "The witch is dead."#message 60 "As soon as you entered the house the goat ran away."#message 61 "Now is not a good time to try and start a conversation!"#message 62 "Be thankful that you are invisible or the witch may have stuck around to try and catch you!"#message 63 "You need to be more specific."#message 64 "It looks like an ordinary bedroom."
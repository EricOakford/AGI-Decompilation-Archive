#define a.ogre  o1#define ogre.will.come f20#define ogre.in.room    f21#define ogre.leaving    f23#define ogre.grab.ego   f24#define caught.timer    v30#define ogre.step   v31if (newRoom)  {  load.pic(currentRoom);  draw.pic(currentRoom);  discard.pic(currentRoom);  if (goat.following)    {    load.logics(lgc.goat);    }  if (dead.goat.room == currentRoom)    {    add.to.pic(View62, 0, 0, 60, 71, 0, 0);    }  set.horizon(42);  random(0, 250, work);  if (work < 175)    {    load.sound(m.badguy);    ogre.step = 2;    step.size(a.ogre, ogre.step);    load.view(View94);    load.view(View95);    load.view(View2);    animate.obj(a.ogre);    set.view(a.ogre, View2);    set(ogre.will.come);    }  if (ogre.will.come)    {Label1:    random(0, 250, work.2);    if (work.2 > 90)      {      goto(Label1);      }    }  draw(ego);  show.pic();  }--work.2;if (work.2 == 1)  {  set(f145);  set(f146);  position(a.ogre, 40, 51);  set(ogre.in.room);  set(ego.stunned);  sound(m.badguy, sound.done);  draw(a.ogre);  if (!goat.following)    {    print("Watch out!!!  There is an ogre nearby!  He will crush you in his "          "strong arms if he catches you.");    follow.ego(a.ogre, 7, menace.caught.ego);    }  if (goat.following)    {    wander(a.ogre);    set(ogre.leaving);    print("Watch out!!!  There is an ogre nearby!  He will crush you in his "          "strong arms if he catches you.");    print("Lucky for you that ogres are afraid of goats. This one decides to "          "leave you alone.");    }  }if (sound.done)  {  reset(sound.done);  reset(ego.stunned);  }if (!ogre.in.room)  {  reset(f145);  reset(f146);  if (said("anyword", "dwarf"))    {    print("There is no ogre here.");    }  if (said("cast", "dagger") &&       have.dagger)    {    print("OK.  You drop the dagger.");    reset(have.dagger);    set(lost.dagger);    drop("dagger");    currentScore -= 5;    }  }if (menace.caught.ego)  {  reset(menace.caught.ego);  if (ego.invisible)    {    print("Fortunately, you are invisible and the ogre can't see you.");    wander(a.ogre);    set(ogre.leaving);    goto(Label2);    }  if (protected.spell)    {    print("You are very fortunate that your protective spell is still working.");    wander(a.ogre);    set(ogre.leaving);    goto(Label2);    }  if (have.shield)    {    print("With the magic shield, no harm will come to you.");    wander(a.ogre);    set(ogre.leaving);    goto(Label2);    }  if (ego.shrunk)    {    print("The ogre's vision is not keen enough to see you.");    wander(a.ogre);    set(ogre.leaving);    goto(Label2);    }  set(ogre.grab.ego);  caught.timer = 10;  program.control();  stop.motion(ego);  erase(a.ogre);  set.view(ego, View94);  }--caught.timer;Label2:if (ogre.leaving &&     edgeObjHit != NOT_HIT)  {  erase(a.ogre);  reset(ogre.leaving);  reset(ogre.in.room);  }if (caught.timer == 1)  {  print("You were warned to be careful around this fierce creature!  Maybe next "        "time you will be able to elude the beast.");  get.posn(ego, temp.x, temp.y);  erase(ego);  set.view(ego, View95);  set.view(a.ogre, View2);  position.v(ego, temp.x, temp.y);  position.v(a.ogre, temp.x, temp.y);  draw(a.ogre);  draw(ego);  stop.motion(a.ogre);  stop.cycling(a.ogre);  set(certain.death);  }if (ogre.in.room)  {  if (said("check", "dwarf"))    {    print("That is a ferocious looking beast.  Please keep your distance!");    }  if (said("kill", "dwarf"))    {    print("Ogres are practically indestructible.");    }  if (said("check", "stump"))    {    print("At one time these were very pretty trees.");    }  if (said("pet", "dwarf"))    {    print("Do you really want to try that?");    }  if (said("check", "blossom"))    {    print("The delightful wild flowers brighten up your day.");    }  if (said("smell", "blossom"))    {    if (posn(ego, 22, 86, 114, 167))      {      print("Their perfume is joyful, sweet, and light.");      }    else      {      print("You need to be a little closer to smell the flowers.");      }    }  if ((said("speak", "dwarf") ||       said("hello") ||       said("say", "hello")))    {    print("Ogres don't talk, they growl!");    }  if (said("cast", "dagger") &&       have.dagger)    {    print("The dagger is of little use against such a mean creature.  I would "          "save it if I were you.");    }  }if (edgeEgoHit != NOT_HIT)  {  reset(f145);  reset(f146);  }if (ogre.grab.ego)  {  goto(Label3);  }if (edgeEgoHit == TOP_EDGE &&     caught.timer <= 0)  {  new.room(Logic3);  }if (edgeEgoHit == RIGHT_EDGE &&     caught.timer <= 0)  {  new.room(Logic47);  }if (edgeEgoHit == LEFT_EDGE &&     caught.timer <= 0)  {  new.room(Logic45);  }if (edgeEgoHit == BOTTOM_EDGE &&     caught.timer <= 0)  {  new.room(Logic35);  }if (goat.following)  {  call(lgc.goat);  }Label3:return();[ Messages#message 1 "Watch out!!!  There is an ogre nearby!  He will crush you in his strong arms if he catches you."#message 2 "You are very fortunate that your protective spell is still working."#message 3 "With the magic shield, no harm will come to you."#message 4 "Fortunately, you are invisible and the ogre can't see you."#message 5 "The ogre's vision is not keen enough to see you."#message 6 "The ogre can see you now!"#message 7 "The dagger is of little use against such a mean creature.  I would save it if I were you."#message 8 "OK.  You drop the dagger."#message 9 "That is a ferocious looking beast.  Please keep your distance!"#message 10 "There is no ogre here."#message 11 "Ogres are practically indestructible."#message 12 "At one time these were very pretty trees."#message 13 "Do you really want to try that?"#message 14 "The delightful wild flowers brighten up your day."#message 15 "Their perfume is joyful, sweet, and light."#message 16 "Ogres don't talk, they growl!"#message 17 "You were warned to be careful around this fierce creature!  Maybe next time you will be able to elude the beast."#message 18 "Lucky for you that ogres are afraid of goats. This one decides to leave you alone."#message 19 "You need to be a little closer to smell the flowers."
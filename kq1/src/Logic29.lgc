#define a.sorcerer  o1#define sorcerer.will.come  f20#define sorcerer.in.room    f21#define sorcerer.leaving    f22#define after.spell f23#define ego.frozen  f24#define magic.sound f25#define magic.sound.done f26#define sorcerer.disappears f27#define frozen.timer.1  v30#define frozen.timer.2  v31#define sorcerer.step   v32if (newRoom)  {  load.pic(currentRoom);  draw.pic(currentRoom);  discard.pic(currentRoom);  if (goat.following)    {    load.logics(lgc.goat);    }  if (dead.goat.room == currentRoom)    {    add.to.pic(View62, 0, 0, 80, 66, 0, 0);    }  if (previousRoom == 20)    {    if (!ego.invisible)      {      set.view(ego, View0);      reset(keep.cycling);      }    }  random(0, 250, work);  if (work < 185)    {    sorcerer.step = 2;    step.size(a.sorcerer, sorcerer.step);    load.view(View5);    load.view(View116);    load.sound(m.badguy);    load.sound(Sound17);    animate.obj(a.sorcerer);    set.view(a.sorcerer, View5);    set(sorcerer.will.come);    }  if (sorcerer.will.come)    {Label1:    random(0, 250, work.2);    if (work.2 > 90)      {      goto(Label1);      }    }  draw(ego);  show.pic();  }if (sorcerer.in.room && sound.done)  {  if (!magic.sound)    {    set(magic.sound);    sound(Sound17, magic.sound.done);    }  if (magic.sound.done)    {    reset(magic.sound);    reset(magic.sound.done);    }  }--work.2;if (work.2 == 1)  {  position(a.sorcerer, 40, 140);  set(sorcerer.in.room);  sound(m.badguy, sound.done);  draw(a.sorcerer);  if (!goat.following)    {    print("Be careful!  Nearby is a sorcerer.  His mystical powers can leave "          "you immobilized and helpless!");    follow.ego(a.sorcerer, 7, menace.caught.ego);    }  if (goat.following)    {    wander(a.sorcerer);    set(sorcerer.leaving);    print("Be careful!  Nearby is a sorcerer.  His mystical powers can leave "          "you immobilized and helpless!");    print("The sorcerer sees the goat and decides to leave.");    }  }if (!sorcerer.in.room)  {  if (said("anyword", "dwarf"))    {    print("There's no sorcerer here.");    }  if (said("cast", "dagger") &&       have.dagger && !goat.following)    {    print("OK.  But you just lost your dagger.");    reset(have.dagger);    set(lost.dagger);    drop("dagger");    currentScore -= 5;    }  }if (sorcerer.in.room)  {  if (said("check", "dwarf"))    {    print("This sorcerer exudes mystery and danger.");    }  if ((said("speak", "dwarf") ||       said("hello") ||       said("say", "hello")))    {    print("The sorcerer only speaks in the language of the Mystics.");    }  }if (menace.caught.ego)  {  reset(menace.caught.ego);  if (protected.spell)    {    print("This sorcerer's magic is no match for your fairy godmother's.");    wander(a.sorcerer);    set(sorcerer.leaving);    }  else    {    if (ego.invisible)      {      print("Being invisible has protected you from this sorcerer.");      set(sorcerer.disappears);      }    else      {      if (have.shield)        {        print("The magic shield will protect you from this dangerous  sorcerer.");        wander(a.sorcerer);        set(sorcerer.leaving);        }      else        {        set(ego.frozen);        frozen.timer.1 = 250;        frozen.timer.2 = 2;        program.control();        stop.motion(ego);        set.view(a.sorcerer, View116);        end.of.loop(a.sorcerer, after.spell);        print("The sorcerer casts a spell, freezing you to the spot. I hope no "              "dangerous creatures drop by!");        set(f145);        set(f146);        }      }    }  }if (after.spell)  {  reset(after.spell);  set.view(a.sorcerer, View5);  start.cycling(a.sorcerer);  wander(a.sorcerer);  set(sorcerer.leaving);  }if (sorcerer.leaving &&     edgeObjHit != NOT_HIT)  {  erase(a.sorcerer);  reset(sorcerer.leaving);  reset(sorcerer.in.room);  }if (sorcerer.disappears)  {  erase(a.sorcerer);  reset(sorcerer.disappears);  reset(sorcerer.in.room);  }--frozen.timer.1;if (frozen.timer.1 == 0 &&     frozen.timer.2 > 0)  {  --frozen.timer.2;  frozen.timer.1 = 250;  }if (frozen.timer.1 == 1 &&     frozen.timer.2 == 0)  {  reset(ego.frozen);  print("The sorcerer's spell has expired; now you can move  again.  Whew!");  start.motion(ego);  player.control();  }if (ego.frozen)  {  goto(Label2);  }if (edgeEgoHit == TOP_EDGE)  {  new.room(Logic36);  }if (edgeEgoHit == RIGHT_EDGE)  {  new.room(Logic30);  }if (edgeEgoHit == LEFT_EDGE)  {  new.room(Logic28);  }if (edgeEgoHit == BOTTOM_EDGE)  {  new.room(Logic20);  }if (goat.following)  {  call(lgc.goat);  }Label2:return();[ Messages#message 1 "Be careful!  Nearby is a sorcerer.  His mystical powers can leave you immobilized and helpless!"#message 2 "The magic shield will protect you from this dangerous  sorcerer."#message 3 "You're so afraid of the sorcerer that your knees are locked."#message 4 "This sorcerer exudes mystery and danger."#message 5 "There's no sorcerer here."#message 6 "The sorcerer casts a spell, freezing you to the spot. I hope no dangerous creatures drop by!"#message 7 "The sorcerer's spell has expired; now you can move  again.  Whew!"#message 8 "You are immobilized!  You can't jump or duck now!"#message 9 "OK.  But you just lost your dagger."#message 10 "The sorcerer only speaks in the language of the Mystics."#message 11 "This sorcerer's magic is no match for your fairy godmother's."#message 12 "The sorcerer sees the goat and decides to leave."#message 13 "Being invisible has protected you from this sorcerer."
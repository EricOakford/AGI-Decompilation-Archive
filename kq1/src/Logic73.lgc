#define fall.to.ground  f20#define stun.done f21#define fall.sound.played   f22#define was.invisible f23#define was.shrunk  f24#define stunned.timer v30if (isset(newRoom))  {  load.pic(currentRoom);  draw.pic(currentRoom);  discard.pic(currentRoom);  load.sound(Sound4);  load.sound(s.ego.fall);  load.view(View105);  load.view(View103);  load.view(View104);  if (previousRoom == 48)    {    position(ego, 90, 63);    set.view(ego, View105);    ignore.blocks(ego);    set(keep.cycling);    start.cycling(ego);    move.obj(ego, 90, 142, 4, fall.to.ground);    if (ego.invisible)      {      set(was.invisible);      reset(ego.invisible);      reset(have.ring);      drop("magic ring");      currentScore -= 3;      set(lost.ring);      }    if (ego.shrunk)      {      reset(ego.shrunk);      shrink.timer = 0;      set(was.shrunk);      }    }  if (previousRoom == 74)    {    position(ego, 77, 165);    }  draw(ego);  show.pic();  }if (!fall.to.ground && !fall.sound.played &&     previousRoom == 48)  {  sound(s.ego.fall, sound.done);  set(fall.sound.played);  }if (said("check", "doorway"))  {  print("The warm sunlight falls through the hole in the ceiling.  "        "Unfortunately, you can't reach it.");  }if (said("check", "cave"))  {  print("The dark tunnel leads off to the south.");  }if (fall.to.ground)  {  reset(fall.to.ground);  stop.sound();  observe.blocks(ego);  set.view(ego, View103);  program.control();  shake.screen(1);  print("OUCH!");  stunned.timer = 36;  sound(Sound4, sound.done);  }if (sound.done)  {  if (stunned.timer > 0)    {    reset(sound.done);    sound(Sound4, sound.done);    }  }if (stunned.timer == 1)  {  set.view(ego, View104);  end.of.loop(ego, stun.done);  }if (stun.done)  {  reset(stun.done);  set.view(ego, View0);  reset(keep.cycling);  player.control();  if (was.invisible)    {    reset(was.invisible);    print("While falling through the hole, the magic ring fell off your finger. "          " Dangerous creatures can see you now!");    }  if (was.shrunk)    {    reset(was.shrunk);    print("When you fell through the hole, you felt a streching sensation and "          "are back to your normal size.");    }  }--stunned.timer;if (posn(ego, 0, 166, 159, 167))  {  new.room(Logic74);  }return();[ Messages#message 1 "While falling through the hole, the magic ring fell off your finger.  Dangerous creatures can see you now!"#message 2 "The warm sunlight falls through the hole in the ceiling.  Unfortunately, you can't reach it."#message 3 "The dark tunnel leads off to the south."#message 4 "OUCH!"#message 5 "When you fell through the hole, you felt a streching sensation and are back to your normal size."
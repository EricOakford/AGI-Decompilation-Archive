[***********************************************************[[ lgc.PanamaTripTiming[[ This logic is called from each room when Jerrod is on the [ Panama trip. It handles the main timing, including [ changing room as needed as the trip progresses.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define vMosquitoTime               v87  [ override BoilerTime#define vYellowFeverTime            v88  [ override YoungOxDeathTime#define vDysenteryTime              v89  [ override AnimalStarveTime#define fShowMsgHelp               f242[ at these specific timing pointsif ((CurrentTripTime == TripPoint_3 ||     CurrentTripTime == TripPoint_5 ||     CurrentTripTime == TripPoint_6 ||     CurrentTripTime == TripPoint_9 ||     CurrentTripTime == TripPoint_12 ||     CurrentTripTime == TripPoint_16 ||     CurrentTripTime == TripPoint_18 ||     CurrentTripTime == TripPoint_19 ||     CurrentTripTime == TripPoint_20))  {  [ in these rooms and cutscenes, there is no player   [ interaction, so help messages about how to show/hide the  [ trip messages is displayed    [ if the F8 message help line isn't shown yet  if (!isset(fShowMsgHelp))    {    [ show the apprpriate message, depending on status of    [ main trip message flag    set(fShowMsgHelp);    if (isset(HideTripMsgs))      {      display(24, 0, "<F8> messages suppressed");      }    else      {      display(24, 0, "<F8> messages displayed ");      }    }    [ if player has toggled messages  if (controller(keyTrekMsgs))    {    [ toggle the flag    toggle(HideTripMsgs);    if (isset(HideTripMsgs))    [ show the correct help line      {      display(24, 0, "<F8> messages suppressed");      }    else      {      display(24, 0, "<F8> messages displayed ");      }    }  }else  {  [ at these timing points  if ((CurrentTripTime == TripPoint_8 ||       CurrentTripTime == TripPoint_10 ||       CurrentTripTime == TripPoint_11 ||       CurrentTripTime == TripPoint_13 ||       CurrentTripTime == TripPoint_14 ||       CurrentTripTime == TripPoint_15 ||       CurrentTripTime == v83 ||       CurrentTripTime == v84 ||       CurrentTripTime == CholeraTime ||       CurrentTripTime == CoalFireTime ||       CurrentTripTime == vMosquitoTime ||       CurrentTripTime == vYellowFeverTime ||       CurrentTripTime == vDysenteryTime ||       CurrentTripTime == v102))    {    [ in these rooms and cutscenes, the player has normal    [ interaction and control, so there are no trip messages    [ to see or skip; the help line is not needed       [ use the same help msg flag; if flag not set    if (!isset(fShowMsgHelp))      {      [ set the flag, and draw an empty string to make sure      [ the help line is gone      set(fShowMsgHelp);      display(24, 0, "                        ");      }    }  else    {    [ in all other rooms, the player can skip ahead; show    [ the help line, if not already shown        [ if help msg flag is not set yet    if (!isset(fShowMsgHelp))      {      [ set the flag, and display the help line      set(fShowMsgHelp);      display(24, 0, "Ctrl-n for next scene   ");      }          [ if playe wants to skip ahead    if (controller(keyNextScene))      {      [ at first point      if (CurrentTripTime == TripPoint_1)        {        [ move to next point        ++CurrentTripTime;        }      [ set flag to continue on with next scene      set(ContinueJourney);      }    }  }  [ if currently at trip point 1, if (CurrentTripTime == TripPoint_1)  {  [ this is a short scene, on the middle section of the  [ steamship  if (TripCycles > 50)    {    [ increment main trip scene number; this will make    [ CurrentTripTime equal '3' for the next cycle (because    [ it gets incremented again when ContinueJourney gets    [ reset)    ++CurrentTripTime;    [ advance to next scene     set(ContinueJourney);    }  }  [ trip point 2 is skipped in the Panama route; this code[ block will never get executedif (CurrentTripTime == TripPoint_2)  {  [ much longer pause at this scene  if (TripCycles2 == 5 && TripCycles == 150)    {    set(ContinueJourney);    }  }  [ trip point 4 is skipped in the Panama route; this code[ block will never get executedif (CurrentTripTime == TripPoint_4)  {  if (TripCycles2 == 0 && TripCycles == 250)    {    set(ContinueJourney);    }  }  [ Jerrod doesn't get sick on the Panama trip; this code[ block will never get executed (it also uses the time point[ variable that is used to check for fire in coal hold [ during the Cape Horn trip)if (CurrentTripTime == CoalFireTime)  {  if (TripCycles == 20 && TripCycles2 == 0)    {    print("Lately you have been feeling a little nauseous, a few cramps here "          "and there and slightly dehydrated.");    }  if (TripCycles2 == 0 && TripCycles == 200 && !isset(DyingAtSea))    {    set(DyingAtSea);    }  }  [ if the current trip point activities are completeif (isset(ContinueJourney))  {  [ advance to next trip point  reset(ContinueJourney);  ++CurrentTripTime;  [ reset cycle counters  TripCycles = 0;  TripCycles2 = 0;  TripCycles3 = 0;    [ change room/cutscene depending on which trip scene is  [ current    [ if now at trip point 1 (this is actually never possible;  [ it's set to '1' in rm.Overlook  if (CurrentTripTime == TripPoint_1)    {    [ first scene is the middle of the ship, exterior view    new.room(rm.ShipMidExterior); [ ##LE001##    }      [ trip point 2 is skipped in the Panama route; this code  [ block will never get executed  if (CurrentTripTime == TripPoint_2)    {    new.room(rm.ShipMidPanama); [ ##LE002##    }      [ at trip point 3  if (CurrentTripTime == TripPoint_3)    {    [ begin tracing route on the main route map    new.room(cs.PanamaRoute); [ ##LE003##    }  [ trip point 4 is skipped in the Panama route; this code  [ block will never get executed  if (CurrentTripTime == 4)    {    new.room(rm.ShipMidPanama); [ ##LE004##    }      [ at trip point 5  if (CurrentTripTime == TripPoint_5)    {    [ trace route on map from Cuba to Chagres    new.room(cs.PanamaRoute); [ ##LE005##    }      [ at trip point 6  if (CurrentTripTime == TripPoint_6)    {    [ trace route on closeup view of Panama as ship    [ approaches Chagres    new.room(cs.PanamaCrossing); [ ##LE006##    }    [ at trip point 7  if (CurrentTripTime == TripPoint_7)    {    [ an interactive cut scene showing the ship anchoring,    [ with small boats that bring the passengers up the    [ river    new.room(cs.ChagresHarbor); [ ##LE007##    }      [ at trip point 8  if (CurrentTripTime == TripPoint_8)    {    [ first jungle cut scene, with the small boats taking    [ the passengers up the river    new.room(cs.ChagresRiver); [ ##LE008##    }      [ at trip point 9  if (CurrentTripTime == TripPoint_9)    {    [ back to the map of the isthmus, showing the trip    [ progression up river to disembarkment into the jungle    new.room(cs.PanamaCrossing); [ ##LE009##    }      [ at trip point 10  if (CurrentTripTime == 10)    {    [ second cut scene, where natives take all posessions    new.room(cs.JungleNatives); [ ##LE010##    }      [ at trip point 11  if (CurrentTripTime == TripPoint_11)    {    [ third cutscene, where boats land, and passengers begin    [ hiking through the jungle    new.room(rm.JungleStart); [ ##LE011##    }      [ at trip point 12  if (CurrentTripTime == TripPoint_12)    {    [ track progress through jungle    new.room(cs.PanamaCrossing); [ ##LE012##    }    [ at trip point 13  if (CurrentTripTime == 13)    {    [ first jungle room, where Jerrod has to avoid ants and    [ find Bible    new.room(rm.JungleAnts); [ ##LE013##    }      [ at trip point 14  if (CurrentTripTime == 14)    {    [ second jungle room, with dense jungle    new.room(rm.ThickJungle); [ ##LE014##    }     [ at trip point 15  if (CurrentTripTime == 15)    {    [ last jungle room, with river crossing    new.room(rm.RiverCrossing); [ ##LE015##    }      [ at trip point 16  if (CurrentTripTime == TripPoint_16)    {    [ continue crossing Panama isthmus, to Panama City    new.room(cs.PanamaCrossing); [ ##LE016##    }      [ at trip point 17  if (CurrentTripTime == TripPoint_17)    {    [ show cut scene of ship leaving Panama City    new.room(cs.PanamaCity); [ ##LE017##    }      [ at trip point 18  if (CurrentTripTime == TripPoint_18)    {    [ finish showing trip marker on the Panama map    new.room(cs.PanamaCrossing); [ ##LE018##    }      [ at trip point 19  if (CurrentTripTime == TripPoint_19)    {    [ track ship progress from Panama to California on the    [ North America map    new.room(cs.PanamaRoute); [ ##LE019##    }      [ at trip point 20  if (CurrentTripTime == TripPoint_20)    {    [ track ship progress into San Francisco Bay    new.room(cs.ArriveCalifornia); [ ##LE020##    }      [ at trip point 21  if (CurrentTripTime == TripPoint_21)    {    [ arrive in Sacramento    new.room(rm.Sacramento); [ ##LE021##    }  }  [ increment trip cycle counter++TripCycles;[ if counter maxes outif (TripCycles == 255)  {  [ reset it, and increment 2nd level counter  ++TripCycles2;  TripCycles = 0;  [ there are ~10 to 20 seconds of game time per cycle of  [ the second level counter  }[ if second level counter maxes outif (TripCycles2 == 255)  {  [ reset it, and increment 3rd level counter  ++TripCycles3;  TripCycles2 = 0;  [ there are ~45 to 60 minutes of game time per cycle of  [ the third level counter  }[ **************************************[ PROCESS PLAYER INPUT[ **************************************[ if player hasn't provided input no need to do said testsif (!isset(haveInput))  {  goto(Done);  }  [ wear mosquito netif ((said("wear", "mosquito net") ||     said("apply", "mosquito net") ||     said("use", "mosquito net")))  {  if (has("Mosquito net"))    {    print("Since you have entered the humid tropics, whenever necessary you "          "have worn the mosquito net to keep those pests from biting you!");    }  else    {    print("You don't have any mosquito net.");    }  }  Done:return();[ **************************************[ MESSAGES[ **************************************#message 1 "<F8> messages displayed "#message 2 "<F8> messages suppressed"#message 3 "Ctrl-n for next scene   "#message 4 "                        "#message 12 "Lately you have been feeling a little nauseous, a few cramps here and there and slightly dehydrated."#message 27 "Since you have entered the humid tropics, whenever necessary you have worn the mosquito net to keep those pests from biting you!"#message 30 "You don't have any mosquito net."
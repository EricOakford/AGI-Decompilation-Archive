[***********************************************************[[ rm.SuttersFortArea[[ This is an overhead view of the larger Sutter's Fort area.[ Jerrod appears as a small flashing pixel. This allows the[ player to quickly move around the area. This room is also[ used in the cutscenes that show Jerrod arriving by wagon. [[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oTinyCoach                   o1#define vStagePhase                v220#define vTmpVar                    v221#define fStageMoved                f220[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load picture for current room  load.pic(currentRoom);    [ load view with flashing pixel (same view used in  [ rm.GazeboPark)  load.view(vw.GazeboRmArt);    [ draw the picture  draw.pic(currentRoom);    [ if coming from Sacramento  if (previousRoom == rm.Sacramento)    {    [ it's a cut scene; animate the tiny stagecoach    animate.obj(oTinyCoach);    [ use the flashing square view for the stagecoach    set.view(oTinyCoach, vw.GazeboRmArt);    set.loop(oTinyCoach, 1);    fix.loop(oTinyCoach);    position(oTinyCoach, 25, 104);    draw(oTinyCoach);    start.cycling(oTinyCoach);    vTmpVar = 2;    step.time(oTinyCoach, vTmpVar);    }  else    {    [ not a cut scene; use ego object    animate.obj(ego);    [ use the tiny flashing square view for ego    set.view(ego, vw.GazeboRmArt);    set.loop(ego, 1);    fix.loop(ego);    [ adjust position based on which room Jerrod came from    if (previousRoom == 122)      {      [ coming from Sacramento River      position(ego, 90, 165);      }    if (previousRoom == 124)      {      [ coming from American River      position(ego, 157, 85);      }    if (previousRoom != 122 &&         previousRoom != 124 &&         previousRoom != rm.SuttersFortSouth &&         previousRoom != rm.SuttersFortNorth)      {      [ not coming from either river, or from north/south of      [ the fort      position(ego, 82, 106);      }    draw(ego);        [ when previous room is NOT Sacramento, o2 (oTinyCoach)    [ is not initialized/used; these two lines should have    [ been removed    vTmpVar = 2;    step.time(oTinyCoach, vTmpVar);        [ allow ego object to cycle when not moving this lets    [ player see the tiny pixel that represents Jerrod much    [ easier    set(CycleAtRest);    }      [ if coming from cemetery (not sure why this check is here  [ instead of with the other checks above)  if (previousRoom == rm.SutterCemetery)    {    position(ego, 101, 90);    }  [ make sure Jerrod is stopped  egoDir = STOPPED;    [ now show the picture  show.pic();  }  [ **************************************[ EVERY CYCLE[ **************************************[ this is a bug! this stagecoach sequence runs even if the[ tiny coach isn't being used; it doesn't cause an error[ though, since the object number is a valid number; it just[ doesn't display anything since the object isn't animated[ first [ step through stage sequence to move the stage to Sutter's[ Fortif (vStagePhase == 0)  {  vStagePhase = 1;  move.obj(oTinyCoach, 25, 108, 1, fStageMoved);  }if (isset(fStageMoved) && vStagePhase == 1)  {  reset(fStageMoved);  vStagePhase = 2;  move.obj(oTinyCoach, 27, 110, 1, fStageMoved);  }if (isset(fStageMoved) && vStagePhase == 2)  {  reset(fStageMoved);  vStagePhase = 3;  move.obj(oTinyCoach, 32, 110, 1, fStageMoved);  }if (isset(fStageMoved) && vStagePhase == 3)  {  reset(fStageMoved);  vStagePhase = 4;  move.obj(oTinyCoach, 37, 109, 1, fStageMoved);  }if (isset(fStageMoved) && vStagePhase == 4)  {  reset(fStageMoved);  vStagePhase = 5;  move.obj(oTinyCoach, 51, 108, 1, fStageMoved);  }if (isset(fStageMoved) && vStagePhase == 5)  {  reset(fStageMoved);  vStagePhase = 6;  move.obj(oTinyCoach, 58, 107, 1, fStageMoved);  }if (isset(fStageMoved) && vStagePhase == 6)  {  reset(fStageMoved);  vStagePhase = 7;  move.obj(oTinyCoach, 62, 106, 1, fStageMoved);  }if (isset(fStageMoved) && vStagePhase == 7)  {  reset(fStageMoved);  vStagePhase = 8;  move.obj(oTinyCoach, 65, 105, 1, fStageMoved);  }if (isset(fStageMoved) && vStagePhase == 8)  {  reset(fStageMoved);  vStagePhase = 9;  move.obj(oTinyCoach, 67, 104, 1, fStageMoved);  }if (isset(fStageMoved) && vStagePhase == 9)  {  reset(fStageMoved);  vStagePhase = 10;  move.obj(oTinyCoach, 70, 103, 1, fStageMoved);  }if (isset(fStageMoved) && vStagePhase == 10)  {  reset(fStageMoved);  vStagePhase = 11;  move.obj(oTinyCoach, 82, 102, 1, fStageMoved);  }[ when stage gets to the fortif (isset(fStageMoved) && vStagePhase == 11)  {  [ move to south view of fort for last cut scene  position(ego, 108, 118);  new.room(rm.SuttersFortSouth); [ ##LE001##  }  [ **************************************[ CHECK FOR AN EXIT CONDITION[ **************************************if (posn(ego, 85, 102, 90, 102))  {  [ south view, right  position(ego, 128, 118);  new.room(rm.SuttersFortSouth); [ ##LE002##  }  if (posn(ego, 79, 98, 84, 98))  {  [ south view, center  position(ego, 83, 115);  new.room(rm.SuttersFortSouth); [ ##LE003##  }  if (posn(ego, 76, 90, 78, 98))  {  [ south view, left  position(ego, 35, 115);  new.room(rm.SuttersFortSouth); [ ##LE004##  }  if (posn(ego, 76, 84, 78, 89))  {  [ north view, left  position(ego, 150, 97);  new.room(rm.SuttersFortNorth); [ ##LE005##  }  if (posn(ego, 78, 83, 89, 84))  {  [ north view, center  position(ego, 106, 97);  new.room(rm.SuttersFortNorth); [ ##LE006##  }  if (posn(ego, 90, 84, 92, 101))  {  [ north view, right  position(ego, 12, 87);  new.room(rm.SuttersFortNorth); [ ##LE007##  }  if (posn(ego, 96, 85, 98, 91))  {  [ cemetery entrance  position(ego, 52, 61);  new.room(rm.SutterCemetery); [ ##LE008##  }  [ if at bottom edgeif (posn(ego, 0, 166, 159, 166))  {  [ go south into wilderness  ++WildernessY;  [ reset ego object to not cycle when motionless  reset(CycleAtRest);  position(ego, 80, 82);  new.room(lgc.SacRiverWild); [ ##LE009##  }  [ if at right edgeif (posn(ego, 158, 30, 158, 165))  {  [ go east into wilderness  ++WildernessX;  [ reset ego object to not cycle when motionless  reset(CycleAtRest);  position(ego, 2, 119);  new.room(lgc.AmRiverWild); [ ##LE010##  }  [ **************************************[ PROCESS PLAYER INPUT[ **************************************[ if player hasn't provided input no need to do said testsif (!isset(haveInput))  {  goto(Done);  }  [ look/look aroundif ((said("examine", "around") ||     said("examine")))  {  print("Yer outside of Sutter's Fort on the edge of the wilderness. The road "        "in front of the fort heads east through the wilderness to the town of "        "Coloma.");  }  [ look fortif (said("examine", "fort"))  {  print("Newcomers to California would sometimes get valuable information from "        "folks in Sutter's Fort.");  }  [ look wildernessif (said("examine", "wilderness"))  {  print("Many gold seekers, after a short stay at Sutter's Fort, head east "        "through the wilderness along the American River.");  }  [ look roadif (said("examine", "path"))  {  print("The road in front of Sutter's Fort heads east along the American River "        "to Coloma.");  }  [ look riverif (said("examine", "creek"))  {  print("To the north of Sutter's Fort is the American River, to the west is "        "the Sacramento River.");  }  [ look American Riverif (said("examine", "american", "creek"))  {  print("The American River runs east through the wilderness.");  }  [ look Sacramento Riverif (said("examine", "sacramento", "creek"))  {  print("To the west of Sutter's Fort lies the Sacramento River.");  }  [ look across the riverif (said("examine", "across", "creek"))  {  print("Across the river lies unreachable wilderness.");  }  [ look Colomaif (said("examine", "coloma"))  {  print("The town of Coloma ain't in sight right now.  Coloma is half a days "        "walk to the east of Sutter's Fort.");  }  [ follow muleif (said("follow", "donkey"))  {  if ((has(LazyMule) ||       has("James' ol' mule")))    {    print("Ya might try that somewhere nearby!");    }  else    {    print("Ya ain't got no mule!");    }  }  [ dig for goldif ((said("use", "shovel") ||     said("dig", "gold") ||     said("dig") ||     said("dig", "hole")))  {  if (has("Shovel"))    {    print("Diggin' ain't allowed here! Do that somewhere else!!");    }  else    {    print("No shovel, no diggin'!");    }  }  [ pan for goldif ((said("use", "pan") ||     said("pan", "gold") ||     said("pan")))  {  print("Ya needs to be in the water!");  }  Done:return();[ **************************************[ MESSAGES[ **************************************#message 20 "Ya ain't got no mule!"#message 21 "Ya might try that somewhere nearby!"#message 22 "Yer outside of Sutter's Fort on the edge of the wilderness. The road in front of the fort heads east through the wilderness to the town of Coloma."#message 23 "Newcomers to California would sometimes get valuable information from folks in Sutter's Fort."#message 24 "Many gold seekers, after a short stay at Sutter's Fort, head east through the wilderness along the American River."#message 25 "The road in front of Sutter's Fort heads east along the American River to Coloma."#message 26 "To the north of Sutter's Fort is the American River, to the west is the Sacramento River."#message 27 "The American River runs east through the wilderness."#message 28 "To the west of Sutter's Fort lies the Sacramento River."#message 29 "Across the river lies unreachable wilderness."#message 30 "The town of Coloma ain't in sight right now.  Coloma is half a days walk to the east of Sutter's Fort."#message 40 "Diggin' ain't allowed here! Do that somewhere else!!"#message 41 "No shovel, no diggin'!"#message 42 "Ya needs to be in the water!"
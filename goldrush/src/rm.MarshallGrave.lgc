[***********************************************************[[ rm.MarshallGrave[ [ This is a close up of Wilson Marshall's tombstone. Jerrod[ can use the letter from Jake (with the holes) to find a [ clue that points to Room 12 in the Green Pastures Hotel.[[ The ego object uses the letter view; there is no view of[ Jerrod in this room.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define fSoundDone                  f220#define fClueFound                  f221#define fUsingLetter                f222[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load picture for current room  load.pic(currentRoom);    [ load the letter view  load.view(vw.Letter);    [ load score points sound  load.sound(m.FoundGold);    [ draw and show current room picture  draw.pic(currentRoom);  show.pic();    [ if this is first time visiting  if (!isset(ScoreMarshallGrave))    {    [ set the flag    set(ScoreMarshallGrave);    [ plays score sound    sound(m.FoundGold, fSoundDone);    }      [ force custom status line to update (which displays  [ instructions to get back to cemetery)  set(UpdateStatus);  }  [ **************************************[ EVERY CYCLE[ **************************************[ if the letter is positioned correctly, and the clue hasn't[ been found yet, and the letter is not movingif (posn(ego, 41, 111, 41, 111) &&     !isset(fClueFound) &&     egoDir == STOPPED)  {  [ Jerrod finds the clue  set(fClueFound);  print.at(" Hold it right there!!! ", 17, 7, 30);  print.at("Through the holes in the letter ya see these characters:  R 2 1 O O "           "M .", 17, 7, 30);  [ if not scored yet  if (!isset(ScoreLetterClue))    {    [ score five points    sound(m.FoundGold, fSoundDone);    set(ScoreLetterClue);    currentScore  += 5;    }  }  [ if the letter is NOT positioned correctly and clue has [ been foundif (!posn(ego, 41, 111, 41, 111) && isset(fClueFound))  {  [ reset the flag so it can be found again  reset(fClueFound);  }  [ if F8 key is pressedif (controller(keyTrekMsgs))  {  [ clear the custom status line  clear.lines(24, 24, BLACK);  [ return to the cemetery  new.room(rm.SutterCemetery); [ ##LE001##  }  [ **************************************[ PROCESS PLAYER INPUT[ **************************************[ if player hasn't provided input no need to do said testsif (!isset(haveInput))  {  goto(Done);  }  [ use letter/put letter on tombstoneif ((said("use", "letter") ||     said("place", "letter") ||     said("place", "letter", "grave") ||     said("place", "letter", "gravestone") ||     said("hold", "letter", "gravestone") ||     said("hold", "letter", "grave") ||     said("hold", "letter")))  {  [ if already using letter to find the clue  if (isset(fUsingLetter))    {    print("Yer already doin' that!");    }  else    {    [ if Jerrod has Jake's letter    if (has("Letter"))      {      [ if letter is still in the envelope      if (JakesLetter == JL_DELIVERED)        {        print("That ain't a bad idea, but it'll be difficult 'cause the "              "letter's still in the envelope!");        }      [ if Jerrod has opened the letter      if (JakesLetter == JL_OPENED)        {        print("You must be a genius!!");        print("Ya take the letter from yer long-lost brother out of yer pocket "              "and hold it up to the tombstone.");        [ use ego object as the letter        animate.obj(ego);        set.view(ego, vw.Letter);        set.loop(ego, 0);        fix.loop(ego);        [ start with letter at bottom, just right of center        position(ego, 81, 165);        egoDir = STOPPED;        draw(ego);        set(fUsingLetter);        }      }    else      {      print("Ya ain't even got a letter!");      }    }  }[ look cannonif (said("examine", "cannon"))  {  print("Hmmmmmm...a cannon on a tombstone...interestin'!");  }  [ look psalmif (said("examine", "psalm"))  {  print("Hmmmmmm...Psalm 23...ain't that a book in the Bible?");  }  [ read psalmif (said("read", "psalm"))  {  if (!has("Bible"))    {    print("Hmmmmmm...Psalm 23...ain't that a book in the Bible?");    }  }  [ look name/read nameif ((said("examine", "name") || said("read", "name")))  {  print("The name on this here tombstone reminds you of yer pa, Marshall "        "Wilson.");  }  [ read tombstoneif ((said("read", "gravestone") ||     said("read", "word") ||     said("read", "grave")))  {  print("The tombstone reads:\n       Psalm 23\n\n    Wilson Marshall\n\n Died "        "January 24, 1848\n Mourned by sons James\n      and Jerrod\n\nA place "        "in our hearts is\nreserved for you always\n\n");  }  [ look wordsif (said("examine", "word"))  {  print("The engravin' ain't fancy, but a body can read it, and everythin' is "        "spelled right.");  }  [ use shovel/dig for goldif ((said("use", "shovel") ||     said("dig", "gold") ||     said("dig") ||     said("dig", "hole")))  {  [ if Jerrod has a shovel  if (has("Shovel"))    {    print("Don't dig in a cemetery!");    }  else    {    print("Ya ain't got no shovel!");    }  }  [ rotate letterif ((said("rotate", "letter") ||     said("rotate", "across", "letter") ||     said("rotate", "letter", "across")))  {  [ if using letter  if (isset(fUsingLetter))    {    print("Believe me, this is the best position for the letter!");    }  else    {    [ reset match flag so main logic can handle this input    reset(haveMatch);    }  }  [ get letterif (said("acquire", "letter"))  {  [ if Jerrod already has the letter  if (has("Letter"))    {    print("Ya already got the letter!");    }  else    {    print("There ain't no letter to get right here!");    }  }  [ look/look aroundif ((said("examine", "around") ||     said("examine") ||     said("examine", "gravestone") ||     said("examine", "rock") ||     said("examine", "grave")))  {  print("This tombstone looks like it was made in a hurry, but somehow seems "        "unique.");  }  [ put letter away/put letter backif ((said("place", "letter", "away") ||     said("place", "letter", "back") ||     said("place", "letter", "back", "pocket") ||     said("place", "letter", "back", "in", "pocket") ||     said("place", "letter", "in", "back", "pocket") ||     said("place", "letter", "pocket") ||     said("place", "letter", "in", "pocket")))  {  [ if using the letter on the tombstone  if (isset(fUsingLetter))    {    [ remove it from screen    erase(ego);    [ reset the flag    reset(fUsingLetter);    }  else    {    [ if Jerrod has the letter    if (has("Letter"))      {      print("The letter's already in yer pocket!");      }    else      {      print("Ya ain't even got a letter!");      }    }  }  Done:[ if status update is neededif (isset(UpdateStatus))  {  [ add instructions at bottom of screen  display(24, 0, "<F8> to return to the cemetery.");  }  return();[ **************************************[ MESSAGES[ **************************************#message 1 "<F8> to return to the cemetery."#message 2 "You must be a genius!!"#message 3 "Ya take the letter from yer long-lost brother out of yer pocket and hold it up to the tombstone."#message 4 "Yer already doin' that!"#message 5 "That ain't a bad idea, but it'll be difficult 'cause the letter's still in the envelope!"#message 6 " Hold it right there!!! "#message 7 "Through the holes in the letter ya see these characters:  R 2 1 O O M ."#message 8 "Ya ain't even got a letter!"#message 9 "Hmmmmmm...a cannon on a tombstone...interestin'!"#message 10 "Hmmmmmm...Psalm 23...ain't that a book in the Bible?"#message 11 "The name on this here tombstone reminds you of yer pa, Marshall Wilson."#message 12 "The tombstone reads:\n       Psalm 23\n\n    Wilson Marshall\n\n Died January 24, 1848\n Mourned by sons James\n      and Jerrod\n\nA place in our hearts is\nreserved for you always\n\n"#message 13 "The engravin' ain't fancy, but a body can read it, and everythin' is spelled right."#message 15 "Believe me, this is the best position for the letter!"#message 16 "Ya already got the letter!"#message 17 "There ain't no letter to get right here!"#message 18 "This tombstone looks like it was made in a hurry, but somehow seems unique."#message 19 "The letter's already in yer pocket!"#message 150 "Don't dig in a cemetery!"#message 151 "Ya ain't got no shovel!"
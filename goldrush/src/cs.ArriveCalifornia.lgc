[***********************************************************[[ cs.ArriveCalifornia[[ This cut scene shows a close up of San Francisco Bay and[ the lower Sacramento River basin. Jerrod's progress to[ Sacramento is tracked by a flashing marker.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oBlock1                      o1#define oBlock2                      o2#define oBlock3                      o3#define oBlock4                      o4#define oBlock5                      o5#define oBlock6                      o6#define oBlock7                      o7#define oBlock8                      o8#define oBlock9                      o9#define oBlock10                    o10#define oBlock11                    o11#define oBlock12                    o12[ o13 through o19 are not used#define oMarker                     o20[ v220 is not used#define vBlock1Dist                v221#define vBlock2Dist                v222#define vBlock3Dist                v223#define vBlock4Dist                v224#define vBlock5Dist                v225#define vBlock6Dist                v226#define vBlock7Dist                v227#define vBlock8Dist                v228#define vBlock9Dist                v229#define vBlock10Dist               v230#define vBlock11Dist               v231#define vBlock12Dist               v232#define vMsgTimer                  v233[ v234 through v237 are not used#define vMarkerX                   v238#define vMarkerY                   v239#define vMovePoint                 v240#define vTmpVar                    v241#define fMarkerMoved               f220#define fSoundDone                 f221[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load timing logic based on which trip was taken  if (TicketChoice == TKT_CAPE)    {    load.logics(lgc.CapeTripTiming);    }  if (TicketChoice == TKT_PANAMA)    {    load.logics(lgc.PanamaTripTiming);    }    [ load picture for current room  load.pic(currentRoom);    [ load artwork to manage cursor and path blocks  load.view(vw.CapeRouteArt);    [ load sound used in the room  load.sound(m.ArriveCA);    [ draw the picture  draw.pic(currentRoom);    [ use blocks to cover up the marker route; they will be  [ removed as the marker moves to show the traced route  animate.obj(oBlock1);  set.view(oBlock1, vw.CapeRouteArt);  set.loop(oBlock1, 0);  set.cel(oBlock1, 0);  position(oBlock1, 29, 162);  set.priority(oBlock1, 5);  draw(oBlock1);  stop.cycling(oBlock1);  [ block 2  animate.obj(oBlock2);  set.view(oBlock2, vw.CapeRouteArt);  set.loop(oBlock2, 0);  set.cel(oBlock2, 0);  position(oBlock2, 33, 148);  set.priority(oBlock2, 5);  draw(oBlock2);  stop.cycling(oBlock2);  [ block 3  animate.obj(oBlock3);  set.view(oBlock3, vw.CapeRouteArt);  set.loop(oBlock3, 0);  set.cel(oBlock3, 0);  position(oBlock3, 41, 134);  set.priority(oBlock3, 5);  draw(oBlock3);  stop.cycling(oBlock3);  [ block 4  animate.obj(oBlock4);  set.view(oBlock4, vw.CapeRouteArt);  set.loop(oBlock4, 0);  set.cel(oBlock4, 0);  position(oBlock4, 50, 120);  set.priority(oBlock4, 5);  draw(oBlock4);  stop.cycling(oBlock4);  [ block 5  animate.obj(oBlock5);  set.view(oBlock5, vw.CapeRouteArt);  set.loop(oBlock5, 0);  set.cel(oBlock5, 0);  position(oBlock5, 50, 106);  set.priority(oBlock5, 5);  draw(oBlock5);  stop.cycling(oBlock5);  [ block 6  animate.obj(oBlock6);  set.view(oBlock6, vw.CapeRouteArt);  set.loop(oBlock6, 0);  set.cel(oBlock6, 0);  position(oBlock6, 64, 101);  set.priority(oBlock6, 5);  draw(oBlock6);  stop.cycling(oBlock6);  [ block 7  animate.obj(oBlock7);  set.view(oBlock7, vw.CapeRouteArt);  set.loop(oBlock7, 0);  set.cel(oBlock7, 0);  position(oBlock7, 69, 96);  set.priority(oBlock7, 5);  draw(oBlock7);  stop.cycling(oBlock7);  [ block 8  animate.obj(oBlock8);  set.view(oBlock8, vw.CapeRouteArt);  set.loop(oBlock8, 0);  set.cel(oBlock8, 0);  position(oBlock8, 83, 100);  set.priority(oBlock8, 5);  draw(oBlock8);  stop.cycling(oBlock8);  [ block 9  animate.obj(oBlock9);  set.view(oBlock9, vw.CapeRouteArt);  set.loop(oBlock9, 0);  set.cel(oBlock9, 2);  position(oBlock9, 87, 92);  set.priority(oBlock9, 6);  draw(oBlock9);  stop.cycling(oBlock9);  [ block 10  animate.obj(oBlock10);  set.view(oBlock10, vw.CapeRouteArt);  set.loop(oBlock10, 0);  set.cel(oBlock10, 2);  position(oBlock10, 93, 78);  set.priority(oBlock10, 6);  draw(oBlock10);  stop.cycling(oBlock10);  [ block 11  animate.obj(oBlock11);  set.view(oBlock11, vw.CapeRouteArt);  set.loop(oBlock11, 0);  set.cel(oBlock11, 2);  position(oBlock11, 93, 64);  set.priority(oBlock11, 6);  draw(oBlock11);  stop.cycling(oBlock11);  [ block 12  animate.obj(oBlock12);  set.view(oBlock12, vw.CapeRouteArt);  set.loop(oBlock12, 0);  set.cel(oBlock12, 2);  position(oBlock12, 93, 50);  set.priority(oBlock12, 6);  draw(oBlock12);  stop.cycling(oBlock12);    [ flashing marker - the marker is of a special size and  [ shape that uses the priority value of the route on the  [ picture to show the marker as a single flashing pixel  [ that moves along the trip path line  animate.obj(oMarker);  set.view(oMarker, vw.CapeRouteArt);  set.loop(oMarker, 7);  fix.loop(oMarker);  position(oMarker, 21, 167);  set.priority(oMarker, 8);  ignore.objs(oMarker);  draw(oMarker);  vTmpVar = 2;  step.time(oMarker, vTmpVar);  move.obj(oMarker, 33, 144, 1, fMarkerMoved);  vMovePoint = 1;    [ now show the picture  show.pic();  }  [ **************************************[ EVERY CYCLE[ **************************************[ as the marker moves along the path, adjust its destination[ point as neededif (isset(fMarkerMoved) && vMovePoint == 1)  {  reset(fMarkerMoved);  vMovePoint = 2;  move.obj(oMarker, 47, 108, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 2)  {  reset(fMarkerMoved);  vMovePoint = 3;  move.obj(oMarker, 61, 105, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 3)  {  reset(fMarkerMoved);  vMovePoint = 4;  move.obj(oMarker, 64, 101, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 4)  {  reset(fMarkerMoved);  vMovePoint = 5;  [ need to make a slight adjustment to marker position at  [ this location on the route  TmpX = 3;  TmpY = -12; [ 244;  reposition(oMarker, TmpX, TmpY);  move.obj(oMarker, 67, 92, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 5)  {  reset(fMarkerMoved);  vMovePoint = 6;  move.obj(oMarker, 70, 95, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 6)  {  reset(fMarkerMoved);  vMovePoint = 7;  move.obj(oMarker, 69, 96, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 7)  {  reset(fMarkerMoved);  vMovePoint = 8;  [ need to make a slight adjustment to marker position at  [ this location on the route  TmpX = 14;  TmpY = 14;  reposition(oMarker, TmpX, TmpY);  move.obj(oMarker, 83, 93, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 8)  {  reset(fMarkerMoved);  vMovePoint = 9;  move.obj(oMarker, 93, 51, 1, fMarkerMoved);  }  [ when marker gets to final ending pointif (isset(fMarkerMoved) && vMovePoint == 9)  {  reset(fMarkerMoved);  vMovePoint = 10;    [ review player's score so far - notice that if the player  [ has read the Bible hint, their total score is not  [ shown; this seems like a bug to me - they should have  [ included player's score in the message like they do when  [ the psalm hasn't been read    [ if coming by the Panama route  if (TicketChoice == TKT_PANAMA)    {    [ if Jerrod has read the bible hint    if (isset(ReadBibleHint))      {      print("There are 100 points possible so far (not including the points for "            "reading Psalm 23).");      }    else      {      if (currentScore < 100)        {        print("You have %v3 points out of the 100 possible. Don't give up!");        }      if (currentScore == 100)        {        print("You have 100 out of 100! You are right on trek!!");        }      }    }  [ if coming by Cape Horn route  if (TicketChoice == TKT_CAPE)    {    [ if Jerrod has read the bible hint    if (isset(ReadBibleHint))      {      print("There are 95 points possible so far (not including the points for "            "reading Psalm 23).");      }    else      {      if (currentScore < 95)        {        print("You have %v3 points out of the 95 possible. Don't give up!");        }      if (currentScore == 95)        {        print("You have 95 out of 95! You are right on trek!!");        }      }    }  [ set flag to continue the journey  set(ContinueJourney);  }  [ use distance between marker and blocks to determine when[ to erase themdistance(oMarker, oBlock1, vBlock1Dist);if (vBlock1Dist == 3)  {  erase(oBlock1);  }distance(oMarker, oBlock2, vBlock2Dist);if (vBlock2Dist == 1)  {  erase(oBlock2);  }distance(oMarker, oBlock3, vBlock3Dist);if (vBlock3Dist == 2)  {  erase(oBlock3);  }distance(oMarker, oBlock4, vBlock4Dist);if (vBlock4Dist == 3)  {  erase(oBlock4);  }distance(oMarker, oBlock5, vBlock5Dist);if (vBlock5Dist == 1)  {  erase(oBlock5);  }distance(oMarker, oBlock6, vBlock6Dist);if (vBlock6Dist == 1)  {  [ get position of marker  get.posn(oMarker, vMarkerX, vMarkerY);  vBlock1Dist = vw.CapeRouteArt;  vBlock2Dist = 1;  vBlock3Dist = 1;  vBlock4Dist = 8;  [ add the marker view to map permanently  add.to.pic.v(vBlock1Dist, vBlock2Dist, vBlock3Dist, vMarkerX, vMarkerY, vBlock4Dist, vBlock4Dist);  [ then erase block6  erase(oBlock6);  [ this is needed to keep the track fully drawn after the  [ cursor is adjusted a few spaces for next segment of the  [ journey  }distance(oMarker, oBlock7, vBlock7Dist);if (vBlock7Dist == 2)  {  erase(oBlock7);  }distance(oMarker, oBlock8, vBlock8Dist);if (vBlock8Dist == 1)  {  erase(oBlock8);  }distance(oMarker, oBlock9, vBlock9Dist);if (vBlock9Dist == 3)  {  erase(oBlock9);  }distance(oMarker, oBlock10, vBlock10Dist);if (vBlock10Dist == 1)  {  erase(oBlock10);  }distance(oMarker, oBlock11, vBlock11Dist);if (vBlock11Dist == 1)  {  erase(oBlock11);  }distance(oMarker, oBlock12, vBlock12Dist);if (vBlock12Dist == 1)  {  erase(oBlock12);  }  [ at certain locations of Cape Horn trip, show informational[ messages, unless they are supressedif (TicketChoice == TKT_CAPE)  {  if (posn(oMarker, 33, 152, 33, 152) && vMsgTimer == 0)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("All hands are on deck as you approach California! To the gold "            "seeking passengers on board, it is the long-awaited promised land!");      }    }  if (posn(oMarker, 39, 138, 39, 138) && vMsgTimer == 1)    {    ++vMsgTimer;    [ play the sound marking arrival in California    sound(m.ArriveCA, fSoundDone);    if (!isset(HideTripMsgs))      {      print("Everyone cheers for the captain as he guides the ship through the "            "\"Golden Gate.\"");      print("The shoreline is covered with lush green plants.");      print("What a beautiful sight!!");      }    }  if (posn(oMarker, 46, 131, 46, 131) && vMsgTimer == 2)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("The bay is filled with boats of all kinds from every country.");      print("The boats and ships are too numerous to count. It looks as if they "            "are stacked on top of each other!!");      print("But they seem to be deserted ... ");      print("Everyone on board is sure they are too late now!!");      print("Energy levels run high among the prospectors on board.");      print("They know there is no time to waste!");      }    }  if (posn(oMarker, 52, 105, 52, 105) && vMsgTimer == 3)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("The captain takes you across the bay and up the Sacramento River.");      }    }  }  [ as certain locations of Panama trip, show informational[ messages, unless they are supressedif (TicketChoice == TKT_PANAMA)  {  if (posn(oMarker, 33, 152, 33, 152) && vMsgTimer == 0)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      [ play the sound marking arrival in California      sound(m.ArriveCA, fSoundDone);      print("No one on board wants to miss the sight of sailing through that "            "\"Golden Gate\"!");      print("The railing is lined with passengers!!");      }    }  if (posn(oMarker, 39, 138, 39, 138) && vMsgTimer == 1)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("A loud cheer goes up from the crowd on board as the ship enters "            "into the beautiful bay!!");      print("It makes a chill run up and down your spine!");      print("It is a sight you will not soon forget!!");      }    }  if (posn(oMarker, 46, 131, 46, 131) && vMsgTimer == 2)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("The south edge of the bay is lined with small buildings. There are "            "a few boats and ships moored at the docks.");      print("That must be the settlement of Yuerba Buena, soon to be called San "            "Francisco.");      print("It looks like the ship you are riding on is one of the first to "            "arrive!!");      print("This brings a little glimmer into every eye on board!!");      }    }  if (posn(oMarker, 52, 105, 52, 105) && vMsgTimer == 3)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("The ship isn't moving fast enough! If the captain passed out oars, "            "you would gladly row, if it would save one minute!! You are ready "            "to start panning for that\n\n    CALIFORNIA GOLD!!");      }    }  }    [ there is no input processed in this logic, so this[ boilerplate piece of code could have been removedif (!isset(haveInput))  {  goto(Done);  }  Done:[ call the appropriate main timing logicif (TicketChoice == TKT_CAPE)  {  call(lgc.CapeTripTiming);  }if (TicketChoice == TKT_PANAMA)  {  call(lgc.PanamaTripTiming);  }  return();[ **************************************[ MESSAGES[ **************************************#message 1 "All hands are on deck as you approach California! To the gold seeking passengers on board, it is the long-awaited promised land!"#message 2 "Everyone cheers for the captain as he guides the ship through the \"Golden Gate.\""#message 5 "The shoreline is covered with lush green plants."#message 6 "What a beautiful sight!!"#message 10 "The bay is filled with boats of all kinds from every country."#message 11 "But they seem to be deserted ... "#message 12 "Everyone on board is sure they are too late now!!"#message 13 "Energy levels run high among the prospectors on board."#message 14 "They know there is no time to waste!"#message 20 "The captain takes you across the bay and up the Sacramento River."#message 101 "The boats and ships are too numerous to count. It looks as if they are stacked on top of each other!!"#message 201 "No one on board wants to miss the sight of sailing through that \"Golden Gate\"!"#message 202 "The railing is lined with passengers!!"#message 203 "A loud cheer goes up from the crowd on board as the ship enters into the beautiful bay!!"#message 204 "It makes a chill run up and down your spine!"#message 205 "It is a sight you will not soon forget!!"#message 210 "The south edge of the bay is lined with small buildings. There are a few boats and ships moored at the docks."#message 211 "That must be the settlement of Yuerba Buena, soon to be called San Francisco."#message 212 "It looks like the ship you are riding on is one of the first to arrive!!"#message 213 "This brings a little glimmer into every eye on board!!"#message 220 "The ship isn't moving fast enough! If the captain passed out oars, you would gladly row, if it would save one minute!! You are ready to start panning for that\n\n    CALIFORNIA GOLD!!"#message 228 "There are 95 points possible so far (not including the points for reading Psalm 23)."#message 229 "There are 100 points possible so far (not including the points for reading Psalm 23)."#message 230 "You have %v3 points out of the 100 possible. Don't give up!"#message 231 "You have 100 out of 100! You are right on trek!!"#message 233 "You have %v3 points out of the 95 possible. Don't give up!"#message 234 "You have 95 out of 95! You are right on trek!!"
[***********************************************************[[ rm.Hotel2ndFloorLeft[ [ This room is the interior hallway on the second floor, [ left side, of the hotel Green Pastures. Jerrod needs to[ deliver a message to the guest in room 11 so he can get in[ to search it. [[ There is code in here that restores the input prompt to[ normal, but nowhwere is it ever changed to anything else.[ It looks like the programmers intended to use a different[ prompt when Jerrod is talking to the guest, but then [ decided to take that out. All the code about restoring the[ input prompt is therefore unnecessary in this logic.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oDoor                        o1#define oGuest                       o2#define vTmpVar                    v220#define vKnockStatus               v221#define vKnockTimer                v222#define vGuestStatus               v223#define vGuestTimer                v224#define vGuestX                    v225#define vGuestY                    v226#define vGuestOldX                 v227#define vGuestOldY                 v228#define fDoorOpen                  f220#define fDoorMoved                 f221#define fGuestMoved                f222#define fGuestStopped              f223#define fEffectDone                f224[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load picture for current room  load.pic(currentRoom);    [ load views used in the room  load.view(vw.BigJerrodCA);  load.view(vw.HotelArt);  load.view(vw.HotelGuest);    [ load sounds used in the room  load.sound(m.FoundGold);  load.sound(s.Effect1);  load.sound(s.Effect2);    [ draw the room  draw.pic(currentRoom);  [ add artwork to show interior of room 11  add.to.pic(vw.HotelArt, 0, 6, 116, 63, 4, 4);    [ animate the door to room 11  animate.obj(oDoor);  set.view(oDoor, vw.HotelArt);  set.loop(oDoor, 1);  set.cel(oDoor, 0);  set.priority(oDoor, 6);  ignore.blocks(oDoor);  ignore.objs(oDoor);  position(oDoor, 115, 63);  draw(oDoor);  stop.update(oDoor);    [ hotel guest  animate.obj(oGuest);  set.view(oGuest, vw.HotelGuest);  set.priority(oGuest, 5);  [ guest ignores blocks (so he goes through the door  [ correctly)  ignore.blocks(oGuest);  [ he starts at the right edge of the screen but behind the  [ wall, out of sight (in room 11)  position(oGuest, 130, 61);  draw(oGuest);  stop.update(oGuest);    [ Jerrod, using the large California view  animate.obj(ego);  vTmpVar = 2;  step.size(ego, vTmpVar);  set.view(ego, vw.BigJerrodCA);  draw(ego);    [ show the picture  show.pic();    [ add a block, so Jerrod can't enter room 11 with the door  [ closed  block(110, 50, 120, 66);  }  [ **************************************[ EVERY CYCLE[ **************************************[ if Jerrod has knocked on the door to room 10if (vKnockStatus == 1)  {  [ increment the message timer  ++vKnockTimer;  [ after twenty cycles  if (vKnockTimer == 20)    {    [ reset timer    vKnockTimer = 0;    [ go to next step in sequence (wait for response)    vKnockStatus = 2;    [ dismiss any open message window    close.window();    }  }  [ if waiting for answer to knockingif (vKnockStatus == 2)  {  [ increment timer  ++vKnockTimer;  [ after twenty cycles  if (vKnockTimer == 20)    {    [ reset timer    vKnockTimer = 0;    [ present reply, depending on status of guest    vKnockStatus = 3;        [ if Jerrod has moved away from door 10    if (posn(ego, 40, 65, 54, 71))      {      print.at("No one's comin' to the door.", 12, 5, 0);      }    else      {      [ if the guest is NOT in room 10      if (isset(HotelRoomEmpty))        {        print.at("No one's comin' to the door.", 12, 18, 19);        }      else        {        [ begin sequence of guest coming to door        vGuestStatus = 1;        print.at("Sounds like someone's comin' to the door.", 12, 10, 28);        }      }    }  }  [ after reply is displayedif (vKnockStatus == 3)  {  [ increment timer  ++vKnockTimer;  [ after twenty cycles  if (vKnockTimer == 20)    {    [ reset timer and status    vKnockTimer = 0;    vKnockStatus = 0;    [ dismiss any open message window    close.window();    }  }  [ if guest is coming to the doorif (vGuestStatus == 1)  {  [ increment timer  ++vGuestTimer;  [ after 30 cycles  if (vGuestTimer == 30)    {    [ reset timer    vGuestTimer = 0;    [ now guest opens the door    ++vGuestStatus;    sound(s.Effect1, fEffectDone);    start.update(oDoor);    set(fDoorOpen);    end.of.loop(oDoor, fDoorMoved);    }  }  [ if guest in room 10 has opened his doorif (isset(fDoorMoved) && vGuestStatus == 2)  {  reset(fDoorMoved);  [ next step is for guest to come out  ++vGuestStatus;  start.update(oGuest);  move.obj(oGuest, 116, 61, 2, fGuestMoved);  }  [ after guest gets to the open doorif (isset(fGuestMoved) && vGuestStatus == 3)  {  [ now guest 'greets' Jerrod, and waits for response  reset(fGuestMoved);  ++vGuestStatus;  [ he turns to face Jerrod  set.loop(oGuest, 2);  force.update(oGuest);  stop.cycling(oGuest);  print.at("Yeah, whadayawant?", 2, 18, 0);  }  [ if guest it waiting for Jerrod to respond but Jerrod has [ walked awayif (!posn(ego, 110, 65, 124, 71) && vGuestStatus == 4)  {  [ reset input prompt (this is unnecessary - the prompt  [ never gets changed in this room)  set.string(inputPrompt, "%g69");  [ force it to redraw  accept.input();  inputLength = 38;  }  [ while guest is waiting for response from Jerrodif (vGuestStatus == 4)  {  [ increment timer  ++vGuestTimer;  [ after 150 cycles  if (vGuestTimer == 150)    {    [ guest goes back into his room    vGuestTimer = 0;    ++vGuestStatus;    move.obj(oGuest, 130, 61, 2, fGuestMoved);    start.cycling(oGuest);    [ dismiss any open message window    close.window();    [ and also restore normal input (this is unnecessary -    [ the prompt never gets changed in this room)    set.string(inputPrompt, "%g69");    accept.input();    inputLength = 38;    }  }  [ once guest has returned to inside his roomif (isset(fGuestMoved) && vGuestStatus == 5)  {  [ he closes the door  reset(fDoorMoved);  ++vGuestStatus;  [ no need to update; he's hidden behind wall again  stop.update(oGuest);  [ cycle the door closed  reset(fDoorOpen);  reverse.loop(oDoor, fDoorMoved);  }  [ once the door closesif (isset(fDoorMoved) && vGuestStatus == 6)  {  [ guest status returns to 'waiting'  reset(fDoorMoved);  vGuestStatus = 0;  stop.update(oDoor);  sound(s.Effect2, fEffectDone);  }  [ if guest is leavingif (isset(fGuestMoved) && vGuestStatus == 10)  {  [ move guest to end of hall  reset(fGuestMoved);  ++vGuestStatus;  [ guest is no longer in the room  set(HotelRoomEmpty);  move.obj(oGuest, 148, 69, 2, fGuestMoved);  [ remove the block; Jerrod is now free to go into this  [ guest's room to search for clues  unblock();  }  [ when guest gets to end of hallif (isset(fGuestMoved) && vGuestStatus == 11)  {  [ he's gone; erase him from screen and reset status counter  reset(fGuestMoved);  vGuestStatus = 0;  erase(oGuest);  }  [ while guest is leavingif ((vGuestStatus == 10 || vGuestStatus == 11))  {  [ if he stops for any reason, he stops cycling until he  [ starts moving again  get.posn(oGuest, vGuestX, vGuestY);  if (vGuestOldX == vGuestX && vGuestOldY == vGuestY)    {    [ if guest hasn't stopped yet    if (!isset(fGuestStopped))      {      [ stop him      set(fGuestStopped);      stop.cycling(oGuest);      [ guest is rude - he yells at Jerrod      set(leaveWindow);      print.at("Yer in my way, man!", 12, 24, 8);      }    }  else    {    [ if moving, and was previously stopped    if (isset(fGuestStopped))      {      [ reset stopped flag, begin cycling, and dismiss      [ his rude message      reset(fGuestStopped);      start.cycling(oGuest);      [ dismiss the message window      close.window();      }    }    [ save guest position  vGuestOldX = vGuestX;  vGuestOldY = vGuestY;  }  [ **************************************[ CHECK FOR AN EXIT CONDITION[ **************************************if (posn(ego, 147, 65, 148, 88))  {  position(ego, 3, 75);  new.room(rm.Hotel2ndFloorRight); [ ##LE001##  }if (posn(ego, 114, 64, 118, 65))  {  position(ego, 67, 162);  new.room(rm.Hotel11); [ ##LE002##  }  [ **************************************[ PROCESS PLAYER INPUT[ **************************************[ if player hasn't provided input no need to do said testsif (!isset(haveInput))  {  goto(Done);  }  [ anytime player inputs anything, always restore input[ prompt to the default (this is unnecessary - the prompt[ never gets changed in this room)set.string(inputPrompt, "%g69");[ force it to updateaccept.input();inputLength = 38;[ open doorif ((said("open", "door") ||     said("pull", "door") ||     said("push", "door") ||     said("move", "door") ||     said("go", "around") ||     said("enter", "around") ||     said("go", "door") ||     said("enter", "door") ||     said("boardwalk", "door") ||     said("boardwalk", "in") ||     said("boardwalk", "in", "around") ||     said("boardwalk", "in", "door")))  {  [ if by room10 door or by room11 door  if ((posn(ego, 40, 65, 54, 71) ||       posn(ego, 110, 65, 124, 71)))    {    [ if by room 10    if (posn(ego, 40, 65, 54, 71))      {      [ it is always locked      print("This door's locked.");      }    [ if by room 11    if (posn(ego, 110, 65, 124, 71))      {      [ if the door is open      if (isset(fDoorOpen))        {        [ say so        print("The door's already open.");        }      else        {        [ when it's closed, it's also locked        print("This door's locked.");        }      }    }  else    {    print("Yer not close enough.");    }  }  [ knock on doorif ((said("knock", "knock") ||     said("knock", "door") ||     said("knock") ||     said("knock", "knock", "knock")))  {  [ if Jerrod is by room 10 or room 11 door  if ((posn(ego, 40, 65, 54, 71) ||       posn(ego, 110, 65, 124, 71)))    {    [ if by room 10 door    if (posn(ego, 40, 65, 54, 71))      {      [ begin knocking sequence      print.at("Knock, knock, knock...", 12, 5, 0);      vKnockStatus = 1;      }    [ if by room 11 door    if (posn(ego, 110, 65, 124, 71))      {      [ if Jerrod has deciphered Jake's message about      [ room 12      if (isset(ScoreLetterClue))        {        [ if door is open        if (isset(fDoorOpen))          {          [ say so          print("The door's already open.");          }        else          {          [ otherwise, begin knock sequence          print.at("Knock, knock, knock...", 12, 15, 0);          vKnockStatus = 1;          }        }      else        {        print("That would be easy enough, but right now you have no reason to.");        }      }    }  else    {    print("Yer not close enough.");    }  }[ deliver messageif ((said("contribute", "message") ||     said("contribute", "anyword", "message") ||     said("contribute", "message", "rol")))  {  [ if Jake has the message from the hotel clerk  if (has("Message for room 11"))    {    [ if guest hasn't come to the door yet    if ((vGuestStatus == 0 ||         vGuestStatus == 1 ||         vGuestStatus == 2))      {      print("There's no one to give it to!");      }          [ if guest is in sight, but not quite done moving    if (vGuestStatus == 3)      {      print("Be patient, the beggar is almost here!");      }          [ if guest is leaving    if ((vGuestStatus == 10 || vGuestStatus == 11))      {      print("The beggar already has the message.");      }          [ if guest is waiting for Jerrod to respond    if (vGuestStatus == 4)      {      [ deliver the message      print("The beggar, somewhat surprised that you are bringin' him a "            "message, takes it and begins to read it.");      print("The man's face drops in some kind of emotion. He looks up from the "            "message and says...");      [ play sound for scoring points      sound(m.FoundGold, fEffectDone);      print.at("\"I gotta go.\"", 12, 23, 0);            [ guest has the message now      drop("Message for room 11");      [ and the guest is also leaving      vGuestStatus = 10;      move.obj(oGuest, 116, 69, 2, fGuestMoved);      start.cycling(oGuest);      release.priority(oGuest);      [ score 3 points      currentScore  += 3;      }          [ if guest is returning to his room    if (vGuestStatus == 5)      {      print("Sorry! Too late, the beggar is walking away!");      }    [ if door is closing    if (vGuestStatus == 6)      {      print("There's no one to give it to!");      }    }  else    {    print("Ya have no message to give.");    }  }  [ look around/lookif ((said("examine", "around") ||     said("examine") ||     said("examine", "hall")))  {  print("This is the end of the upper hallway. Ya see two doors.");  }  [ look windowif (said("examine", "glass"))  {  print("Ya see nothing of interest.");  }  [ look carpet/look floorif ((said("examine", "carpet") ||     said("examine", "deck")))  {  print("It's a hardwood floor covered with carpeting.");  }  [ look wallif ((said("examine", "wall") ||     said("examine", "wall", "newspaper") ||     said("examine", "wallpaper")))  {  print("The walls have nice wallpaper on 'em.");  }  [ look message/read messageif ((said("examine", "message") ||     said("read", "message") ||     said("open", "message")))  {  if (has("Message for room 11"))    {    print("The message is written on a folded piece of paper with only one word "          "visible on the outside...");    print("\n CONFIDENTIAL!! \n \n");    }  else    {    print("Ya don't have a message.");    }  }  [ look doorif (said("examine", "door"))  {  [ if closer to room 10 door  if (posn(ego, 0, 60, 83, 165))    {    print("This is the door to room 10.");    }  else    {    print("This is the door to room 11.");    }  }[ look number/look door numberif ((said("examine", "number") ||     said("examine", "door", "number")))  {  [ if by either door  if ((posn(ego, 40, 65, 54, 71) ||       posn(ego, 110, 65, 124, 71)))    {    [ if by room 10    if (posn(ego, 40, 65, 54, 71))      {      print("The number on the door is \"10\".");      }    else      {      print("The number on the door is \"11\".");      }    }  else    {    print("Ya cain't see any numbers from here.");    }  }  [ look manif (said("examine", "boy"))  {  [ if the guest is not around  if ((vGuestStatus == 0 ||       vGuestStatus == 1 ||       vGuestStatus == 2 ||       vGuestStatus == 6))    {    print("There's not a soul in sight!");    }  [ if guest is here, but hasn't gotten his message yet  if ((vGuestStatus == 3 ||       vGuestStatus == 4 ||       vGuestStatus == 5))    {    print("It looks like this man has a lot on his mind.");    }  [ if guest is on his way out  if ((vGuestStatus == 10 ||       vGuestStatus == 11))    {    print("It looks like he's in a hurry!");    }  }  [ talk man/talkif ((said("speak", "boy") ||     said("speak")))  {  [ if guest is not around  if ((vGuestStatus == 0 ||       vGuestStatus == 1 ||       vGuestStatus == 2 ||       vGuestStatus == 6))    {    print("There's not a soul in sight!");    }  [ if guest is here, but hasn't gotten his message yet  if ((vGuestStatus == 3 ||       vGuestStatus == 4 ||       vGuestStatus == 5))    {    print("Yer the one that knocked on the door! You say something!");    }  [ if guest is on his way out  if ((vGuestStatus == 10 ||       vGuestStatus == 11))    {    print("He's got no time to talk now!");    }  }  [ unlock doorif ((said("unlock", "door") ||     said("use", "house key")))  {  print("Ya have nothin' to do that with!");  }  Done:[ if an unknown word was enteredif (unknownWordNum > 0)  {  [ make sure input line is returned to normal (this is  [ unnecessary - the prompt never gets changed in this  [ room)  set.string(inputPrompt, "%g69");  accept.input();  inputLength = 38;  }  return();[ **************************************[ MESSAGES[ **************************************#message 1 "This door's locked."#message 2 "The door's already open."#message 3 "Yer not close enough."#message 4 "Knock, knock, knock..."#message 5 "No one's comin' to the door."#message 6 "Sounds like someone's comin' to the door."#message 7 "Yeah, whadayawant?"#message 9 "%g69"#message 10 "There's no one to give it to!"#message 11 "Be patient, the beggar is almost here!"#message 12 "Sorry! Too late, the beggar is walking away!"#message 13 "The beggar, somewhat surprised that you are bringin' him a message, takes it and begins to read it."#message 14 "The man's face drops in some kind of emotion. He looks up from the message and says..."#message 15 "\"I gotta go.\""#message 16 "Yer in my way, man!"#message 17 "The beggar already has the message."#message 18 "Ya have no message to give."#message 19 "This is the end of the upper hallway. Ya see two doors."#message 20 "Ya see nothing of interest."#message 21 "It's a hardwood floor covered with carpeting."#message 22 "The walls have nice wallpaper on 'em."#message 23 "The message is written on a folded piece of paper with only one word visible on the outside..."#message 24 "\n CONFIDENTIAL!! \n \n"#message 25 "Ya don't have a message."#message 26 "This is the door to room 10."#message 27 "This is the door to room 11."#message 28 "The number on the door is \"10\"."#message 29 "The number on the door is \"11\"."#message 30 "Ya cain't see any numbers from here."#message 31 "There's not a soul in sight!"#message 32 "It looks like this man has a lot on his mind."#message 33 "It looks like he's in a hurry!"#message 34 "Yer the one that knocked on the door! You say something!"#message 35 "He's got no time to talk now!"#message 36 "That would be easy enough, but right now you have no reason to."#message 42 "Ya have nothin' to do that with!"
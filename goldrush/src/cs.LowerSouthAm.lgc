[***********************************************************[[ cs.LowerSouthAm[[ This logic manages the cutscenes and rooms that make up[ the Cape Horn route from Rio de Janeiro, around the Horn[ and up the west coast of South America.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oBlock1                      o1#define oBlock2                      o2#define oBlock3                      o3#define oBlock4                      o4#define oBlock5                      o5#define oBlock6                      o6#define oBlock7                      o7#define oBlock8                      o8#define oBlock9                      o9#define oBlock10                    o10[ o11 through o19 are not used#define oMarker                     o20[ v220 through v231 are not used#define vTimeCounter               v233#define vMsgTimer                  v234[ v235 through v237 are not used#define vMarkerX                   v238#define vMarkerY                   v239#define vMovePoint                 v240#define vTmpVar                    v241#define fMarkerMoved               f220[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load the timing logic  load.logics(lgc.CapeTripTiming);    [ load picture for current room  load.pic(currentRoom);    [ load view with blocking markers cursors  load.view(vw.CapeRouteArt);    [ draw the picture  draw.pic(currentRoom);    [ if marker is moving south toward the Cape  if (CurrentTripTime == TripPoint_8)    {    [ permanently cover up the portions of the route that    [ aren't uncovered in this sequence    add.to.pic(vw.CapeRouteArt, 0, 0, 61, 152, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 47, 153, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 139, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 125, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 111, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 97, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 83, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 69, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 55, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 45, 41, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 42, 27, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 42, 13, 5, 5);    [ use blocks to cover up the marker route; they will be    [ removed as the marker moves to show the traced route    animate.obj(oBlock1);    set.view(oBlock1, vw.CapeRouteArt);    set.loop(oBlock1, 0);    set.cel(oBlock1, 0);    position(oBlock1, 116, 26);    set.priority(oBlock1, 5);    ignore.horizon(oBlock1);    draw(oBlock1);    stop.cycling(oBlock1);    [ block 2    animate.obj(oBlock2);    set.view(oBlock2, vw.CapeRouteArt);    set.loop(oBlock2, 0);    set.cel(oBlock2, 0);    position(oBlock2, 110, 40);    set.priority(oBlock2, 5);    draw(oBlock2);    stop.cycling(oBlock2);    [ block 3    animate.obj(oBlock3);    set.view(oBlock3, vw.CapeRouteArt);    set.loop(oBlock3, 0);    set.cel(oBlock3, 0);    position(oBlock3, 100, 54);    set.priority(oBlock3, 5);    draw(oBlock3);    stop.cycling(oBlock3);    [ block 4    animate.obj(oBlock4);    set.view(oBlock4, vw.CapeRouteArt);    set.loop(oBlock4, 0);    set.cel(oBlock4, 0);    position(oBlock4, 91, 68);    set.priority(oBlock4, 5);    draw(oBlock4);    stop.cycling(oBlock4);    [ block 5    animate.obj(oBlock5);    set.view(oBlock5, vw.CapeRouteArt);    set.loop(oBlock5, 0);    set.cel(oBlock5, 0);    position(oBlock5, 80, 82);    set.priority(oBlock5, 5);    draw(oBlock5);    stop.cycling(oBlock5);    [ block 6    animate.obj(oBlock6);    set.view(oBlock6, vw.CapeRouteArt);    set.loop(oBlock6, 0);    set.cel(oBlock6, 0);    position(oBlock6, 74, 96);    set.priority(oBlock6, 5);    draw(oBlock6);    stop.cycling(oBlock6);    [ block 7    animate.obj(oBlock7);    set.view(oBlock7, vw.CapeRouteArt);    set.loop(oBlock7, 0);    set.cel(oBlock7, 0);    position(oBlock7, 69, 110);    set.priority(oBlock7, 5);    draw(oBlock7);    stop.cycling(oBlock7);    [ block 8    animate.obj(oBlock8);    set.view(oBlock8, vw.CapeRouteArt);    set.loop(oBlock8, 0);    set.cel(oBlock8, 0);    position(oBlock8, 64, 124);    set.priority(oBlock8, 5);    draw(oBlock8);    stop.cycling(oBlock8);    [ block 9    animate.obj(oBlock9);    set.view(oBlock9, vw.CapeRouteArt);    set.loop(oBlock9, 0);    set.cel(oBlock9, 0);    position(oBlock9, 62, 138);    set.priority(oBlock9, 5);    draw(oBlock9);    stop.cycling(oBlock9);    [ flashing marker - the marker is of a special size and    [ shape that uses the priority value of the route on the    [ picture to show the marker as a single flashing pixel    [ that moves along the trip path line    animate.obj(oMarker);    set.view(oMarker, vw.CapeRouteArt);    set.loop(oMarker, 4);    fix.loop(oMarker);    position(oMarker, 119, 14);    set.priority(oMarker, 6);    ignore.horizon(oMarker);    ignore.objs(oMarker);    draw(oMarker);    vTmpVar = 2;    step.time(oMarker, vTmpVar);    move.obj(oMarker, 119, 23, 1, fMarkerMoved);    vMovePoint = 1;    }      [ if marker is moving from the Cape up to middle of the  [ map  if (CurrentTripTime == TripPoint_10)    {    [ permanently cover the upper portion of the route that    [ isn't displayed in this sequence    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 139, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 125, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 111, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 97, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 83, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 69, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 38, 55, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 45, 41, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 42, 27, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 42, 13, 5, 5);    [ use blocks to cover up the marker route; they will be    [ removed as the marker moves to show the    [ traced route    animate.obj(oBlock1);    set.view(oBlock1, vw.CapeRouteArt);    set.loop(oBlock1, 0);    set.cel(oBlock1, 0);    position(oBlock1, 61, 152);    set.priority(oBlock1, 5);    ignore.horizon(oBlock1);    draw(oBlock1);    stop.cycling(oBlock1);    [ block 2    animate.obj(oBlock2);    set.view(oBlock2, vw.CapeRouteArt);    set.loop(oBlock2, 0);    set.cel(oBlock2, 0);    position(oBlock2, 47, 153);    set.priority(oBlock2, 5);    draw(oBlock2);    stop.cycling(oBlock2);        [ flashing marker - the marker is of a special size and    [ shape that uses the priority value of the route on the    [ picture to show the marker as a single flashing pixel    [ that moves along the trip path line    animate.obj(oMarker);    set.view(oMarker, vw.CapeRouteArt);    set.loop(oMarker, 2);    fix.loop(oMarker);    position(oMarker, 65, 140);    set.priority(oMarker, 6);    ignore.horizon(oMarker);    ignore.objs(oMarker);    draw(oMarker);    vTmpVar = 2;    step.time(oMarker, vTmpVar);    move.obj(oMarker, 65, 150, 1, fMarkerMoved);    vMovePoint = 1;    }      [ if marker is moving up Pacific Coast to top of screen  if (CurrentTripTime == TripPoint_12)    {    [ use blocks to cover up the marker route; they will be    [ removed as the marker moves to show the traced route    animate.obj(oBlock1);    set.view(oBlock1, vw.CapeRouteArt);    set.loop(oBlock1, 0);    set.cel(oBlock1, 0);    position(oBlock1, 38, 139);    set.priority(oBlock1, 5);    ignore.horizon(oBlock1);    draw(oBlock1);    stop.cycling(oBlock1);    [ block 2    animate.obj(oBlock2);    set.view(oBlock2, vw.CapeRouteArt);    set.loop(oBlock2, 0);    set.cel(oBlock2, 0);    position(oBlock2, 38, 125);    set.priority(oBlock2, 5);    draw(oBlock2);    stop.cycling(oBlock2);    [ block 3    animate.obj(oBlock3);    set.view(oBlock3, vw.CapeRouteArt);    set.loop(oBlock3, 0);    set.cel(oBlock3, 0);    position(oBlock3, 38, 111);    set.priority(oBlock3, 5);    draw(oBlock3);    stop.cycling(oBlock3);    [ block 4    animate.obj(oBlock4);    set.view(oBlock4, vw.CapeRouteArt);    set.loop(oBlock4, 0);    set.cel(oBlock4, 0);    position(oBlock4, 38, 97);    set.priority(oBlock4, 5);    draw(oBlock4);    stop.cycling(oBlock4);    [ block 5    animate.obj(oBlock5);    set.view(oBlock5, vw.CapeRouteArt);    set.loop(oBlock5, 0);    set.cel(oBlock5, 0);    position(oBlock5, 38, 83);    set.priority(oBlock5, 5);    draw(oBlock5);    stop.cycling(oBlock5);    [ block 6    animate.obj(oBlock6);    set.view(oBlock6, vw.CapeRouteArt);    set.loop(oBlock6, 0);    set.cel(oBlock6, 0);    position(oBlock6, 38, 69);    set.priority(oBlock6, 5);    draw(oBlock6);    stop.cycling(oBlock6);    [ block 7    animate.obj(oBlock7);    set.view(oBlock7, vw.CapeRouteArt);    set.loop(oBlock7, 0);    set.cel(oBlock7, 0);    position(oBlock7, 38, 55);    set.priority(oBlock7, 5);    draw(oBlock7);    stop.cycling(oBlock7);    [ block 8    animate.obj(oBlock8);    set.view(oBlock8, vw.CapeRouteArt);    set.loop(oBlock8, 0);    set.cel(oBlock8, 0);    position(oBlock8, 45, 41);    set.priority(oBlock8, 5);    draw(oBlock8);    stop.cycling(oBlock8);    [ block 9    animate.obj(oBlock9);    set.view(oBlock9, vw.CapeRouteArt);    set.loop(oBlock9, 0);    set.cel(oBlock9, 0);    ignore.horizon(oBlock9);    position(oBlock9, 42, 27);    set.priority(oBlock9, 7);    draw(oBlock9);    stop.cycling(oBlock9);    [ block 10    animate.obj(oBlock10);    set.view(oBlock10, vw.CapeRouteArt);    set.loop(oBlock10, 0);    set.cel(oBlock10, 0);    ignore.horizon(oBlock10);    position(oBlock10, 42, 13);    set.priority(oBlock10, 7);    draw(oBlock10);    stop.cycling(oBlock10);    [ flashing marker - the marker is of a special size and    [ shape that uses the priority value of the route on the    [ picture to show the marker as a single flashing pixel    [ that moves along the trip path line    animate.obj(oMarker);    set.view(oMarker, vw.CapeRouteArt);    set.loop(oMarker, 5);    fix.loop(oMarker);    position(oMarker, 39, 154);    set.priority(oMarker, 6);    ignore.horizon(oMarker);    ignore.objs(oMarker);    draw(oMarker);    vTmpVar = 2;    step.time(oMarker, vTmpVar);    move.obj(oMarker, 39, 39, 1, fMarkerMoved);    vMovePoint = 1;    }      [ now show the picture  show.pic();  }  [ **************************************[ EVERY CYCLE[ **************************************[ if marker is moving south toward the Capeif (CurrentTripTime == TripPoint_8)  {  [ as marker reaches each destination point, move to the  [ next point  if (isset(fMarkerMoved) && vMovePoint == 1)    {    reset(fMarkerMoved);    vMovePoint = 2;    move.obj(oMarker, 110, 40, 1, fMarkerMoved);    }  if (isset(fMarkerMoved) && vMovePoint == 2)    {    reset(fMarkerMoved);    vMovePoint = 3;    move.obj(oMarker, 100, 54, 1, fMarkerMoved);    }  if (isset(fMarkerMoved) && vMovePoint == 3)    {    reset(fMarkerMoved);    vMovePoint = 4;    move.obj(oMarker, 90, 68, 1, fMarkerMoved);    }  if (isset(fMarkerMoved) && vMovePoint == 4)    {    reset(fMarkerMoved);    vMovePoint = 5;    move.obj(oMarker, 80, 82, 1, fMarkerMoved);    }  if (isset(fMarkerMoved) && vMovePoint == 5)    {    reset(fMarkerMoved);    vMovePoint = 6;    move.obj(oMarker, 74, 96, 1, fMarkerMoved);    }  if (isset(fMarkerMoved) && vMovePoint == 6)    {    reset(fMarkerMoved);    vMovePoint = 7;    move.obj(oMarker, 65, 140, 1, fMarkerMoved);    }  [ when marker gets to last point  if (isset(fMarkerMoved) && vMovePoint == 7)    {    [ set flag to continue the journey    reset(fMarkerMoved);    vMovePoint = 8;    set(ContinueJourney);    }      [ use marker position to determine when to erase the  [ blocks  get.posn(oMarker, vMarkerX, vMarkerY);    if (vMarkerY == 26)    {    erase(oBlock1);    }  if (vMarkerY == 40)    {    erase(oBlock2);    }  if (vMarkerY == 54)    {    erase(oBlock3);    }  if (vMarkerY == 68)    {    erase(oBlock4);    }  if (vMarkerY == 82)    {    erase(oBlock5);    }  if (vMarkerY == 96)    {    erase(oBlock6);    }  if (vMarkerY == 110)    {    erase(oBlock7);    }  if (vMarkerY == 124)    {    erase(oBlock8);    }  if (vMarkerY == 138)    {    erase(oBlock9);    }      [ at specific points along the journey, show informational  [ messages, unless the player has suppressed them  if (posn(oMarker, 108, 42, 108, 42) && vMsgTimer == 0)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("Rumors are starting to spread about the difficult times you are "            "going to encounter in a few short weeks.");      print("You hear horror stories about getting around Cape Horn.");      }    }  if (posn(oMarker, 74, 91, 74, 91) && vMsgTimer == 1)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("Passing the 45th Parallel, the temperature begins to drop.");      print("Passengers begin spending more time below deck.");      print("When you left Brooklyn, it was the dead of summer.");      print("It seems to have slipped everyone's mind, at least until now, that "            "June is the dead of winter here!");      print("The freezing temperatures are making this painfully clear.");      }    }  if (posn(oMarker, 65, 132, 65, 132) && vMsgTimer == 2)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("Captains vary in age, experience and wisdom.");      print("But all captains, no matter what their background or experience, "            "approach The Cape with great respect.");      print("They all realize they are extremely vulnerable to the elements.");      print("As you approach the southern tip of South America, the captain "            "advises all persons aboard that the sea you are about to encounter "            "attains a degree of violence unknown in any other part of the "            "globe.");      }    }    [ at specific points along the trip, increment the game  [ time by the number of days on the trip  if (posn(oMarker, 119, 21, 119, 21) && vTimeCounter == 0)    {    vTimeCounter = 1;    GameDays  += 3;    }  if (posn(oMarker, 110, 38, 110, 38) && vTimeCounter == 1)    {    vTimeCounter = 2;    GameDays  += 3;    }  if (posn(oMarker, 96, 58, 96, 58) && vTimeCounter == 2)    {    vTimeCounter = 3;    GameDays  += 3;    }  if (posn(oMarker, 79, 83, 79, 83) && vTimeCounter == 3)    {    vTimeCounter = 4;    GameDays  += 3;    }  if (posn(oMarker, 65, 109, 65, 109) && vTimeCounter == 4)    {    vTimeCounter = 5;    GameDays  += 3;    }  if (posn(oMarker, 65, 136, 65, 136) && vTimeCounter == 5)    {    vTimeCounter = 6;    GameDays  += 3;    }  }[ if marker is moving from the Cape up to middle of the mapif (CurrentTripTime == TripPoint_10)  {  [ as the marker reaches each end point,   [ move it to the next point  if (isset(fMarkerMoved) && vMovePoint == 1)    {    reset(fMarkerMoved);    vMovePoint = 2;    move.obj(oMarker, 61, 153, 1, fMarkerMoved);    }      [ when second point is reached  if (isset(fMarkerMoved) && vMovePoint == 2)    {    reset(fMarkerMoved);    vMovePoint = 3;    [ erase block one (normally, erasing the blocks is done    [ based on the marker position, but for some reason, the    [ programmers chose to do it differently here)    erase(oBlock1);    move.obj(oMarker, 53, 152, 1, fMarkerMoved);    }  [ when marker gets to last point  if (isset(fMarkerMoved) && vMovePoint == 3)    {    [ set flag to continue the journey    reset(fMarkerMoved);    vMovePoint = 4;    set(ContinueJourney);    }      [ get marker position  get.posn(oMarker, vMarkerX, vMarkerY);    [ at specific points along the route, show informational  [ messages, unless the player has suppressed them  if (vMarkerY == 145 && vMsgTimer == 0)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("Just before rounding Cape Horn, the captain points out Deceit "            "Rocks, which are colored white from the bird droppings.");      }    }  if (vMarkerX == 64 && vMsgTimer == 1)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("Rounding the Cape from east to west is not an easy task.");      print("If all goes well, it is usual for a sailing ship to allow three to "            "five weeks to get to the west side of the Horn.");      print("Winds in the area of the Cape rarely blow less than 45 miles per "            "hour and almost always from the west.");      print("Gales in this area can easily pick up a schooner and smash it into "            "the rocky shore.");      print("The raging seas are the temperature of melting ice.");      print("You scarcely get six hours of daylight. When it is light, it is of "            "little benefit.");      print("The overcast hugs the seas and visibility is very low.");      print("It is not uncommon for it to snow here in the summertime.");      }    }  if (vMarkerX == 58 && vMsgTimer == 2)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("The captain is continuously looking through his looking glass, "            "keeping track of the ship's progress and position.");      print("He also makes entries in his log religiously.");      print("Nowhere is navigation more difficult than in these waters.");      }    }  if (vMarkerX == 54 && vMsgTimer == 3)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("Some sailing ships would take seventy days to round the Cape.");      print("Some ships would turn back because of the damage the sea had done "            "to them.");      print("Some ships would not make it at all.");      print("Occasionally you see floating wreckage and debris from less "            "fortunate vessels.");      }    }      [ at this one point along the trip, increment the game  [ time by the number of days on the trip  if (posn(oMarker, 55, 152, 55, 152) &&       vTimeCounter == 0)    {    vTimeCounter = 1;    GameDays  += 5;    }  }[ if marker is moving up Pacific Coast to top of screenif (CurrentTripTime == TripPoint_12)  {  [ as the marker reaches each end point, move it to the  [ next point  if (isset(fMarkerMoved) && vMovePoint == 1)    {    reset(fMarkerMoved);    vMovePoint = 2;    [ make an adjustment to the marker position and change    [ its shape to accomodate the shape of the route; this    [ ensures that as the marker moves, only one single    [ pixel along the path will flash    TmpX = 14;    TmpY = -11; [ 245;    set.loop(oMarker, 6);    fix.loop(oMarker);    set.priority(oMarker, 8);    reposition(oMarker, TmpX, TmpY);    move.obj(oMarker, 40, 27, 1, fMarkerMoved);    }  if (isset(fMarkerMoved) && vMovePoint == 2)    {    reset(fMarkerMoved);    vMovePoint = 3;    erase(oBlock9);    move.obj(oMarker, 38, 27, 1, fMarkerMoved);    }  if (isset(fMarkerMoved) && vMovePoint == 3)    {    reset(fMarkerMoved);    vMovePoint = 4;    move.obj(oMarker, 32, 14, 1, fMarkerMoved);    }  [ when marker gets to final end point  if (isset(fMarkerMoved) && vMovePoint == 4)    {    [ set flag to continue the journey    reset(fMarkerMoved);    vMovePoint = 7;    set(ContinueJourney);    }      [ use marker position to determine when to erase the  [ blocks  get.posn(oMarker, vMarkerX, vMarkerY);  if (vMarkerY == 139)    {    erase(oBlock1);    }  if (vMarkerY == 125)    {    erase(oBlock2);    }  if (vMarkerY == 111)    {    erase(oBlock3);    }  if (vMarkerY == 97)    {    erase(oBlock4);    }  if (vMarkerY == 83)    {    erase(oBlock5);    }  if (vMarkerY == 69)    {    erase(oBlock6);    }  if (vMarkerY == 55)    {    erase(oBlock7);    }  if (vMarkerY == 41)    {    erase(oBlock8);    }      [ at specific points along the route, show informational  [ messages, unless the player has suppressed them  if (vMarkerY == 148 && vMsgTimer == 0)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("With the rounding of Cape Horn (also called Cape Stiff by many "            "sailors because of the difficulty of rounding it) behind you, the "            "captain steers the steamer north by northwest. It is everyone's "            "goal to reach the port of Valparaiso, which means \"Paradise "            "Valley\".");      }    }  if (vMarkerY == 101 && vMsgTimer == 1)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("As the temperature rises so do your spirits.");      }    }  if (vMarkerY == 72 && vMsgTimer == 2)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("Off the coast of Chile, the ocean is swarming with sea cows.");      print("A little farther off the coast of Chile, about 400 miles to be "            "exact, is Juan Fernandez, the island most often recognized as the "            "island on which Robinson Crusoe was actually exiled in 1704.");      }    }  if (vMarkerY == 39 && vMsgTimer == 3)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("Every person on board has been looking forward to arriving at "            "Valparaiso.");      print("They have been in close quarters for too long!!");      print("The port at Valparaiso is shallow, so the boat is anchored "            "offshore.");      print("People go ashore and supplies are brought aboard by a continuous "            "stream of small boats going back and forth from the shore to the "            "ship.");      print("While ashore people would nearly kill for a current newspaper to "            "read.");      print("But the word is confirmed ...");      print("GOLD HAS BEEN DISCOVERED\n     IN CALIFORNIA!!!");      print("We waste no time in loading the ship with only that which is "            "absolutely necessary and head for California.");      }    }      [ at specific points along the trip, increment the game  [ time by the number of days on the trip  if (posn(oMarker, 39, 132, 39, 132) && vTimeCounter == 0)    {    vTimeCounter = 1;    GameDays  += 3;    }  if (posn(oMarker, 39, 96, 39, 96) && vTimeCounter == 1)    {    vTimeCounter = 2;    GameDays  += 3;    }  if (posn(oMarker, 39, 69, 39, 69) && vTimeCounter == 2)    {    vTimeCounter = 3;    GameDays  += 3;    }  if (posn(oMarker, 39, 42, 39, 42) && vTimeCounter == 3)    {    vTimeCounter = 4;    GameDays  += 3;    }  if (posn(oMarker, 53, 28, 53, 28) && vTimeCounter == 4)    {    vTimeCounter = 5;    GameWeeks  += 1;    GameDays  += 2;    }  }[ there is no input processed in this logic, so this[ boilerplate piece of code could have been removedif (!isset(haveInput))  {  goto(Done);  }  Done:[ call the main timing logic; it will handle switching [ between the different segments of the tripcall(lgc.CapeTripTiming);return();[ **************************************[ MESSAGES[ **************************************#message 1 "Rumors are starting to spread about the difficult times you are going to encounter in a few short weeks."#message 2 "You hear horror stories about getting around Cape Horn."#message 10 "Passing the 45th Parallel, the temperature begins to drop."#message 11 "Passengers begin spending more time below deck."#message 12 "When you left Brooklyn, it was the dead of summer."#message 13 "It seems to have slipped everyone's mind, at least until now, that June is the dead of winter here!"#message 14 "The freezing temperatures are making this painfully clear."#message 20 "Captains vary in age, experience and wisdom."#message 21 "But all captains, no matter what their background or experience, approach The Cape with great respect."#message 22 "They all realize they are extremely vulnerable to the elements."#message 23 "As you approach the southern tip of South America, the captain advises all persons aboard that the sea you are about to encounter attains a degree of violence unknown in any other part of the globe."#message 120 "Just before rounding Cape Horn, the captain points out Deceit Rocks, which are colored white from the bird droppings."#message 130 "Rounding the Cape from east to west is not an easy task."#message 131 "If all goes well, it is usual for a sailing ship to allow three to five weeks to get to the west side of the Horn."#message 132 "Winds in the area of the Cape rarely blow less than 45 miles per hour and almost always from the west."#message 133 "Gales in this area can easily pick up a schooner and smash it into the rocky shore."#message 134 "The raging seas are the temperature of melting ice."#message 135 "You scarcely get six hours of daylight. When it is light, it is of little benefit."#message 136 "The overcast hugs the seas and visibility is very low."#message 137 "It is not uncommon for it to snow here in the summertime."#message 140 "The captain is continuously looking through his looking glass, keeping track of the ship's progress and position."#message 141 "He also makes entries in his log religiously."#message 142 "Nowhere is navigation more difficult than in these waters."#message 146 "Some sailing ships would take seventy days to round the Cape."#message 147 "Some ships would turn back because of the damage the sea had done to them."#message 148 "Some ships would not make it at all."#message 149 "Occasionally you see floating wreckage and debris from less fortunate vessels."#message 160 "With the rounding of Cape Horn (also called Cape Stiff by many sailors because of the difficulty of rounding it) behind you, the captain steers the steamer north by northwest. It is everyone's goal to reach the port of Valparaiso, which means \"Paradise Valley\"."#message 170 "Off the coast of Chile, the ocean is swarming with sea cows."#message 175 "A little farther off the coast of Chile, about 400 miles to be exact, is Juan Fernandez, the island most often recognized as the island on which Robinson Crusoe was actually exiled in 1704."#message 180 "As the temperature rises so do your spirits."#message 200 "Every person on board has been looking forward to arriving at Valparaiso."#message 201 "They have been in close quarters for too long!!"#message 210 "The port at Valparaiso is shallow, so the boat is anchored offshore."#message 211 "People go ashore and supplies are brought aboard by a continuous stream of small boats going back and forth from the shore to the ship."#message 220 "While ashore people would nearly kill for a current newspaper to read."#message 221 "But the word is confirmed ..."#message 222 "GOLD HAS BEEN DISCOVERED\n     IN CALIFORNIA!!!"#message 230 "We waste no time in loading the ship with only that which is absolutely necessary and head for California."
[***********************************************************[[ rm.Introduction[[ after getting introduced to Jerrod and having the screen[ change into the main introduction screen, this room[ continues the animation of the four quadrants, one after[ the other[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oHead                        o1#define oJerrod                      o2#define oArrow                       o3#define oFire                        o4#define oOcean1                      o5#define oOcean2                      o6[ o7 not used#define oSwing1                      o8#define oSwing2                      o9#define oSwing3                     o10#define oFirepit                    o11[ v220 is not used#define vNWDone                    v221#define vNEDone                    v222#define vSEDone                    v223#define vSWDone                    v224#define vMainPhase                 v225#define vMainTimer                 v226#define vArrowPhase                v227#define vArrowTimer                v228#define tmpCT                      v229#define tmpVar                     v230#define fMoveDone                  f220#define fArrowHit                  f221#define fMusicDone                 f222[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  vNWDone = pic.NWSceneDone;  vNEDone = pic.NESceneDone;  vSEDone = pic.SESceneDone;  vSWDone = pic.SWSceneDone;    [ load the main intro screen  load.pic(currentRoom);  draw.pic(currentRoom);  discard.pic(currentRoom);    [ load the overlay pics to use after a cutscene is done  load.pic(vNWDone);  load.pic(vNEDone);  load.pic(vSEDone);  load.pic(vSWDone);    [ load all the views used in the cutscenes  load.view(vw.JerrodHeadIntro);  load.view(vw.IntroScene2);  load.view(vw.IntroScene3);  load.view(vw.IntroScene4);  load.view(vw.DizzyJerrod);  load.sound(m.Intro);  load.view(vw.IntroScene1);    [ start the introduction music  sound(m.Intro, fMusicDone);    [ add fire pit to scene 1  add.to.pic(vw.IntroScene1, 9, 0, 35, 81, 4, 4);    [ Jerrod's head; he will follow the action in the various  [ scenes as they play out  animate.obj(oHead);  set.view(oHead, vw.JerrodHeadIntro);  set.loop(oHead, 0);  set.cel(oHead, 0);  stop.cycling(oHead);  set.priority(oHead, 15);  position(oHead, 71, 103);  draw(oHead);    [ arrow that comes into scene 1  animate.obj(oArrow);  set.view(oArrow, vw.IntroScene1);  set.loop(oArrow, 0);  fix.loop(oArrow);  set.priority(oArrow, 15);  ignore.horizon(oArrow);  position(oArrow, 10, 12);    [ fire that will burn the wagon  animate.obj(oFire);  set.view(oFire, vw.IntroScene1);  set.loop(oFire, 1);  fix.loop(oFire);  set.priority(oFire, 8);  position(oFire, 43, 40);    [ fire pit used in scene 1  animate.obj(oFirepit);  set.view(oFirepit, vw.IntroScene1);  set.loop(oFirepit, 9);  fix.loop(oFirepit);  set.cel(oFirepit, 1);  position(oFirepit, 35, 81);  stop.cycling(oFirepit);    [ Jerrod appears in all cutscenes  [ with varying views and loops  animate.obj(oJerrod);  set.view(oJerrod, vw.IntroScene1);  set.loop(oJerrod, 4);  fix.loop(oJerrod);  ignore.horizon(oJerrod);  position(oJerrod, 11, 70);    [ add Jerrod to the scene and show the picture  draw(oJerrod);  show.pic();    [ no input during introduction  prevent.input();  lastChar = 0;  reset(haveMatch);  }[ **************************************[ EVERY CYCLE:[ **************************************[ first phase in the sequence; Jerrod with bundle of wood[ moves to fire pitif (vMainPhase == 0)  {  vMainPhase = 1;  move.obj(oJerrod, 37, 70, 1, fMoveDone);  }[ second leg of Jerrod's move to the fire pitif (isset(fMoveDone) && vMainPhase == 1)  {  reset(fMoveDone);  vMainPhase = 2;  move.obj(oJerrod, 42, 75, 1, fMoveDone);  }  [ after getting to the pitif (isset(fMoveDone) && vMainPhase == 2)  {  [ Jerrod puts the logs down  reset(fMoveDone);  vMainPhase = 3;  set.loop(oJerrod, 5);  set.cel(oJerrod, 0);  end.of.loop(oJerrod, fMoveDone);  }[ after putting down the logsif (isset(fMoveDone) && vMainPhase == 3)  {  [ Jerrod tries to start a fire  reset(fMoveDone);  vMainPhase = 4;  set.loop(oJerrod, 6);  start.cycling(oJerrod);  draw(oFirepit);  }[ while trying to light a fireif (vMainPhase == 4)  {  [ increment timer  ++vMainTimer;  if (vMainTimer == 20)    {    [ reset timer    vMainTimer = 0;    [ Jerrod gives up trying to start a fire and stands up    vMainPhase = 5;    set.loop(oJerrod, 7);    set.cel(oJerrod, 0);    end.of.loop(oJerrod, fMoveDone);    }  }[ after Jerrod finishes standing upif (isset(fMoveDone) && vMainPhase == 5)  {  reset(fMoveDone);  [ move to next phase  vMainPhase = 6;  }[ after Jerrod stands up, if (vMainPhase == 6)  {  [ increment timer  ++vMainTimer;  [ after five cycles  if (vMainTimer == 5)    {    [ reset timer    vMainTimer = 0;    [ Jerrod bends down over the fire again    vMainPhase = 7;    reverse.loop(oJerrod, fMoveDone);    }  }[ after bending down a second timeif (isset(fMoveDone) && vMainPhase == 7)  {  reset(fMoveDone);  [ Jerrod tries again to start a fire  vMainPhase = 8;  set.loop(oJerrod, 6);  start.cycling(oJerrod);  }[ while trying a second time to start a fireif (vMainPhase == 8)  {  [ increment timer  ++vMainTimer;  [ after seven cycles  if (vMainTimer == 7)    {    [ add the flaming arrow    draw(oArrow);    [ it is headed for the wagon    move.obj(oArrow, 48, 50, 4, fArrowHit);    vArrowPhase = 1;    }      [ after 37 cycles  if (vMainTimer == 37)    {    [ reset the timer    vMainTimer = 0;    [ Jerrod stands up again    vMainPhase = 9;    set.loop(oJerrod, 7);    set.cel(oJerrod, 0);    end.of.loop(oJerrod, fMoveDone);    }  }[ after standing up for a second timeif (isset(fMoveDone) && vMainPhase == 9)  {  [ Jerrod crouches down a third time  reset(fMoveDone);  vMainPhase = 10;  reverse.loop(oJerrod, fMoveDone);  }[ after crouching down for third timeif (isset(fMoveDone) && vMainPhase == 10)  {[ Jerrod tries one more time to start a fire  reset(fMoveDone);  vMainPhase = 11;  set.loop(oJerrod, 6);  start.cycling(oJerrod);  }  [ while trying to start third fileif (vMainPhase == 11)  {  [ increment timer  ++vMainTimer;  [ after 30 cycles  if (vMainTimer == 30)    {    [ Jerrod gives up and throws a tantrum    vMainTimer = 0;    vMainPhase = 12;    set.loop(oJerrod, 8);    set.cel(oJerrod, 0);    end.of.loop(oJerrod, fMoveDone);    end.of.loop(oFirepit, DoneNoAction);    }  }  [ after throwing a tantrumif (isset(fMoveDone) && vMainPhase == 12)  {  [ Jerrod is ready to move to second scene  reset(fMoveDone);  vMainPhase = 13;  set.view(oJerrod, vw.IntroScene2);  set.loop(oJerrod, 5);  move.obj(oJerrod, 80, 75, 1, fMoveDone);  start.cycling(oJerrod);  }  [ when Jerrod starts second scene,if (isset(fMoveDone) && vMainPhase == 13)  {  [ advance to next stage  reset(fMoveDone);  vMainPhase = 14;    [ clear all objects  unanimate.all();  [overlay the first (NW) scene; it's done  overlay.pic(vNWDone);  [ view for that scene no longer needed  discard.view(vw.IntroScene1);    [ re-add Jerrod's head  animate.obj(oHead);  set.cel(oHead, 1);  set.priority(oHead, 15);  stop.cycling(oHead);  draw(oHead);  [ re-add Jerrod  animate.obj(oJerrod);  set.view(oJerrod, vw.IntroScene2);  set.loop(oJerrod, 5);  fix.loop(oJerrod);  set.priority(oJerrod, 8);  position(oJerrod, 80, 52);  draw(oJerrod);  [ Jerrod begins moving to bow of ship  move.obj(oJerrod, 104, 52, 1, fMoveDone);    [ add ocean objects; they move sea level to give sense  [ that ship is moving  animate.obj(oOcean1);  set.view(oOcean1, vw.IntroScene2);  set.loop(oOcean1, 0);  fix.loop(oOcean1);  set.cel(oOcean1, 0);  ignore.objs(oOcean1);  position(oOcean1, 127, 66);  draw(oOcean1);  tmpCT = 3;  cycle.time(oOcean1, tmpCT);  animate.obj(oOcean2);  set.view(oOcean2, vw.IntroScene2);  set.loop(oOcean2, 1);  fix.loop(oOcean2);  set.cel(oOcean2, 0);  ignore.objs(oOcean2);  position(oOcean2, 86, 63);  set.priority(oOcean2, 15);  draw(oOcean2);  cycle.time(oOcean2, tmpCT);    [ show the updated pic  show.pic();  }  [ if flaming arrow is moving toward the wagonif (vArrowPhase == 1)  {  [ update priority so it stays visible   if (posn(oArrow, 33, 35, 39, 41))    {    set.priority(oArrow, 6);    vArrowPhase = 2;    }  }[ when arrow hits wagonif (isset(fArrowHit) && vArrowPhase == 2)  {  [ remove it  reset(fArrowHit);  vArrowPhase = 3;  erase(oArrow);  }  [ after arrow has been removedif (vArrowPhase == 3)  {  [ increment timer  ++vArrowTimer;  [ after 9 cycles  if (vArrowTimer == 9)    {    [ wagon catches fire    vArrowTimer = 0;    vArrowPhase = 4;    draw(oFire);    }  }  [ after catching fireif (vArrowPhase == 4)  {  [ increment timer  ++vArrowTimer;  [ after 20 cycles  if (vArrowTimer == 20)    {    [ fire grows in size    set.loop(oFire, 2);    }  [ after 40 cycles  if (vArrowTimer == 40)    {    [ fire gets even bigger    set.loop(oFire, 3);    [ arrow sequence is over    vArrowPhase = 5;    }  }  [ when Jerrod gets halfway to bow of ship, if (isset(fMoveDone) && vMainPhase == 14)  {  reset(fMoveDone);  [ he stops  vMainPhase = 15;  stop.cycling(oJerrod);  }  [ while stopped on his way to the bowif (vMainPhase == 15)  {  [ increment timer  ++vMainTimer;  [ after 5 cycles  if (vMainTimer == 5)    {    [ Jerrod turns to face front     set.loop(oJerrod, 6);    }      [ after 15 cycles  if (vMainTimer == 15)    {    [ reset timer    vMainTimer = 0;    [ Jerrod continues moving to bow    vMainPhase = 16;    set.loop(oJerrod, 5);    move.obj(oJerrod, 106, 52, 1, fMoveDone);    start.cycling(oJerrod);    }  }[ after Jerrod gets to next point on way to bowif (isset(fMoveDone) && vMainPhase == 16)  {  [ last segment of movement to the bow   reset(fMoveDone);  vMainPhase = 17;  move.obj(oJerrod, 118, 40, 1, fMoveDone);  }  [ after Jerrod finally gets to the bowif (isset(fMoveDone) && vMainPhase == 17)  {  [ he stops  reset(fMoveDone);  vMainPhase = 18;  stop.cycling(oJerrod);  }[ after stopping at the bow if (vMainPhase == 18)  {  [ increment timer  ++vMainTimer;  [ after five cycles  if (vMainTimer == 5)    {    [ Jerrod gets out his spyglass     vMainTimer = 0;    vMainPhase = 19;    set.loop(oJerrod, 2);    set.cel(oJerrod, 0);    end.of.loop(oJerrod, fMoveDone);    }  }  [ while raising spyglassif (vMainPhase == 19)  {  [ check current cel  current.cel(oJerrod, tmpVar);  [ when Jerrod gets to cel 5  if (tmpVar == 5)    {    [ stop cycling    set.cel(oJerrod, 5);    stop.cycling(oJerrod);    [ Jerrod scans horizon    vMainPhase = 20;    }  }  [ while scanning horizonif (vMainPhase == 20)  {  [ increment timer  ++vMainTimer;  [ after 10 cycles  if (vMainTimer == 10)    {    [ Jerrod puts telescope away    vMainTimer = 0;    vMainPhase = 21;    reverse.loop(oJerrod, fMoveDone);    }  }  [ after putting telescope awayif (isset(fMoveDone) && vMainPhase == 21)  {  [ advance to next stage  reset(fMoveDone);  vMainPhase = 22;  }  [ while standing at bow after putting scope awayif (vMainPhase == 22)  {  [ increment timer  ++vMainTimer;  [ after five cycles  if (vMainTimer == 5)    {    [ Jerrod gets out his telescope again    vMainTimer = 0;    vMainPhase = 23;    end.of.loop(oJerrod, fMoveDone);    }  }  [ while getting telescope a second timeif (vMainPhase == 23)  {  [ check current cel  current.cel(oJerrod, tmpVar);  [ when Jerrod gets to cel 5  if (tmpVar == 5)    {    [ slow down cycling, as Jerrod continues to lean forward    tmpVar = 10;    cycle.time(oJerrod, tmpVar);    vMainPhase = 24;    }  }  [ when Jerrod leans all the way over the bowif (isset(fMoveDone) && vMainPhase == 24)  {  [ he begins to lose his balance  reset(fMoveDone);  set.loop(oJerrod, 3);  [ this is a minor bug- phase is set to 1; but it doesn't  [ cause a problem because it's correctly set to 25 a few  [ lines later  vMainPhase = 1;  cycle.time(oJerrod, vMainPhase);  start.cycling(oJerrod);  vMainPhase = 25;  }  [ while Jerrod is losing his balanceif (vMainPhase == 25)  {  [ increment timer  ++vMainTimer;  [ after 15 cycles  if (vMainTimer == 15)    {    [ Jerrod falls overboard    vMainTimer = 0;    vMainPhase = 26;    set.priority(oJerrod, 11);    TmpX = 8;    TmpY = -3; [ 253;    reposition(oJerrod, TmpX, TmpY);    set.loop(oJerrod, 4);    set.cel(oJerrod, 0);    tmpCT = 3;    cycle.time(oJerrod, tmpCT);    move.obj(oJerrod, 131, 37, 4, fMoveDone);    }  }[ after reaching first point of fall if (isset(fMoveDone) && vMainPhase == 26)  {  [ Jerrod falls down rest of the way  reset(fMoveDone);  vMainPhase = 27;  move.obj(oJerrod, 138, 95, 4, fMoveDone);  }  [ when Jerrod is done fallingif (isset(fMoveDone) && vMainPhase == 27)  {  [ start third scene in jungle  reset(fMoveDone);  vMainPhase = 28;    [ remove all objects (erasing isn't actually needed since  [ objects get unanimated, and room is redrawn)  erase(oJerrod);   unanimate.all();  [ add overlay showing scene 2 is done  overlay.pic(vNEDone);    [ re-add Jerrod's head  animate.obj(oHead);  set.cel(oHead, 2);  set.priority(oHead, 15);  stop.cycling(oHead);  draw(oHead);    [ add Jerrod, with view of him swinging (it takes three  [ different objects, all moving at same time to create the  [ awinging animation - I'm not sure why they didn't just   [ use a single object)   animate.obj(oSwing1);  set.view(oSwing1, vw.IntroScene3);  set.loop(oSwing1, 1);  fix.loop(oSwing1);  set.cel(oSwing1, 0);  set.priority(oSwing1, 12);  position(oSwing1, 128, 139);  draw(oSwing1);  tmpCT = 2;  cycle.time(oSwing1, tmpCT);  end.of.loop(oSwing1, fMoveDone);  [ mid part of swing   animate.obj(oSwing2);  set.view(oSwing2, vw.IntroScene3);  set.loop(oSwing2, 2);  fix.loop(oSwing2);  set.cel(oSwing2, 0);  set.priority(oSwing2, 12);  position(oSwing2, 108, 153);  draw(oSwing2);  cycle.time(oSwing2, tmpCT);  end.of.loop(oSwing2, fMoveDone);  [ end part of swing  animate.obj(oSwing3);  set.view(oSwing3, vw.IntroScene3);  set.loop(oSwing3, 3);  fix.loop(oSwing3);  set.cel(oSwing3, 0);  set.priority(oSwing3, 12);  position(oSwing3, 81, 160);  draw(oSwing3);  cycle.time(oSwing3, tmpCT);  [ all three loops have same number of cels, so using the  [ same end flag for all of them is OK  end.of.loop(oSwing3, fMoveDone);    [ show the updated picture  show.pic();  }  [ after Jerrod finishes his swingingif (isset(fMoveDone) && vMainPhase == 28)  {  [ move to scene 4  reset(fMoveDone);  vMainPhase = 29;    [ erase all objects  unanimate.all();    [ add the overlay to show scene 3 is done  overlay.pic(vSEDone);    [ re-add Jerrod's head  animate.obj(oHead);  set.cel(oHead, 3);  set.priority(oHead, 15);  stop.cycling(oHead);  draw(oHead);    [ re-add Jerrod so he can stumble about and hit lamppost  animate.obj(oJerrod);  set.view(oJerrod, vw.IntroScene4);  set.loop(oJerrod, 0);  set.cel(oJerrod, 0);  fix.loop(oJerrod);  position(oJerrod, 75, 154);  release.priority(oJerrod);  draw(oJerrod);  [ position Jerrod and have him move to the lamppost  tmpCT = 1;  cycle.time(oJerrod, tmpCT);  move.obj(oJerrod, 39, 154, 2, fMoveDone);    [ show the updated picture  show.pic();  }  [ after Jerrod reaches lamppostif (isset(fMoveDone) && vMainPhase == 29)  {  [ he bounces off the post  reset(fMoveDone);  TmpX = 3;  TmpY = 0;  reposition(oJerrod, TmpX, TmpY);  set.loop(oJerrod, 1);  set.loop(oHead, 1);  end.of.loop(oJerrod, fMoveDone);  vMainPhase = 30;  }  [ after Jerrod bounces off the postif (isset(fMoveDone) && vMainPhase == 30)  {  [ he stumbles to a starting point  reset(fMoveDone);  vMainPhase = 31;  TmpX = -5; [ 251;  TmpY = 0;  reposition(oJerrod, TmpX, TmpY);  set.view(oJerrod, vw.DizzyJerrod);  release.loop(oJerrod);  start.cycling(oJerrod);  move.obj(oJerrod, 52, 154, 1, fMoveDone);  }  [ when Jerrod reaches the starting pointif (isset(fMoveDone) && vMainPhase == 31)  {  [ he stumbles (wanders) about for awhile  reset(fMoveDone);  vMainPhase = 32;  [ use a block to keep Jerrod confined to area by the post  block(37, 142, 66, 166);  wander(oJerrod);  set.loop(oHead, 0);  set.cel(oHead, 3);  }  [ while Jerrod is stumbling aroundif (vMainPhase == 32)  {  [ increment timer  ++vMainTimer;  [ after 30 cycles  if (vMainTimer == 30)    {    [ move Jerrod out of the scene (by moving to the right    [ past edge with the jungle scene)    vMainTimer = 0;    vMainPhase = 33;    [ remove the block    unblock();    [ set priority so Jerrod will disappear behind the    [ jungle scene    set.priority(oJerrod, 12);    move.obj(oJerrod, 80, 164, 1, fMoveDone);    }  }  [ when Jerrod gets to end pointif (isset(fMoveDone) && vMainPhase == 33)  {  [ introduction is done     [ (all these lines aren't really necessary since there is  [ a new.room command immediately after them)    reset(fMoveDone);  vMainPhase = 34;  [ stop all objects  unanimate.all();  [ add overlay showing scene 4 is done  overlay.pic(vSWDone);  [reanimate head and set to correct cel  animate.obj(oHead);  set.cel(oHead, 3);  set.priority(oHead, 15);  stop.cycling(oHead);  draw(oHead);  show.pic();    [ now switch to rm.Credits  new.room(rm.Credits); [ ##LE001##  }  [ at any time, player can skip the intro[ by pressing any keyif (have.key())  {  new.room(rm.MainSt); [ ##LE002##  }  return();[ **************************************[ MESSAGES[ **************************************
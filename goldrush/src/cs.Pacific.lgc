[***********************************************************[[ cs.Pacific[[ This logic manages the cutscenes and rooms that make up[ the Cape Horn route from western South America to[ California.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oBlock1                      o1#define oBlock2                      o2#define oBlock3                      o3#define oBlock4                      o4#define oBlock5                      o5#define oBlock6                      o6#define oBlock7                      o7#define oBlock8                      o8[ o9 through o19 are not used#define oMarker                     o20[ v220 through v232 are not used#define vTimeCounter               v233#define vMsgTimer                  v234[ v235 through v237 are not used#define vMarkerX                   v238#define vMarkerY                   v239#define vMovePoint                 v240#define vTmpVar                    v241#define fMarkerMoved               f220[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load the timing logic  load.logics(lgc.CapeTripTiming);    [ load picture for current room  load.pic(currentRoom);    [ load view with blocking markers cursors  load.view(vw.CapeRouteArt);    [ draw the picture  draw.pic(currentRoom);    [ if marker is moving up Pacific Coast toward middle of  [ scene  if (CurrentTripTime == TripPoint_14)    {    [ permanently cover up portions of the route that aren't    [ uncovered in this sequence    add.to.pic(vw.CapeRouteArt, 0, 0, 34, 124, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 26, 110, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 19, 96, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 15, 82, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 10, 68, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 7, 54, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 5, 40, 5, 5);    add.to.pic(vw.CapeRouteArt, 0, 0, 5, 26, 5, 5);    [ use blocks to cover up the marker route; they will be    [ removed as the marker moves to show the traced route    animate.obj(oBlock1);    set.view(oBlock1, vw.CapeRouteArt);    set.loop(oBlock1, 0);    set.cel(oBlock1, 0);    position(oBlock1, 53, 152);    set.priority(oBlock1, 5);    ignore.horizon(oBlock1);    draw(oBlock1);    stop.cycling(oBlock1);    [ block 2    animate.obj(oBlock2);    set.view(oBlock2, vw.CapeRouteArt);    set.loop(oBlock2, 0);    set.cel(oBlock2, 0);    position(oBlock2, 43, 138);    set.priority(oBlock2, 5);    draw(oBlock2);    stop.cycling(oBlock2);    [ flashing marker - the marker is of a special size and    [ shape that uses the priority value of the route on the    [ picture to show the marker as a single flashing pixel    [ that moves along the trip path line    animate.obj(oMarker);    set.view(oMarker, vw.CapeRouteArt);    set.loop(oMarker, 3);    fix.loop(oMarker);    position(oMarker, 64, 167);    set.priority(oMarker, 8);    ignore.horizon(oMarker);    ignore.objs(oMarker);    draw(oMarker);    vTmpVar = 2;    step.time(oMarker, vTmpVar);    move.obj(oMarker, 53, 152, 1, fMarkerMoved);    vMovePoint = 1;    }      [ if marker is moving into California  if (CurrentTripTime == TripPoint_16)    {    [ use blocks to cover up the marker route; they will be    [ removed as the marker moves to show the    [ traced route    animate.obj(oBlock1);    set.view(oBlock1, vw.CapeRouteArt);    set.loop(oBlock1, 0);    set.cel(oBlock1, 0);    position(oBlock1, 34, 124);    set.priority(oBlock1, 5);    ignore.horizon(oBlock1);    draw(oBlock1);    stop.cycling(oBlock1);    [ block 2    animate.obj(oBlock2);    set.view(oBlock2, vw.CapeRouteArt);    set.loop(oBlock2, 0);    set.cel(oBlock2, 0);    position(oBlock2, 26, 110);    set.priority(oBlock2, 5);    draw(oBlock2);    stop.cycling(oBlock2);    [ block 3    animate.obj(oBlock3);    set.view(oBlock3, vw.CapeRouteArt);    set.loop(oBlock3, 0);    set.cel(oBlock3, 0);    position(oBlock3, 19, 96);    set.priority(oBlock3, 5);    draw(oBlock3);    stop.cycling(oBlock3);    [block 4    animate.obj(oBlock4);    set.view(oBlock4, vw.CapeRouteArt);    set.loop(oBlock4, 0);    set.cel(oBlock4, 0);    position(oBlock4, 15, 82);    set.priority(oBlock4, 5);    draw(oBlock4);    stop.cycling(oBlock4);    [ block 5    animate.obj(oBlock5);    set.view(oBlock5, vw.CapeRouteArt);    set.loop(oBlock5, 0);    set.cel(oBlock5, 0);    position(oBlock5, 10, 68);    set.priority(oBlock5, 5);    draw(oBlock5);    stop.cycling(oBlock5);    [ block 6    animate.obj(oBlock6);    set.view(oBlock6, vw.CapeRouteArt);    set.loop(oBlock6, 0);    set.cel(oBlock6, 0);    position(oBlock6, 7, 54);    set.priority(oBlock6, 5);    draw(oBlock6);    stop.cycling(oBlock6);    [ block 7    animate.obj(oBlock7);    set.view(oBlock7, vw.CapeRouteArt);    set.loop(oBlock7, 0);    set.cel(oBlock7, 0);    position(oBlock7, 5, 40);    set.priority(oBlock7, 5);    draw(oBlock7);    stop.cycling(oBlock7);    [ block 8    animate.obj(oBlock8);    set.view(oBlock8, vw.CapeRouteArt);    set.loop(oBlock8, 0);    set.cel(oBlock8, 0);    ignore.horizon(oBlock8);    position(oBlock8, 5, 26);    set.priority(oBlock8, 5);    draw(oBlock8);    stop.cycling(oBlock8);        [ flashing marker - the marker is of a special size and    [ shape that uses the priority value of the route on the    [ picture to show the marker as a single flashing pixel    [ that moves along the trip path line    animate.obj(oMarker);    set.view(oMarker, vw.CapeRouteArt);    set.loop(oMarker, 3);    fix.loop(oMarker);    position(oMarker, 42, 136);    set.priority(oMarker, 8);    ignore.horizon(oMarker);    ignore.objs(oMarker);    draw(oMarker);    vTmpVar = 2;    step.time(oMarker, vTmpVar);    move.obj(oMarker, 30, 115, 1, fMarkerMoved);    vMovePoint = 1;    }      [ now show the picture  show.pic();  }  [ **************************************[ EVERY CYCLE[ **************************************[ if marker is moving from bottom up to middle of screenif (CurrentTripTime == TripPoint_14)  {  [ as marker reaches each destination point, move to the  [ next point  if (isset(fMarkerMoved) && vMovePoint == 1)    {    reset(fMarkerMoved);    vMovePoint = 2;    move.obj(oMarker, 42, 136, 1, fMarkerMoved);    }  [ when marker gets to final end point  if (isset(fMarkerMoved) && vMovePoint == 2)    {    [ set flag to continue the journey    reset(fMarkerMoved);    vMovePoint = 3;    set(ContinueJourney);    }      [ use marker position to determine when to erase the  [ blocks  get.posn(oMarker, vMarkerX, vMarkerY);    if (vMarkerY == 152)    {    erase(oBlock1);    }  if (vMarkerY == 138)    {    erase(oBlock2);    }  [ at specific points along the journey, show informational  [ messages, unless the player has suppressed them  if (vMarkerY == 165 && vMsgTimer == 0)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("Most of the passengers who were keeping journals at the beginning "            "of the trip have stopped by now.");      print("But throughout the entire trip people have been reading whatever "            "they can get their hands on.");      print("Many days aboard the ship are spent in utter monotonony.  There is "            "nothing to do, at least nothing you feel like doing, but watch an "            "occasional ship come and go; watch the sun rise out of the water, "            "move across the sky, and then set into the water again.  Day after "            "day after day ... ");      }    }  if (vMarkerY == 150 && vMsgTimer == 1)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("The last leg of the journey is slow and seems to drag on forever.");      print("The walls seem to be moving in.");      print("You are positive the ship is only half the size it was when it "            "left Brooklyn.");      print("Moments of solitude and privacy are nonexistant.");      print("Fellow passengers, who only a month ago were easy to get along "            "with, now seem impossible to tolerate.");      print("Fights break out over trifles.  There is constant bickering and "            "gossip.");      }    }  if (vMarkerY == 138 && vMsgTimer == 2)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("Before, you complained of having the same food to eat meal after "            "meal...");      print("...but now you would gladly eat anything.");      print("Provisions are running dangerously low.");      }    }      [ at specific points along the trip, increment the game  [ time by the number of days on the trip  if (posn(oMarker, 62, 165, 62, 165) && vTimeCounter == 0)    {    vTimeCounter = 1;    GameDays  += 3;    }  if (posn(oMarker, 52, 151, 52, 151) &&       vTimeCounter == 1)    {    vTimeCounter = 2;    GameDays  += 3;    }  if (posn(oMarker, 42, 137, 42, 137) &&       vTimeCounter == 2)    {    vTimeCounter = 3;    GameDays  += 3;    }  }  [ if marker is on final leg, going into Californiaif (CurrentTripTime == TripPoint_16)  {  [ as marker reaches each destination point, move to the  [ next point  if (isset(fMarkerMoved) && vMovePoint == 1)    {    reset(fMarkerMoved);    vMovePoint = 2;    move.obj(oMarker, 17, 82, 1, fMarkerMoved);    }  if (isset(fMarkerMoved) && vMovePoint == 2)    {    reset(fMarkerMoved);    vMovePoint = 3;    move.obj(oMarker, 4, 27, 1, fMarkerMoved);    }  if (isset(fMarkerMoved) && vMovePoint == 3)    {    reset(fMarkerMoved);    vMovePoint = 4;    set(ContinueJourney);    }      [ use marker position to determine when to erase the blocks  get.posn(oMarker, vMarkerX, vMarkerY);    if (vMarkerY == 124)    {    erase(oBlock1);    }  if (vMarkerY == 110)    {    erase(oBlock2);    }  if (vMarkerY == 96)    {    erase(oBlock3);    }  if (vMarkerY == 82)    {    erase(oBlock4);    }  if (vMarkerY == 68)    {    erase(oBlock5);    }  if (vMarkerY == 54)    {    erase(oBlock6);    }  if (vMarkerY == 40)    {    erase(oBlock7);    }  if (vMarkerY == 26)    {    erase(oBlock8);    }  [ at specific points along the journet, show informational  [ messages, unless the player has suppressed them  if (vMarkerY == 127 && vMsgTimer == 0)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("The Captain has given the word that you are only a few weeks from "            "the coast of California.");      print("This seems to calm everyone's nerves.");      print("The arguments and fights subside.");      }    }  if (vMarkerY == 60 && vMsgTimer == 1)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("As the ship nears California, you begin to forget the hardships "            "and tough times you have just endured.");      print("The promises made to The Almighty while rounding the Cape are all "            "but forgotten.");      print("Somehow those times don't seem as tough now.");      print("Much more important now is the topic of nearly every conversation "            "on the ship: where people plan to go to search for gold, how they "            "are going to get it, and what they are going to do with the "            "fortune they discover there.");      print("There is also much fretting and worrying about arriving too late "            "and missing out on the best opportunities.");      print("Hopefully there will still be plenty of gold left when you get "            "there.");      }    }  if (vMarkerY == 45 && vMsgTimer == 2)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("For the crew, no portion of the voyage is without danger.");      print("They must maintain their vigilance to the very end.");      print("You are fortunate that the ship has a sufficient supply of coal to "            "make it to California.  Other steamers ran out of coal.  When that "            "happened spars, doors, bunks, and portions of the deck were ripped "            "up and fed into the fire box to keep that ship moving toward the "            "gold fields!");      }    }  if (vMarkerY == 28 && vMsgTimer == 3)    {    ++vMsgTimer;    if (!isset(HideTripMsgs))      {      print("The ship is now approaching the Golden Gate, and your journey is "            "approaching its end.");      print("The dense fog makes it difficult, not to mention dangerous, to "            "find the entrance to the Golden Gate.");      }    }      [ at specific points along the trip, increment the game  [ time by the number of days on the trip  if (posn(oMarker, 30, 119, 30, 119) && vTimeCounter == 0)    {    vTimeCounter = 1;    GameDays  += 4;    }  if (posn(oMarker, 17, 101, 17, 101) && vTimeCounter == 1)    {    vTimeCounter = 2;    GameDays  += 4;    }  if (posn(oMarker, 17, 82, 17, 82) && vTimeCounter == 2)    {    vTimeCounter = 3;    GameDays  += 4;    }  if (posn(oMarker, 4, 57, 4, 57) && vTimeCounter == 3)    {    vTimeCounter = 4;    GameDays  += 4;    }  if (posn(oMarker, 4, 30, 4, 30) && vTimeCounter == 4)    {    vTimeCounter = 5;    GameDays  += 4;    }  }  [ there is no input processed in this logic, so this[ boilerplate piece of code could have been removedif (!isset(haveInput))  {  goto(Done);  }  Done:[ call the main timing logic; it will handle switching [ between the different segments of the tripcall(lgc.CapeTripTiming);return();[ **************************************[ MESSAGES[ **************************************#message 1 "Most of the passengers who were keeping journals at the beginning of the trip have stopped by now."#message 2 "But throughout the entire trip people have been reading whatever they can get their hands on."#message 3 "Many days aboard the ship are spent in utter monotonony.  There is nothing to do, at least nothing you feel like doing, but watch an occasional ship come and go; watch the sun rise out of the water, move across the sky, and then set into the water again.  Day after day after day ... "#message 10 "The last leg of the journey is slow and seems to drag on forever."#message 11 "The walls seem to be moving in."#message 12 "You are positive the ship is only half the size it was when it left Brooklyn."#message 13 "Moments of solitude and privacy are nonexistant."#message 14 "Fellow passengers, who only a month ago were easy to get along with, now seem impossible to tolerate."#message 15 "Fights break out over trifles.  There is constant bickering and gossip."#message 100 "Before, you complained of having the same food to eat meal after meal..."#message 101 "...but now you would gladly eat anything."#message 102 "Provisions are running dangerously low."#message 110 "You are fortunate that the ship has a sufficient supply of coal to make it to California.  Other steamers ran out of coal.  When that happened spars, doors, bunks, and portions of the deck were ripped up and fed into the fire box to keep that ship moving toward the gold fields!"#message 140 "The Captain has given the word that you are only a few weeks from the coast of California."#message 141 "This seems to calm everyone's nerves."#message 142 "The arguments and fights subside."#message 169 "As the ship nears California, you begin to forget the hardships and tough times you have just endured."#message 170 "The promises made to The Almighty while rounding the Cape are all but forgotten."#message 171 "Somehow those times don't seem as tough now."#message 172 "Much more important now is the topic of nearly every conversation on the ship: where people plan to go to search for gold, how they are going to get it, and what they are going to do with the fortune they discover there."#message 173 "There is also much fretting and worrying about arriving too late and missing out on the best opportunities."#message 174 "Hopefully there will still be plenty of gold left when you get there."#message 180 "For the crew, no portion of the voyage is without danger."#message 181 "They must maintain their vigilance to the very end."#message 230 "The ship is now approaching the Golden Gate, and your journey is approaching its end."#message 231 "The dense fog makes it difficult, not to mention dangerous, to find the entrance to the Golden Gate."
[***********************************************************[[ rm.DockWideView[[ a wider 'eagle-eye' view of the ferry dock that shows the[ ferry coming to Brooklyn from New York, and also the cut[ scene showing the ferry going back to NY with Jerrod on[ board (which ends the NY stage of the game and begins the[ trip across the country)[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oFerryGate                   o1#define oFerry                       o2#define vFerryStatus               v220  #define F_START_NY            0  [ in New York ready to leave  #define F_INBOUND_1           1  [ ferry inbound, moving to point 1  #define F_INBOUND_2           2  [ ferry inbound, moving to point 2  #define F_INBOUND_3           3  [ ferry inbound, moving to point 3  #define F_INBOUND_4           4  [ ferry inbound, moving to point 4  #define F_INBOUND_DOCK        5  [ ferry inbound, moving to dock  #define F_AT_DOCK             6  [ ferry has arrived at dock  #define F_READY_GATE          7  [ ready to open the dock gate  #define F_OPEN_GATE           8  [ opening the dock gate  #define F_WAIT_DOCK           9  [ waiting at dock for stage to board  #define F_START_BROOKLYN     12  [ in Brooklyn, ready to leave for New York  #define F_CLOSE_GATE         13  [ dock gate closing  #define F_READY_LEAVE        14  [ ready to leave Brooklyn  #define F_OUTBOUND_15        15  [ ferry outbound, moving to point 15  #define F_OUTBOUND_16        16  [ ferry outbound, moving to point 16  #define F_OUTBOUND_17        17  [ ferry outbound, moving to point 17  #define F_OUTBOUND_18        18  [ ferry outbound, moving to point 18  #define F_OUTBOUND_NY        19  [ ferry outbound, moving into New York  #define F_PAUSE_NY           20  [ ferry at New York, slight pause  #define F_END_NY             21  [ ferry at New York, sequence is done#define vFerryStep                 v221#define vFerryCycle                v222#define vFerryTimer                v223#define fFerryMoved                f220#define fInNewYork                 f221[ f222 is not used#define fFerrySound                f223[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load the current room picture  load.pic(currentRoom);    [ load views needed in the room  load.view(vw.TinyJerrod);  load.view(vw.SkylineArt);  load.view(vw.DockWideArt);    [ if ferry is at the dock, it means this is the cut scene  [ showing the ferry going back to New York with Jerrod on  [ board on the stagecoach  if (isset(FerryAtDock))    {    [ set flag to show travel time if player displays    [ elapsed time    set(ShowTravelTime);    [ if not already announced, set flag so gold rush is    [ public    set(RushAnnounced);    [ load view of ferry leaving Brooklyn    load.view(vw.FerryLeaving);    }  else    {    [ if ferry is not at dock yet, load the load view    [ showing the ferry arriving at Brooklyn    load.view(vw.FerryArriving);    }      [ load sounds used in the room  load.sound(s.UhOh);  load.sound(m.Travel);    [ draw the room picture  draw.pic(currentRoom);  [ add skyline art  add.to.pic(vw.SkylineArt, 0, 0, 0, 52, 4, 4);  add.to.pic(vw.SkylineArt, 0, 1, 20, 52, 4, 4);  add.to.pic(vw.SkylineArt, 0, 2, 40, 52, 4, 4);  add.to.pic(vw.SkylineArt, 0, 3, 60, 52, 4, 4);  add.to.pic(vw.SkylineArt, 0, 4, 80, 52, 4, 4);  add.to.pic(vw.SkylineArt, 0, 5, 100, 52, 4, 4);  add.to.pic(vw.SkylineArt, 0, 6, 120, 52, 4, 4);  add.to.pic(vw.SkylineArt, 0, 7, 140, 52, 4, 4);  [ add dock specific art  add.to.pic(vw.DockWideArt, 0, 0, 45, 148, 13, 13);  add.to.pic(vw.DockWideArt, 0, 1, 149, 143, 13, 13);  add.to.pic(vw.DockWideArt, 0, 2, 42, 129, 13, 13);  add.to.pic(vw.DockWideArt, 0, 3, 0, 114, 13, 13);  add.to.pic(vw.DockWideArt, 0, 4, 2, 130, 13, 13);    [ if ferry is not at dock  if (!isset(FerryAtDock))    {    [ show the horses, waiting to bring coach on to the ferry    add.to.pic(vw.DockWideArt, 0, 5, 89, 167, 13, 13);    }      [ ferry gate  animate.obj(oFerryGate);  set.view(oFerryGate, vw.DockWideArt);  [ if ferry is at the dock  if (isset(FerryAtDock))    {    [ show the open loop    set.loop(oFerryGate, 2);    set.cel(oFerryGate, 0);    }  else    {    [ show the closed loop    set.loop(oFerryGate, 1);    set.cel(oFerryGate, 0);    }  set.priority(oFerryGate, 13);  position(oFerryGate, 69, 148);  draw(oFerryGate);  stop.update(oFerryGate);    [ the ferry  animate.obj(oFerry);  [ if it's at the dock  if (isset(FerryAtDock))    {    [ use the view showing it leaving    set.view(oFerry, vw.FerryLeaving);    [start with large version    set.loop(oFerry, 0);    [ positioned at the dock    position(oFerry, 68, 152);    [ set status to at the dock, ready to leave for New York    vFerryStatus = F_START_BROOKLYN;    }  else    {    [ use view showing it arriving    set.view(oFerry, vw.FerryArriving);    [ start with small version    set.loop(oFerry, 4);    [ it starts in New York across the river    position(oFerry, 97, 84);    [ set status to in NY, ready to come to Brooklyn    vFerryStatus = F_START_NY;    }  set.priority(oFerry, 9);  ignore.horizon(oFerry);  ignore.blocks(oFerry);  ignore.objs(oFerry);  draw(oFerry);  [ set move and cycle parameters  vFerryStep = 7;  step.time(oFerry, vFerryStep);  vFerryCycle = 3;  cycle.time(oFerry, vFerryCycle);    [ if stagecoach phase is not at end stage  [ (this is never possible; this room only gets called from  [ rm.FerryDock, and only when the stagecoach phase is  [ equal to SC_AT_FERRY)  if (StagecoachPhase != SC_AT_FERRY)    {    [ add Jerrod    animate.obj(ego);    [ using the tiny view    set.view(ego, vw.TinyJerrod);    position(ego, 79, 158);    draw(ego);    }      [ now show the picture  show.pic();  }  [ **************************************[ EVERY CYCLE[ **************************************[ if ferry is in NY, ready to leaveif (vFerryStatus == F_START_NY)  {  [ increment timer  ++vFerryTimer;  [ after two cycles,  if (vFerryTimer == 2)    {    vFerryTimer = 0;    [ ferry begins moving to point 1    vFerryStatus = F_INBOUND_1;    move.obj(oFerry, 83, 98, 1, fFerryMoved);    set.loop(oFerry, 4);    fix.loop(oFerry);    }  }  [ after ferry gets to point 1if (vFerryStatus == F_INBOUND_1 && isset(fFerryMoved))  {  reset(fFerryMoved);  [ ferry moves to point 2  vFerryStatus = F_INBOUND_2;  move.obj(oFerry, 78, 104, 1, fFerryMoved);  [ it's closer, so use a larger loop  release.loop(oFerry);  set.loop(oFerry, 3);  fix.loop(oFerry);  }  [ after ferry gets to point 2if (vFerryStatus == F_INBOUND_2 && isset(fFerryMoved))  {  reset(fFerryMoved);  [ ferry moves to point 3  vFerryStatus = F_INBOUND_3;  move.obj(oFerry, 70, 119, 1, fFerryMoved);  [ it's even closer; next larger loop  release.loop(oFerry);  set.loop(oFerry, 2);  fix.loop(oFerry);  }  [ after ferry gets to point 3if (vFerryStatus == F_INBOUND_3 && isset(fFerryMoved))  {  reset(fFerryMoved);  [ ferry moves to point 4  vFerryStatus = F_INBOUND_4;  move.obj(oFerry, 68, 141, 1, fFerryMoved);  [ closer still; next larger loop  release.loop(oFerry);  set.loop(oFerry, 1);  fix.loop(oFerry);  }  [ after ferry gets to point 4if (vFerryStatus == F_INBOUND_4 && isset(fFerryMoved))  {  reset(fFerryMoved);  [ one more move to get into the dock  vFerryStatus = F_INBOUND_DOCK;  move.obj(oFerry, 68, 153, 1, fFerryMoved);  release.loop(oFerry);  [ close enough to use largest size  set.loop(oFerry, 0);  fix.loop(oFerry);  }  [ after ferry gets to dockif (vFerryStatus == F_INBOUND_DOCK && isset(fFerryMoved))  {  reset(fFerryMoved);  [ set status to show ferry is at the dock  vFerryStatus = F_AT_DOCK;  }  [ while waiting at dock after arrivingif (vFerryStatus == F_AT_DOCK)  {  [ increment timer  ++vFerryTimer;  [ after eight cycles  if (vFerryTimer == 8)    {    vFerryTimer = 0;    [ ready to opening gates    vFerryStatus = F_READY_GATE;    }  }  [ if time to open gatesif (vFerryStatus == F_READY_GATE)  {  [ start cycling gate object  start.update(oFerryGate);  [ cycle gates one time to open them  end.of.loop(oFerryGate, fFerryMoved);  cycle.time(oFerryGate, vFerryCycle);  vFerryStatus = F_OPEN_GATE;  }  [ after gates are openedif (vFerryStatus == F_OPEN_GATE && isset(fFerryMoved))  {  reset(fFerryMoved);  [ ferry is at dock, waiting for stagecoach to board  vFerryStatus = F_WAIT_DOCK;  set(FerryAtDock);  }  [ while waiting after gates openedif (vFerryStatus == F_WAIT_DOCK)  {  [ increment timer  ++vFerryTimer;  [ after two cycles  if (vFerryTimer == 2)    {    [ ego object is never animated/used in this room; these    [ two commands don't do anything and aren't needed    stop.motion(ego);    start.motion(ego);    [ go back to the ferry dock so the stage coach can board    [ it    new.room(rm.FerryDock); [ ##LE001##    }  }[ if the ferry music endsif (isset(fFerrySound))  {  [ play it again  sound(m.Travel, fFerrySound);  }  [ if ferry is at the dock, ready to leave for NYif (vFerryStatus == F_START_BROOKLYN)  {  [ close the ferry gates  vFerryStatus = F_CLOSE_GATE;  start.update(oFerryGate);  [ cycle one time to close them  end.of.loop(oFerryGate, fFerryMoved);  cycle.time(oFerryGate, vFerryCycle);  }  [ after gates are closedif (isset(fFerryMoved) && vFerryStatus == F_CLOSE_GATE)  {  reset(fFerryMoved);  [ ferry is ready to leave Brooklyn  vFerryStatus = 14;    [ at this point, the NY portion of the game is over; check  [ status of player's progress    [ if Jerrod has not found the gold coin (in the park  [ gazebo)  if (!has("Gold coin"))    {    print.at("You still lack something small, but valuable, that you will need "             "in  California.", 4, 2, 20);    }      [ set the flag to leave the window up, so the scene can  [ continue while player reads score message  set(leaveWindow);  [ give feedback on player score  if (currentScore == 60)    {    print.at("You have 60 points of the possible 60!!\n\nWELL DONE!", 4, 2, 11);    }  else    {    if (OnGrassCount == 0)      {      print.at("You have %v3 points out of the 60 points possible so far!  Keep "               "trying!!", 4, 3, 11);      }    else      {      print.at("You have %v3 points out of the 60 points possible so far!  Be "               "careful in the parks!", 4, 3, 11);      }    }  }  [ while waiting after closing the gatesif (vFerryStatus == F_READY_LEAVE)  {  [ increment timer  ++vFerryTimer;  [ after two cycles  if (vFerryTimer == 2)    {    [ ferry begins its outbound journey to New York    vFerryTimer = 0;    vFerryStatus = F_OUTBOUND_15;    move.obj(oFerry, 68, 141, 1, fFerryMoved);    set.loop(oFerry, 0);    fix.loop(oFerry);    sound(m.Travel, fFerrySound);    }  }  [ when ferry gets to point 15if (isset(fFerryMoved) && vFerryStatus == F_OUTBOUND_15)  {  reset(fFerryMoved);  [ move to point 16  vFerryStatus = F_OUTBOUND_16;  move.obj(oFerry, 70, 119, 1, fFerryMoved);  [ it's away from the dock; show smaller view  set.loop(oFerry, 1);  fix.loop(oFerry);  }  [ when ferry gets to point 16if (isset(fFerryMoved) && vFerryStatus == F_OUTBOUND_16)  {  reset(fFerryMoved);  [ move to point 17  vFerryStatus = F_OUTBOUND_17;  move.obj(oFerry, 78, 104, 1, fFerryMoved);  [ it's further away now, show next smaller view  set.loop(oFerry, 2);  fix.loop(oFerry);  }  [ when ferry gets to point 17if (isset(fFerryMoved) && vFerryStatus == F_OUTBOUND_17)  {  reset(fFerryMoved);  [ move to point 18  vFerryStatus = F_OUTBOUND_18;  move.obj(oFerry, 83, 98, 1, fFerryMoved);  [ it's more than half way to NY; use even smaller view  set.loop(oFerry, 3);  fix.loop(oFerry);  }  [ when ferry gets to point 18if (isset(fFerryMoved) && vFerryStatus == F_OUTBOUND_18)  {  reset(fFerryMoved);  [ now it's almost to NY; move to last point  vFerryStatus = F_OUTBOUND_NY;  move.obj(oFerry, 97, 84, 1, fFerryMoved);  [ use the smallest view  set.loop(oFerry, 4);  fix.loop(oFerry);  }  [ after ferry gets to point New Yorkif (isset(fFerryMoved) && vFerryStatus == F_OUTBOUND_NY)  {  reset(fFerryMoved);  [ very short pause in New York  vFerryStatus = F_PAUSE_NY;  }  [ while pausing in NYif (vFerryStatus == F_PAUSE_NY)  {  [ increment timer  ++vFerryTimer;  [ after two cycles  if (vFerryTimer == 2)    {    vFerryTimer = 0;    [ ferry is officially in NY, and this sequence is done    vFerryStatus = F_END_NY;    [ set flag to begin next sequence of cross-country trip    set(fInNewYork);    }  }  [ once in New Yorkif (isset(fInNewYork))  {  [ reset the flag  reset(fInNewYork);    [ the cross country wagon trip uses a main timer logic  [ that determines the order of rooms visited, and when  [ certain events happen; this block of code sets up the  [ timing variables for the cross country trip  CurrentTripTime = 1;  TripPoint_1 = CurrentTripTime;  CurrentTripTime = 2;  TripPoint_2 = CurrentTripTime;  CurrentTripTime = 3;  TripPoint_3 = CurrentTripTime;  CurrentTripTime = 4;  TripPoint_4 = CurrentTripTime;  CurrentTripTime = 5;  TripPoint_6 = CurrentTripTime;  CurrentTripTime = 6;  TripPoint_9 = CurrentTripTime;  CurrentTripTime = 7;  TripPoint_10 = CurrentTripTime;  CurrentTripTime = 8;  TripPoint_11 = CurrentTripTime;  CurrentTripTime = 9;  TripPoint_12 = CurrentTripTime;  CurrentTripTime = 10;  TripPoint_13 = CurrentTripTime;  CurrentTripTime = 11;  TripPoint_14 = CurrentTripTime;  CurrentTripTime = 12;  TripPoint_15 = CurrentTripTime;  CurrentTripTime = 13;  TripPoint_19 = CurrentTripTime;  CurrentTripTime = 1;    [ and then begin the wagon trip by going to the starting  [ cutscene  new.room(cs.LeavingNY); [ ##LE002##  }  [ **************************************[ PROCESS PLAYER INPUT[ **************************************[ if player hasn't provided input no need to do said testsif (!isset(haveInput))  {  goto(Done);  }  [ look around/lookif ((said("examine", "around") ||     said("examine", "scene") ||     said("examine")))  {  [ if the ferry is at the dock  if (isset(FerryAtDock))    {    print("You are now on board the ferry headed for New York City, the first "          "stop on your way to California!");    }  else    {    print("The ferry is approaching the Brooklyn dock.");    }  }  [ look stagecoach/look horsesif ((said("examine", "coach") ||     said("examine", "animal") ||     said("examine", "team") ||     said("examine", "animal", "team") ||     said("examine", "horse")))  {  print("The animal team and stage are waiting for the ferry.");  }  [ look ferryif (said("examine", "ferry"))  {  [ if ferry is at the dock  if (isset(FerryAtDock))    {    print("The ferry is pulling away from Brooklyn. You are on your way!");    }  else    {    print("The ferry is approaching the Brooklyn dock.");    }  }  [ look New York/look riverif ((said("examine", "new york") ||     said("examine", "creek") ||     said("examine", "water") ||     said("examine", "ocean") ||     said("examine", "east river")))  {  print("The view of the East River and New York City is very impressive!");  }  [ look dockif ((said("examine", "dock") ||     said("examine", "brooklyn", "dock") ||     said("examine", "ferry", "dock")))  {  [ if ferry is at the dock  if (isset(FerryAtDock))    {    print("The ferry is pulling away from the Brooklyn dock. You are on your "          "way!");    }  else    {    print("The ferry is inbound to the Brooklyn dock.");    }  }  Done:return();[ **************************************[ MESSAGES[ **************************************#message 20 "You have %v3 points out of the 60 points possible so far!  Keep trying!!"#message 21 "You have %v3 points out of the 60 points possible so far!  Be careful in the parks!"#message 22 "You have 60 points of the possible 60!!\n\nWELL DONE!"#message 23 "The animal team and stage are waiting for the ferry."#message 24 "The ferry is approaching the Brooklyn dock."#message 25 "The ferry is pulling away from Brooklyn. You are on your way!"#message 26 "The view of the East River and New York City is very impressive!"#message 27 "You still lack something small, but valuable, that you will need in  California."#message 28 "The ferry is pulling away from the Brooklyn dock. You are on your way!"#message 29 "The ferry is inbound to the Brooklyn dock."#message 30 "You are now on board the ferry headed for New York City, the first stop on your way to California!"
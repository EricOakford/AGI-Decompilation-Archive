[***********************************************************[[ rm.Overlook[[ This room is used as a cutscene when Jerrod leaves New[ York by ship. It is also used as a scenery view that is [ accessible from rm.Cemetery.[ The room doesn't use the ego object, but the player can[ enter text input while the room is showing in either mode.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oSteamship                   o1#define vMosquitoTime               v87  [ override BoilerTime#define vShipStatus                v220#define tmpStep                    v221#define tmpCycle                   v222#define tmpVal                     v223#define vTmpVal                    v224#define fRestoreStatus             f221#define fSteamshipMoved            f222#define fCapeHornTrip              f223#define fPanamaTrip                f224[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ if coming from the cemetery  if (previousRoom == rm.Cemetery)    {    [ is the status bar is showing,    if (isset(ShowStatus))      {      [ status bar is not displayed when coming from the      [ cemetery      reset(ShowStatus);      status.line.off();      [ will need to restore the status bar when leaving      set(fRestoreStatus);      }    }      [ load the room's picture  load.pic(currentRoom);    [ this view is not used - it's probably old code that  [ the programmers forgot to remove  load.view(vw.JerrodNY);    [ load the small view of the steamship  load.view(vw.StmShipSmall);    [ draw the picture  draw.pic(currentRoom);  [ if coming from rm.WaterSt_Right  if (previousRoom == rm.WaterSt_Right)    {    [ this is a cutscene showing the steam ship leaving    [ Brooklyn    animate.obj(oSteamship);    set.view(oSteamship, vw.StmShipSmall);    set.loop(oSteamship, 1);    fix.loop(oSteamship);    ignore.blocks(oSteamship);    ignore.objs(oSteamship);    ignore.horizon(oSteamship);    set.priority(oSteamship, 15);    position(oSteamship, 6, 64);    draw(oSteamship);    [ set cycle time and step time so ship moves slowly to    [ its destination    tmpCycle = 2;    cycle.time(oSteamship, tmpCycle);    tmpStep = 10;    step.time(oSteamship, tmpStep);    }    [ now show the picture  show.pic();    [ if Jerrod is not aboard the steamship (which means he is  [ coming from the cemetery room)  if (!isset(OnSteamship))    {    [ set the update status flag so the'return to cemetery'    [ message will get displayed    set(UpdateStatus);    }  }[ **************************************[ EVERY CYCLE[ **************************************[ if Jerrod is not aboard the steamship (which means the [previous room was the cemetery)if (!isset(OnSteamship))  {  [ if the player presses F8  if (controller(keyTrekMsgs))    {    [ if status bar needs to be restored    if (isset(fRestoreStatus))      {      [ restore it      set(ShowStatus);      status.line.on();      [ it's not necessary to reset this local flag, because      [ all local flags and variables are reset each time a       [ new.room command happens      reset(fRestoreStatus);      }          [ clear the 'return to cemetery' status message    clear.lines(24, 24, BLACK);        [ and then go back to cemetery    new.room(rm.Cemetery); [ ##LE001##    }  } [ if Jerrod is on the steamship (which means this is a cut[ scene showing the ship traveling out to sea)if (isset(OnSteamship))  {  [ if ship hasn't started moving yet  if (vShipStatus == 0)    {    [advance to next stage    ++vShipStatus;    [ move ship to first point    move.obj(oSteamship, 15, 64, 1, fSteamshipMoved);    }    [ after ship moves to first point  if (vShipStatus == 1 && isset(fSteamshipMoved))    {    [ advance to next stage    ++vShipStatus;    reset(fSteamshipMoved);    [ move ship to second point    move.obj(oSteamship, 22, 57, 1, fSteamshipMoved);    }    [ after ship moves to second point  if (vShipStatus == 2 && isset(fSteamshipMoved))    {    [advance to next stage    ++vShipStatus;    reset(fSteamshipMoved);    [ move ship to third point    move.obj(oSteamship, 22, 54, 1, fSteamshipMoved);    }      [ after ship moves to third and final point  if (vShipStatus == 3 && isset(fSteamshipMoved))    {    [ ship is done moving    ++vShipStatus;    reset(fSteamshipMoved);        [ set the destination flag based on which ticket Jerrod    [ has purchased    if (TicketChoice == TKT_CAPE)      {      set(fCapeHornTrip);      }    if (TicketChoice == TKT_PANAMA)      {      set(fPanamaTrip);      }    }  }[ The trip to California by boat uses a main timer logic[ that determines the order of rooms visited, and when[ certain events happen. The next two blocks of code set up[ the various timing variables for the chosen trip.[ if Jerrod is set to go on the Cape Horn tripif (isset(fCapeHornTrip))  {  [ if Jerrod didn't buy the fruit  if (!has("Citrus fruit"))    {    [ when CurrentTripTime == 4, Jerrod will get sick due to    [ scurvy    ScurvyTime = 4;    }    [ randomly determine a time for the storm that the ship  [ will encounter on the trip  random(0, 99, vTmpVal);  if (vTmpVal < 50)    {    [ storm will occur during trip point 9 (just before    [ rounding the cape)    StormTime = 9;    }  else    {    [ storm will occur during trip point 11 (just after    [ rounding the cape)    StormTime = 11;    }      [ load the sequence of trip timer set points, which manage  [ the main sequencing of rooms and events  [ trip point 1: start of trip, a short interactive  [ sequence on the steamship   CurrentTripTime = 1;  TripPoint_1 = CurrentTripTime;    [ trip point 2: journey continues with an interactive  [ sequence on the ship  CurrentTripTime = 2;  TripPoint_2 = CurrentTripTime;    [ trip point 3: marker moves on Atlantic map from New York  [ to coast of South America  CurrentTripTime = 3;  TripPoint_3 = CurrentTripTime;    [ trip point 4: journey continues with another interactive  [ sequence on the ship  CurrentTripTime = 4;  if (CurrentTripTime != ScurvyTime)    {    [ TripPoint 4 only gets set if Jerrod has the citrus    [ fruit; otherwise, he's going to get scurvy at triptime    [ point 4    TripPoint_4 = CurrentTripTime;    }    [ trip point 5: marker moves on South America map into  [ Rio de Janeiro  CurrentTripTime = 5;  TripPoint_5 = CurrentTripTime;    [ trip point 6: cut scene showing arrival in  [ Rio de Janeiro  CurrentTripTime = 6;  TripPoint_6 = CurrentTripTime;    [ trip point 7: marker moves on South America map from  [ Rio de Janeiro to edge of screen  CurrentTripTime = 7;  TripPoint_7 = CurrentTripTime;    [ trip point 8: marker moves on Cape Horn map from top  [ down to the Cape  CurrentTripTime = 8;  TripPoint_8 = CurrentTripTime;    [ trip point 9: journey continues with another interactive  [ sequence on the ship  CurrentTripTime = 9;  TripPoint_9 = CurrentTripTime;    [ trip point 10: marker moves on Cape Horn map from Cape  [ to half way up to top edge  CurrentTripTime = 10;  TripPoint_10 = CurrentTripTime;    [ trip point 11: journey continues with another  [ interactive sequence on the ship  CurrentTripTime = 11;  TripPoint_11 = CurrentTripTime;    [ trip point 12: marker moves on Cape Horn map to top edge  CurrentTripTime = 12;  TripPoint_12 = CurrentTripTime;    [ trip point 13: marker moves on South America map to top  [ of map on Pacific side  CurrentTripTime = 13;  TripPoint_13 = CurrentTripTime;    [ trip point 14: marker moves on Pacific Ocean map halfway  [ to California  CurrentTripTime = 14;  TripPoint_14 = CurrentTripTime;    [ trip point 15: journey continues with the last  [ interactive sequence on the ship  CurrentTripTime = 15;  TripPoint_15 = CurrentTripTime;    [ trip point 16: marker moves on Pacific Ocean map to  [ California  CurrentTripTime = 16;  TripPoint_16 = CurrentTripTime;    [ trip point 17: marker moves into San Francisco Bay up to  [ Sacramento  CurrentTripTime = 17;  TripPoint_17 = CurrentTripTime;    [ trip point 18: Jerrod arrives in Sacramento  CurrentTripTime = 18;  TripPoint_19 = CurrentTripTime;    [ set the timer to 1 to start Jerrod on his journey  CurrentTripTime = 1;    [ and continue on the trip  new.room(rm.ShipMidExterior); [ ##LE002##  }[ if going to Panama:  if (isset(fPanamaTrip))  {  [ check to see if player bought the misquito net  if (!has("Mosquito net"))    {    [ assign a random value to vMosquitoTime; this    [ determines when Jerrod will die from mosquito bites    [ (an easier way to do this would be:    [     random(13, 14, vMosquitoTime);    random(0, 1, tmpVal);    if (tmpVal == 0)      {      vMosquitoTime = 13;      }    if (tmpVal == 1)      {      vMosquitoTime = 14;      }    }    [ load the sequence of trip timer set points, which manage  [ the main sequencing of rooms and events    [ trip point 1: start of trip, a short interactive  [ sequence on the steamship  CurrentTripTime = 1;  TripPoint_1 = CurrentTripTime;    [ trip point 2: NOT USED (it gets skipped by the main   [ timing logic)  CurrentTripTime = 2;  TripPoint_2 = CurrentTripTime;    [ trip point 3: marker moves from New York to Cuba  CurrentTripTime = 3;  TripPoint_3 = CurrentTripTime;    [ trip point 4: NOT USED (it gets skipped by the main  [ timing logic)  CurrentTripTime = 4;  TripPoint_4 = CurrentTripTime;    [ trip point 5: marker moves from Cuba to Chagres  CurrentTripTime = 5;  TripPoint_5 = CurrentTripTime;    [ trip point 6: marker moves to Chagres on close up map of  [ Panama isthmus  CurrentTripTime = 6;  TripPoint_6 = CurrentTripTime;    [ trip point 7: cut scene showing transfer to small boats  [ at Chagres, Panama  CurrentTripTime = 7;  TripPoint_7 = CurrentTripTime;    [ trip point 8: jungle scene, showing boats going upriver  CurrentTripTime = 8;  TripPoint_8 = CurrentTripTime;    [ trip point 9: marker moves on isthmus map from Chagres,  [ up river to the disembarkation point  CurrentTripTime = 9;  TripPoint_9 = CurrentTripTime;    [ trip point 10: cut scene on river where natives take all  [ possessions  CurrentTripTime = 10;  TripPoint_10 = CurrentTripTime;    [ trip point 11: cut scene showing passengers leaving  [ small boats and beginning hike through jungle  CurrentTripTime = 11;  TripPoint_11 = CurrentTripTime;    [ trip point 12: marker moves on isthmus through the  [ jungle  CurrentTripTime = 12;  TripPoint_12 = CurrentTripTime;    [ trip point 13: interactive scene in the jungle where  [ ants attack  CurrentTripTime = 13;  TripPoint_13 = CurrentTripTime;    [ trip point 14: interactive scene in the jungle where  [ Jerrod has to safely navigate dense jungle  CurrentTripTime = 14;  TripPoint_14 = CurrentTripTime;    [ trip point 15: interactive scene in the jungle where   [ Jerrod has to cross a river  CurrentTripTime = 15;  TripPoint_15 = CurrentTripTime;    [ trip point 16: marker moves on isthmus to Panama City  CurrentTripTime = 16;  TripPoint_16 = CurrentTripTime;    [ trip point 17: cut scene showing ship leaving Panama  [ City  CurrentTripTime = 17;  TripPoint_17 = CurrentTripTime;    [ trip point 18: marker moves on isthmus from Panama City  [ to edge of scene  CurrentTripTime = 18;  TripPoint_18 = CurrentTripTime;    [ trip point 19: marker moves from Panama City to  [ California  CurrentTripTime = 19;  TripPoint_19 = CurrentTripTime;    [ trip point 20: marker moves into San Francisco Bay up to  [ Sacramento  CurrentTripTime = 20;  TripPoint_20 = CurrentTripTime;    [ trip point 21: Jerrod arrives in Sacramento  CurrentTripTime = 21;  TripPoint_21 = CurrentTripTime;    [ set the trip timer to 1 to start Jerrod on his journey  CurrentTripTime = 1;    [ and continue on the trip  new.room(rm.ShipMidExterior); [ ##LE003##  }[ **************************************[ PROCESS PLAYER INPUT[ **************************************[ if player hasn't provided input no need to do said testsif (!isset(haveInput))  {  goto(Done);  }  [ look/look aroundif ((said("examine") || said("examine", "around")))  {  print("What a view!!");  }  [ look water/look ocean/look riverif ((said("examine", "water") ||     said("examine", "creek") ||     said("examine", "east river") ||     said("examine", "ocean") ||     said("examine", "bay")))  {  print("From here you have an excellent view of the East River.");  }  [ look churchif (said("examine", "church"))  {  print("You see a quaint little church!");  }  [ look buildingif ((said("examine", "building") ||     said("examine", "home")))  {  print("A small cluster of homes surround the church, making it the hub of "        "this little hamlet.");  }  [ look Brooklynif (said("examine", "brooklyn"))  {  print("You see the outskirts of Brooklyn.");  }  [ look scene/look cityif ((said("examine", "scene") ||     said("examine", "city") ||     said("examine", "new york")))  {  print("The view of New York City is breathtaking!");  }  [ look treeif (said("examine", "forest"))  {  print("The trees add to the greenery of the landscape.");  }  [ look shipif (said("examine", "boat"))  {  if (isset(OnSteamship))    {    print("You are aboard the mighty \"Sea Farer.\" This may be the last time "          "you see these familiar sights of Brooklyn!");    }  else    {    print("The ship is not in sight.");    }  }  Done:[ if status line needs updating and previous room was the [ cemeteryif (isset(UpdateStatus) && previousRoom == rm.Cemetery)  {  [ display status line so playe knows how to leave  reset(UpdateStatus);  display(24, 0, "<F8> to return to the cemetery.");  }  return();[ **************************************[ MESSAGES[ **************************************#message 125 "<F8> to return to the cemetery."#message 201 "What a view!!"#message 202 "From here you have an excellent view of the East River."#message 203 "You see a quaint little church!"#message 204 "A small cluster of homes surround the church, making it the hub of this little hamlet."#message 206 "You see the outskirts of Brooklyn."#message 208 "The view of New York City is breathtaking!"#message 209 "The trees add to the greenery of the landscape."#message 210 "You are aboard the mighty \"Sea Farer.\" This may be the last time you see these familiar sights of Brooklyn!"#message 211 "The ship is not in sight."
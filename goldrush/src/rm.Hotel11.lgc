[***********************************************************[[ rm.Hotel11[[ Room 11 in the Green Pastures hotel. This room has a[ secret passage in the fireplace to get into Room 12 to the[ right. If Jerrod spends too much time, the room's guest[ will return and Jerrod gets sent to the gallows[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oWindow                      o1#define oGuest                       o2#define vTmpVal                    v220#define vTimer                     v221#define vTmrCount                  v222#define fWindowMoved               f220#define fWarning                   f221#define fGuestInRoom               f222#define fSoundDone                 f223#define fEffectDone                f224[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load the picture for this room  load.pic(currentRoom);    [ load the views needed for the objects used in this room  load.view(vw.BigJerrodCA);  load.view(vw.HotelArt);  load.view(vw.HotelGuest);    [ load the sounds used in this room  load.sound(m.FoundGold);  load.sound(m.DangerWarning);  load.sound(s.Effect5);  load.sound(s.Window);    [ draw the room picture  draw.pic(currentRoom);    [ add the furniture to the room -   [ bed  add.to.pic(vw.HotelArt, 0, 4, 41, 123, 0, 4);  [ commode  add.to.pic(vw.HotelArt, 0, 5, 27, 149, 0, 4);  [ cannon on mantle  add.to.pic(vw.HotelArt, 0, 7, 113, 85, 12, 12);  [ floor rug  add.to.pic(vw.HotelArt, 0, 8, 37, 137, 9, 9);  [ table  add.to.pic(vw.HotelArt, 0, 9, 80, 113, 0, 4);  [ chair  add.to.pic(vw.HotelArt, 0, 10, 125, 161, 0, 0);  [ chair  add.to.pic(vw.HotelArt, 0, 11, 57, 99, 0, 4);    [ window  animate.obj(oWindow);  set.view(oWindow, vw.HotelArt);  [ default to the unbroken loop  set.loop(oWindow, 2);  [ if window is broken  if (isset(Window11Broken))    {    [ use the broken window loop instead    set.loop(oWindow, 4);    }  else    {    [ this is actually unnecessary; loop 2 was selected by    [ default    set.loop(oWindow, 2);    }      [ if window is open  if (isset(Window11Open))    {    [ show window open (last cel)    set.cel(oWindow, 4);    }  else    {    [ show window closed (first cel)    set.cel(oWindow, 0);    }  position(oWindow, 71, 77);  set.priority(oWindow, 8);  draw(oWindow);  stop.update(oWindow);    [ the guest who is renting this room  animate.obj(oGuest);  set.view(oGuest, vw.HotelGuest);  [ if guest is not away from his room  if (!isset(HotelRoomEmpty))    {    [ add him to the scene    set.loop(oGuest, 0);    position(oGuest, 53, 159);    draw(oGuest);    stop.cycling(oGuest);    [ set flags to indicate guest is back in the room and     [ that he is going to sound the alarm    set(fWarning);    set(fGuestInRoom);    }      [ Jerrod, with large view in California attire  animate.obj(ego);  set.view(ego, vw.BigJerrodCA);  vTmpVal = 2;  step.size(ego, vTmpVal);  draw(ego);  show.pic();  }  [ **************************************[ EVERY CYCLE[ **************************************[ if the room is emptyif (isset(HotelRoomEmpty))  {  [ increment the timer  ++vTimer;  [ after 250 cycles  if (vTimer == 250)    {    [ reset timer; increment count    vTimer = 0;    ++vTmrCount;    [ after four times through the counter    if (vTmrCount == 4)      {      [ the guest comes back!      reset(HotelRoomEmpty);      vTmrCount = 0;      }    }  }  [ if the guest is back (room not empty) AND it hasn't been[ announced yetif (!isset(HotelRoomEmpty) && !isset(fWarning))  {  [ let Jerrod know he's in trouble  print("Oh no!!");  print("Ya hear someone comin' in the door!! It must be the man that is "        "rentin' this room!!");  [ add guest to the scene  position(oGuest, 68, 163);  set.loop(oGuest, 3);  draw(oGuest);  stop.cycling(oGuest);  [ set flag so message only appears once  set(fWarning);  }  [ after displaying warning messageif (isset(fWarning))  {  [ if guest was in room when Jerrod entered  if (isset(fGuestInRoom))    {    [ oops! bad time to enter the room    sound(m.DangerWarning, fSoundDone);    print.at("Drat!! You've picked a lousy time to visit this room! The renter "             "is here and man, is he steamin'!! Things are NOT lookin' good!", 2, 5, 0);    }  [ now the guest calls the cops  print.at("\"HOODLUM, BURGLAR, THIEF!\"", 7, 5, 0);  print.at("\"Get the law up here and take him away!\"", 7, 5, 0);    [ send Jerrod to the gallows; GAME OVER  new.room(rm.Gallows); [ ##LE001##  }  [ if window is done moving,if (isset(fWindowMoved))  {  [ reset flag and stop updating the window  reset(fWindowMoved);  stop.update(oWindow);  }  [ **************************************[ CHECK FOR AN EXIT CONDITION[ **************************************if (posn(ego, 1, 165, 159, 166))  {  position(ego, 117, 71);  set.loop(ego, 2);  new.room(rm.Hotel2ndFloorLeft); [ ##LE002##  }  [ **************************************[ PROCESS PLAYER INPUT[ **************************************[ if player hasn't provided input no need to do said testsif (!isset(haveInput))  {  goto(Done);  }  [ look around/lookif ((said("examine", "around") ||     said("examine", "hotel", "around") ||     said("examine") ||     said("examine", "eleven") ||     said("examine", "around", "eleven")))  {  print("This is a clean and tidy hotel room. It has everything a normal hotel "        "room has and a fireplace.");  print("But ya never know when the man might return!");  }  [ go fireplace/climb in fireplace/enter room 12if ((said("go", "fireplace") ||     said("go", "in", "fireplace") ||     said("climb", "fireplace") ||     said("climb", "in", "fireplace") ||     said("crawl", "fireplace") ||     said("crawl", "in", "fireplace") ||     said("enter", "fireplace") ||     said("go", "room 12") ||     said("go", "around", "room 12") ||     said("go", "in", "room 12") ||     said("go", "in", "around", "room 12") ||     said("climb", "room 12") ||     said("climb", "around", "room 12") ||     said("climb", "in", "room 12") ||     said("climb", "in", "around", "room 12") ||     said("crawl", "room 12") ||     said("crawl", "around", "room 12") ||     said("crawl", "in", "room 12") ||     said("crawl", "in", "around", "room 12") ||     said("enter", "room 12") ||     said("enter", "around", "room 12")))  {  [ if ego is by the fireplace  if (posn(ego, 100, 124, 104, 133))    {    [ if the secret panel is raised    if (isset(PanelRaised))      {      [ crawl through to room 12      print("Ya might get covered with soot, but ya climb into the fireplace!");      position(ego, 51, 128);      set.loop(ego, 1);      new.room(rm.Hotel12); [ ##LE003##      }    else      {      print("If ya did that right now, you'd only get dirty!");      }    }  else    {    print("Yer not close enough.");    }  }  [ look fireplaceif (said("examine", "fireplace"))  {  [ if close enough to the fire place  if (posn(ego, 94, 118, 106, 140))    {    [ if the secret panel is raised    if (isset(PanelRaised))      {      print("The back wall of the fireplace is about three feet above its "            "normal position.");      }    else      {      print("It's a brick fireplace with a decorative cannon on the mantle.");      }    }  else    {    print("It's a brick fireplace with a decorative cannon on the mantle.");    }  }  [ look windowif ((said("examine", "glass") ||     said("examine", "anyword", "glass") ||     said("examine", "glass", "rol")))  {  [ give hint about ledge outside window  print("There's a ledge outside of the window.");  }  [ unlatch windowif ((said("diconnect", "glass") ||     said("unlock", "glass") ||     said("open", "latch")))  {  [ if near the window  if (posn(ego, 66, 96, 78, 101))    {    [ is it already open?    if (isset(Window11Open))      {      print("The window's already open.");      }    else      {      [ is it already unlatched?      if (isset(Window11Unlatched))        {        print("The window's already unlatched.");        }      else        {        print("Ya unlatch the window.");        set(Window11Unlatched);        }      }    }  else    {    print("Yer not close enough.");    }  }  [ latch window  if ((said("latch", "glass") ||     said("lock", "glass")))  {  [ if close enough  if (posn(ego, 66, 96, 78, 101))    {    [ is window open?    if (isset(Window11Open))      {      print("Ya cain't latch the window when the window's open.");      }    else      {      [ is it unlatched?      if (isset(Window11Unlatched))        {        print("Ya latch the window.");        reset(Window11Unlatched);        }      else        {        print("The window's already latched.");        }      }    }  else    {    print("Yer not close enough.");    }  }  [ open windowif (said("open", "glass"))  {  if (posn(ego, 66, 96, 78, 101))    {    if (isset(Window11Open))      {      print("The window's already open.");      }    else      {      if (isset(Window11Unlatched))        {        [ play a sound, and open the window        print("Ya open the window.");        sound(s.Window, fEffectDone);        start.update(oWindow);        end.of.loop(oWindow, fWindowMoved);        set(Window11Open);        }      else        {        print("Ya cain't do that, the window's latched.");        }      }    }  else    {    print("Yer not close enough.");    }  }  [ close windowif (said("close", "glass"))  {  [ if close enough  if (posn(ego, 66, 96, 78, 101))    {    [ is window open?    if (isset(Window11Open))      {      [ play a sound and close the window      print("Ya close the window.");      sound(s.Window, fEffectDone);      start.update(oWindow);      reverse.loop(oWindow, fWindowMoved);      reset(Window11Open);      }    else      {      print("The window's already closed.");      }    }  else    {    print("Yer not close enough.");    }  }  [ break glassif (said("break", "glass"))  {  [ if close enough  if (posn(ego, 66, 96, 78, 101))    {    [ is window open?    if (isset(Window11Open))      {      print("Why? The window's open.");      }    else      {      [ is window already broken?      if (isset(Window11Broken))        {        print("The window's already broken.");        }      else        {        print("Ya have no good reason to break the window.");        }      }    }  else    {    print("Yer not close enough.");    }  }  [ crawl thorugh window on to ledgeif ((said("go", "glass") ||     said("go", "anyword", "glass") ||     said("go", "glass", "rol") ||     said("climb", "glass") ||     said("climb", "anyword", "glass") ||     said("climb", "glass", "rol") ||     said("crawl", "glass") ||     said("crawl", "anyword", "glass") ||     said("crawl", "glass", "rol") ||     said("go", "ledge") ||     said("go", "anyword", "ledge") ||     said("go", "ledge", "rol") ||     said("climb", "ledge") ||     said("climb", "anyword", "ledge") ||     said("climb", "ledge", "rol") ||     said("crawl", "ledge") ||     said("crawl", "anyword", "ledge") ||     said("crawl", "ledge", "rol") ||     said("enter", "glass")))  {  [ if close enough  if (posn(ego, 66, 96, 78, 101))    {    [ is window open?    if (isset(Window11Open))      {      print("It's a tight fit, but ya manage to crawl thru the window.");      [ change room to outside, on the ledge      position(ego, 26, 95);      set.loop(ego, 0);      new.room(rm.LedgeRight); [ ##LE004##      }    else      {      print("Ya cain't do that! The window's closed.");      }    }  else    {    print("Yer not close enough.");    }  }  [ look cannonif (said("examine", "cannon"))  {  [ if close enough  if (posn(ego, 94, 118, 106, 140))    {    print("This cannon looks just like the one on the tombstone at Sutter's "          "Fort!");    print("However, the wheel on this cannon looks bigger than the one on the "          "tombstone.");    }  else    {    print("From here it looks like just a decorative cannon.");    }  }  [ look cannon wheelif ((said("examine", "cannon", "wheel") ||     said("examine", "wheel", "cannon") ||     said("examine", "wheel")))  {  [ if close enough  if (posn(ego, 94, 118, 106, 140))    {    print("It seems that this cannon wheel is too big to be merely a part of a "          "decorative cannon.");    }  else    {    print("From here it looks like a wheel on a decorative cannon.");    }  }  [ take cannonif (said("acquire", "cannon"))  {  if (posn(ego, 100, 124, 104, 133))    {    print("The cannon is very securely attached to the mantle.");    }  else    {    print("Yer not close enough.");    }  }  [ rotate cannon wheelif ((said("rotate", "wheel", "cannon") ||     said("rotate", "cannon", "wheel") ||     said("rotate", "wheel")))  {  [ if close enough  if (posn(ego, 100, 124, 104, 133))    {    [ if panel is up    if (isset(PanelRaised))      {      [ lower it      sound(s.Effect5, fEffectDone);      print("Ya turn the wheel on the cannon and lower the back wall of the "            "fireplace!");      reset(PanelRaised);      }    else      {      [ if panel was previously discovered      if (isset(ScoreSecretPanel))        {        [ just open it        sound(s.Effect5, fEffectDone);        print("Ya turn the wheel on the cannon and raise the back wall of the "              "fireplace!");        set(PanelRaised);        }      else        {        [ play score points sound        sound(m.FoundGold, fSoundDone);        print("The cannon wheel is difficult to turn.");        print("But as you continue to turn the wheel, you realize that an "              "ingeniously designed mechanism is raising the back wall in the "              "fireplace!!");        [ raise fireplace panel        set(PanelRaised);        [ score five points        set(ScoreSecretPanel);        currentScore  += 5;        }      }    }  else    {    print("Yer not close enough.");    }  }  [ rotating cannon is not quite right (has to be the wheel)if ((said("rotate", "cannon") ||     said("rotate", "cannon", "around")))  {  if (posn(ego, 100, 124, 104, 133))    {    print("The cannon is very securely attached to the mantle.");    }  else    {    print("Yer not close enough.");    }  }  [ look mantelif (said("examine", "mantle"))  {  print("From here it looks like just a decorative cannon.");  }  [ look wallif ((said("examine", "wall") ||     said("examine", "wall", "newspaper") ||     said("examine", "wallpaper")))  {  print("The room has nice wallpaper.");  }  [ look floorif (said("examine", "deck"))  {  print("It's just a hardwood floor.");  }  [ look commodeif (said("examine", "commode"))  {  if (posn(ego, 30, 110, 75, 167))    {    print("Sittin' on the commode is a pitcher and bowl.");    }  else    {    print("There's a commode sittin' next to the bed.");    }  }  [ look pitcher/look bowlif ((said("examine", "pitcher") ||     said("examine", "bowl")))  {  print("There's a pitcher and bowl sittin' on the commode.");  }  [ look carpetif (said("examine", "carpet"))  {  print("Next to the bed is a small rug to keep bare feet off the cold floor!");  }  [ look chairif (said("examine", "chair"))  {  print("There are a couple of chairs in the hotel room.");  }  [ look bedif (said("examine", "bed"))  {  print("It is a neatly made bed.");  }  [ look tableif (said("examine", "table"))  {  print("There's an ordinary table in the corner of the hotel room.");  }[ take {stuff from room}  if ((said("acquire", "pitcher") ||     said("acquire", "bowl") ||     said("acquire", "chair") ||     said("acquire", "carpet") ||     said("acquire", "bed") ||     said("acquire", "table") ||     said("acquire", "commode")))  {  print("Ya have no need fer that.");  }  [ open fireplaceif (said("open", "fireplace"))  {  if (posn(ego, 100, 124, 104, 133))    {    if (isset(PanelRaised))      {      print("The back wall of the fireplace is already open.");      }    else      {      print("A dandy idea, but how?");      }    }  else    {    print("Yer not close enough.");    }  }  [ close fireplaceif (said("close", "fireplace"))  {  if (posn(ego, 100, 124, 104, 133))    {    if (isset(PanelRaised))      {      print("A dandy idea, but how?");      }    else      {      [ if Jerrod doesn't know about the back wall, a       [ differnt response would make more sense; there       [ should be a test here to see if Jerrod has found      [ the panel, and then provide different response for      [ whether he did or didn't      print("The back wall of the fireplace is already closed.");      }    }  else    {    print("Yer not close enough.");    }  }  [ look doorif (said("examine", "door"))  {  [ is this a bug? why would this be the resonse for looking  [ at the door?  print("It won't do any good, the beggar has a key!");  }  [ look ledgeif (said("examine", "ledge"))  {  print("A narrow ledge is on the outside wall of the hotel.");  }  [ take a napif ((said("sleep") ||     said("sleep", "bed") ||     said("sleep", "in", "bed") ||     said("go", "sleep") ||     said("acquire", "sleep") ||     said("lay", "down") ||     said("lay", "down", "sleep") ||     said("lay", "down", "bed") ||     said("lay", "down", "in", "bed") ||     said("lay", "bed") ||     said("lay", "in", "bed") ||     said("use", "bed") ||     said("go", "bed") ||     said("enter", "bed") ||     said("nap") ||     said("acquire", "nap")))  {  print("You'll never strike it rich if you do that!");  }  Done:return();[ **************************************[ MESSAGES[ **************************************#message 1 "The window's already open."#message 2 "The window's already unlatched."#message 3 "Ya unlatch the window."#message 4 "Yer not close enough."#message 5 "Ya cain't latch the window when the window's open."#message 6 "Ya latch the window."#message 7 "The window's already latched."#message 8 "Ya open the window."#message 9 "Ya cain't do that, the window's latched."#message 10 "Ya close the window."#message 11 "The window's already closed."#message 12 "Why? The window's open."#message 13 "Ya have no good reason to break the window."#message 14 "It's a tight fit, but ya manage to crawl thru the window."#message 15 "Ya cain't do that! The window's closed."#message 16 "The window's already broken."#message 17 "This cannon looks just like the one on the tombstone at Sutter's Fort!"#message 18 "The cannon wheel is difficult to turn."#message 19 "But as you continue to turn the wheel, you realize that an ingeniously designed mechanism is raising the back wall in the fireplace!!"#message 20 "Ya turn the wheel on the cannon and raise the back wall of the fireplace!"#message 21 "Ya turn the wheel on the cannon and lower the back wall of the fireplace!"#message 22 "The cannon is very securely attached to the mantle."#message 23 "The back wall of the fireplace is about three feet above its normal position."#message 24 "It's a brick fireplace with a decorative cannon on the mantle."#message 25 "If ya did that right now, you'd only get dirty!"#message 26 "Ya might get covered with soot, but ya climb into the fireplace!"#message 27 "But ya never know when the man might return!"#message 28 "This is a clean and tidy hotel room. It has everything a normal hotel room has and a fireplace."#message 29 "From here it looks like just a decorative cannon."#message 30 "The room has nice wallpaper."#message 31 "It's just a hardwood floor."#message 32 "Sittin' on the commode is a pitcher and bowl."#message 33 "There's a commode sittin' next to the bed."#message 34 "There's a pitcher and bowl sittin' on the commode."#message 35 "Next to the bed is a small rug to keep bare feet off the cold floor!"#message 36 "There are a couple of chairs in the hotel room."#message 37 "It is a neatly made bed."#message 38 "There's an ordinary table in the corner of the hotel room."#message 39 "There's a ledge outside of the window."#message 40 "Oh no!!"#message 41 "Ya hear someone comin' in the door!! It must be the man that is rentin' this room!!"#message 42 "Drat!! You've picked a lousy time to visit this room! The renter is here and man, is he steamin'!! Things are NOT lookin' good!"#message 43 "\"HOODLUM, BURGLAR, THIEF!\""#message 44 "\"Get the law up here and take him away!\""#message 45 "Ya have no need fer that."#message 46 "The back wall of the fireplace is already open."#message 47 "A dandy idea, but how?"#message 48 "The back wall of the fireplace is already closed."#message 49 "It won't do any good, the beggar has a key!"#message 96 "However, the wheel on this cannon looks bigger than the one on the tombstone."#message 97 "From here it looks like just a decorative cannon."#message 98 "It seems that this cannon wheel is too big to be merely a part of a decorative cannon."#message 99 "From here it looks like a wheel on a decorative cannon."#message 101 "A narrow ledge is on the outside wall of the hotel."#message 103 "You'll never strike it rich if you do that!"
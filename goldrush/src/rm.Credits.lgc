[***********************************************************[[ rm.Credits[[ after the main introduction, the credits roll at the end[ of the credits, the game will do a transition to the[ starting room (rm.MainSt)[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oHead                        o1#define oCredits                     o2#define oBlankCenter                 o3#define oJmpJerrod                   o4#define vPicIntro                  v220#define vPicNW                     v221#define vPicNE                     v222#define vPicSE                     v223#define vPicSW                     v224#define vMainPhase                 v225#define vHeadPhase                 v226#define vMainTimer                 v227#define vHeadTimer                 v228#define vCreditLoop                v229#define vTempVal                   v230#define fMoveDone                  f220#define fNextLoop                  f221#define fJumpDone                  f222#define fSndDone                   f223[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ find the intro picture plus the four overlays  vPicIntro = pic.IntroFull;  vPicNW = pic.NWSceneDone;  vPicNE = pic.NESceneDone;  vPicSE = pic.SESceneDone;  vPicSW = pic.SWSceneDone;    [ load intro picture  load.pic(vPicIntro);    [ load current room picture (the GoldRush! title overlay)  load.pic(currentRoom);    [ load the first three overlays  load.pic(vPicNW);  load.pic(vPicNE);  load.pic(vPicSE);    [ load all the views in this room  load.view(vw.JerrodNY);  load.view(vw.JerrodHeadIntro);  load.view(vw.Credits);  load.view(vw.JmpJerrod);    [ and also the main theme music  load.sound(m.Suzannah);    [ lastly, load fourth overlay  load.pic(vPicSW);    [ now draw the introduction picture, and add the four  [ overlays so screen looks the same as the previous room  draw.pic(vPicIntro);  overlay.pic(vPicNW);  overlay.pic(vPicNE);  overlay.pic(vPicSE);  overlay.pic(vPicSW);  [ add the Goldrush! title  overlay.pic(currentRoom);    [ the SW corner is Brooklyn; that overlay can be discarded  [ because it won't be used after the credits end  discard.pic(vPicSW);    [ Jerrod's head in center of screen  animate.obj(oHead);  set.view(oHead, vw.JerrodHeadIntro);  set.loop(oHead, 0);  set.cel(oHead, 0);  set.priority(oHead, 13);  stop.cycling(oHead);  ignore.objs(oHead);  ignore.blocks(oHead);  position(oHead, 71, 103);  draw(oHead);  [ start in phase 1  vHeadPhase = 1;    [ the credits object (but don't draw it yet)  animate.obj(oCredits);  set.view(oCredits, vw.Credits);  set.loop.v(oCredits, vCreditLoop);  set.priority(oCredits, 15);  position(oCredits, 37, 146);    [ once Jerrod has left the center when the credits end, an  [ object will be used to adjust the center color to match  [ the other 'disabled' quadrants  animate.obj(oBlankCenter);  set.view(oBlankCenter, vw.JmpJerrod);  set.loop(oBlankCenter, 2);  set.priority(oBlankCenter, 13);  position(oBlankCenter, 53, 103);    [ start at beginning of credits phase  vMainPhase = 1;    [ now show the picture  show.pic();    [ start the music playing while credits roll  sound(m.Suzannah, fSndDone);  [ no user input during credits  prevent.input();  lastChar = 0;  reset(haveMatch);  }  [ **************************************[ EVERY CYCLE:[ **************************************[ if head is at beginning of movement phase  [ in first phase, Jerrod looks up and back and forthif (vHeadPhase == 1)  {    [ increment timer  ++vHeadTimer;  [ after 25 cycles  if (vHeadTimer == 25)    {    [ look right    set.cel(oHead, 1);    }  [ after 50 cycles  if (vHeadTimer == 50)    {    [ look left    set.cel(oHead, 0);    [ and reset timer    vHeadTimer = 0;    }  }  [ in phase 2, Jerrod looks down and back and forth  if (vHeadPhase == 2)  {  [ increment timer  ++vHeadTimer;  [ after 25 cycles  if (vHeadTimer == 25)    {    [ look right    set.cel(oHead, 3);    }  [ after 50 cycles  if (vHeadTimer == 50)    {    [ look left    set.cel(oHead, 2);    [ and reset timer    vHeadTimer = 0;    }  }  [ in last phaseif (vHeadPhase == 3)  {  [ stop on cel 3, in preparation for final animation  set.cel(oHead, 3);  }[ if main title sequence is active  if (vMainPhase < 8)  {  [ always increment the main timer  ++vMainTimer;  }[ if next credit loop is neededif (isset(fNextLoop))  {  [ after 10 cycles  if (vMainTimer == 10)    {    [ reset the timer    vMainTimer = 0;    [ advance the phase and the current credits loop    ++vMainPhase;    ++vCreditLoop;        [ if not past the last credit yet    if (vCreditLoop < 6)      {    [ change the loop      set.loop.v(oCredits, vCreditLoop);      reset(fNextLoop);      [ positon the credit line according to its size/shape      if (vCreditLoop == 1)        {        position(oCredits, 51, 147);        }      if (vCreditLoop == 2)        {        position(oCredits, 54, 147);        }      if (vCreditLoop == 3)        {        position(oCredits, 37, 153);        }      if (vCreditLoop == 4)        {        position(oCredits, 44, 145);        }      if (vCreditLoop == 5)        {        position(oCredits, 59, 143);        }      [ then add it to screen      draw(oCredits);      }    }  }[ if at start of main credit sequenceif (vMainPhase == 1)  {  [ after 40 cycles  if (vMainTimer == 40)    {    [ reset the timer    vMainTimer = 0;    [ adjust Jerrod's head    set.cel(oHead, 3);    [ advance head phase and main phase    vHeadPhase = 2;    vMainPhase = 2;    [ display first credit line - 'created/designed by'    draw(oCredits);    }  }[ in second phase of main credit sequenceif (vMainPhase == 2)  {  [ after 30 cycles  if (vMainTimer == 30)    {    [ hide 'created/designed by'    erase(oCredits);    [ reset timer    vMainTimer = 0;    [ ready for next credit line    set(fNextLoop);    }  }[ in third phase of main credit sequenceif (vMainPhase == 3)  {  if (vMainTimer == 20)    {    [ hide 'programming by'        erase(oCredits);    [ reset timer    vMainTimer = 0;    [ ready for next credit line    set(fNextLoop);    }  }  [ in fourth phase of main credit sequenceif (vMainPhase == 4)  {  [ after 20 cycles      if (vMainTimer == 20)    {    [ hide 'graphics by'    erase(oCredits);    [ reset timer    vMainTimer = 0;    [ ready for next credit line    set(fNextLoop);    }  }  [ in fifth phase of main credit sequenceif (vMainPhase == 5)  {  [ after 25 cycles      if (vMainTimer == 25)    {    [ hide 'AGI system by'    erase(oCredits);    [ reset timer    vMainTimer = 0;    [ ready for next credit line    set(fNextLoop);    }  } [ in sixth phase of main credit sequence if (vMainPhase == 6)  {  [ after 20 cycles      if (vMainTimer == 20)    {    [ hide 'graphics utilities by'    erase(oCredits);    [ reset timer    vMainTimer = 0;    [ ready for last credit line    set(fNextLoop);    }  }[ in seventh phase of main credit sequence if (vMainPhase == 7)  {  [ after 20 cycles  if (vMainTimer == 20)    {    [ hide 'music by' (this is the last one)    erase(oCredits);    [ reset timer    vMainTimer = 0;    [ set flag for next loop (which will increment counter    [ so no more lines will be shown)    set(fNextLoop);    }  }[ after last line of credits has been shownif (vMainPhase == 8)  {  [ credits are done  reset(fNextLoop);  [ move Jerrod's head down, out of center area  vHeadPhase = 3;  vMainPhase = 9;  vMainTimer = 0;  move.obj(oHead, 71, 145, 3, fMoveDone);  }[ after head has moved out of the centerif (isset(fMoveDone) && vMainPhase == 9)  {  [ Jerrod jumps up into the center  reset(fMoveDone);  vMainPhase = 10;  erase(oHead);  animate.obj(oJmpJerrod);  set.view(oJmpJerrod, vw.JmpJerrod);  set.loop(oJmpJerrod, 0);  fix.loop(oJmpJerrod);  set.cel(oJmpJerrod, 0);  set.priority(oJmpJerrod, 13);  position(oJmpJerrod, 79, 103);  draw(oJmpJerrod);  end.of.loop(oJmpJerrod, fJumpDone);  }[ after Jerrod has jumped into centerif (isset(fJumpDone) && vMainPhase == 10)  {  [ reconfigure the screen to show the Brooklyn scene in  [ normal colors, and all objects erased  reset(fJumpDone);  vMainPhase = 11;  unanimate.all();  draw.pic(vPicIntro);  [ after drawing picture overlay all scene 'grays' except  [for the Brooklyn scene  overlay.pic(vPicNW);  overlay.pic(vPicNE);  overlay.pic(vPicSE);  [ add the Goldrush! title  overlay.pic(currentRoom);    [ add the blank center  animate.obj(oBlankCenter);  set.view(oBlankCenter, vw.JmpJerrod);  set.loop(oBlankCenter, 2);  set.priority(oBlankCenter, 13);  position(oBlankCenter, 53, 103);    [ now add Jerrod for his last jump, into Brooklyn  animate.obj(oJmpJerrod);  set.view(oJmpJerrod, vw.JmpJerrod);  set.loop(oJmpJerrod, 1);  fix.loop(oJmpJerrod);  set.cel(oJmpJerrod, 0);  set.priority(oJmpJerrod, 15);  position(oJmpJerrod, 60, 160);  draw(oJmpJerrod);  end.of.loop(oJmpJerrod, fJumpDone);    [ now show the picture  show.pic();  }[ while Jerrod is jumping out of the centerif (vMainPhase == 11)  {  [ check Jerrod's current cel  current.cel(oJmpJerrod, vTempVal);  [ at cel 4  if (vTempVal == 4)    {    [ Jerrod is completely out of the center; draw the blank    [ center object (which gives it the 'disabled' look like    [ the other scene quadrants)       draw(oBlankCenter);    }  }[ after Jerrod finishes jumping into Brooklynif (isset(fJumpDone) && vMainPhase == 11)  {  [ Jerrod walks to the starting position using the normal  [ Brooklyn attire view, in two steps  reset(fMoveDone);  vMainPhase = 12;  set.view(oJmpJerrod, vw.JerrodNY);  release.priority(oJmpJerrod);  start.cycling(oJmpJerrod);  move.obj(oJmpJerrod, 39, 160, 1, fMoveDone);  }  [ when Jerrod reaches first point on way to starting pointif (isset(fMoveDone) && vMainPhase == 12)  {  [ move to final starting point  reset(fMoveDone);  vMainPhase = 13;  move.obj(oJmpJerrod, 20, 141, 1, fMoveDone);  }[ when Jerrod reaches the starting pointif (isset(fMoveDone) && vMainPhase == 13)  {  [ ready to begin game by going to rm.MainSt (none of these  [ other commands are necessary, because all the objects  [ get reinitialized by the new.room command)  reset(fMoveDone);  vMainPhase = 14;  set.loop(oJmpJerrod, 0);  set.cel(oJmpJerrod, 0);  force.update(oJmpJerrod);  new.room(rm.MainSt); [ ##LE001##  }[ allow player to skip the credits scene by pressing any keyif (have.key())  {  new.room(rm.MainSt); [ ##LE002##  }return();[ **************************************[ MESSAGES[ **************************************
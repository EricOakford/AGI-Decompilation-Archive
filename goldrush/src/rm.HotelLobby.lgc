[***********************************************************[[ rm.HotelLobby[ [ The lobby of the Green Pastures Hotel. This is where[ Jerrod gets the note to deliver to room 11, which allows [ him to get into that room.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oClerk                       o1#define oRoomNote                    o2#define vTmpVal                    v220#define vTmpY                      v221#define vWaitForAnswer             v222#define vClerkStatus               v223#define vClerkTimer                v224#define fClerkMoved                f220[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load picture for current room  load.pic(currentRoom);    [ load views used in the room  load.view(vw.BigJerrodCA);  load.view(vw.PostMaster);  load.view(vw.HotelArt);    [ draw the room picture  draw.pic(currentRoom);    [ add notes to the room mailboxes  add.to.pic(vw.HotelArt, 0, 0, 34, 67, 9, 9);  add.to.pic(vw.HotelArt, 0, 1, 50, 81, 9, 9);  add.to.pic(vw.HotelArt, 0, 2, 38, 81, 9, 9);  add.to.pic(vw.HotelArt, 0, 3, 42, 74, 9, 9);  add.to.pic(vw.HotelArt, 0, 3, 38, 60, 9, 9);    [ move horizon up near the top  set.horizon(10);    [ the note for room 13 needs to be an object  animate.obj(oRoomNote);  set.view(oRoomNote, vw.HotelArt);  set.loop(oRoomNote, 0);  set.cel(oRoomNote, 2);  ignore.blocks(oRoomNote);  ignore.objs(oRoomNote);  position(oRoomNote, 46, 67);  set.priority(oRoomNote, 9);  draw(oRoomNote);  stop.cycling(oRoomNote);    [ hotel desk clerk  animate.obj(oClerk);  set.view(oClerk, vw.PostMaster);  set.loop(oClerk, 2);  position(oClerk, 55, 107);  draw(oClerk);  stop.cycling(oClerk);    [ Jerrod uses large view here  animate.obj(ego);  set.view(ego, vw.BigJerrodCA);  vTmpVal = 2;  step.size(ego, vTmpVal);  draw(ego);    [ show the picture  show.pic();  }  [ **************************************[ EVERY CYCLE[ **************************************[ if Jerrod has a mule (means he didn't tie it up outside)if ((has(LazyMule) || has("James' ol' mule")))  {  print("Ya gone off and left yer mule outside without tyin' it up! Now yer "        "mule is gone!");  drop(LazyMule);  drop("James' ol' mule");  }  [ if Jerrod is going left or up-leftif ((egoDir == LEFT || egoDir == UP_LEFT))  {  [ if he touches an alarm line on the stairs  if (isset(egoHitSpecial))    {    [ bump him right and up one pixel    vTmpVal = -1; [ 255;    vTmpY = -1; [ 255;    reposition(ego, vTmpVal, vTmpY);    }  }  [ if Jerrod is going right or down-rightif ((egoDir == RIGHT || egoDir == DOWN_RIGHT))  {  [ if he touches an alarm line on the stairs  if (isset(egoHitSpecial))    {    [ bump him left and down one pixel    vTmpVal = 1;    vTmpY = 1;    reposition(ego, vTmpVal, vTmpY);    }  }  [ when clerk gets to mailboxesif (isset(fClerkMoved) && vClerkStatus == 1)  {  [ reset flag  reset(fClerkMoved);  [ advance to next stage  vClerkStatus = 2;  [ clerk faces away (looking at mailboxes)  set.loop(oClerk, 3);  }  [ while clerk is at mailboxesif (vClerkStatus == 2)  {  [ increment timer  ++vClerkTimer;  [ after 20 cycles  if (vClerkTimer == 20)    {    [ rest timer    vClerkTimer = 0;    [ advance to next stage    vClerkStatus = 3;    [ remove note from box    erase(oRoomNote);    [ clerk comes back to desk    move.obj(oClerk, 55, 107, 2, fClerkMoved);    [ if print window is open, close it    close.window();    }  }  [ when clerk gets back to desk with the noteif (isset(fClerkMoved) && vClerkStatus == 3)  {  [ reset the flag  reset(fClerkMoved);  [ advance to next stage  vClerkStatus = 4;  [ clerk faces Jerrod  set.loop(oClerk, 2);  [ force it to draw right now  force.update(oClerk);  [ give message to Jerrod  print.at("\"Here's the message. Thanks, I owe ya one!\"", 2, 5, 0);  get("Message for room 11");  set(HasRoom11Message);  start.motion(ego);  print("You reply, \"No problem.\"");  }  [ **************************************[ CHECK FOR AN EXIT CONDITION[ **************************************[ if Jerrod is by exit back into the streetif (posn(ego, 40, 165, 150, 166))  {  [ position Jerrod for the next room  position(ego, 77, 140);    [ if Jerrod has not delivered the message to room 11  if (has("Message for room 11"))    {    [ give it back to the clerk    print("Before you leave the hotel, you give the man at the counter the "          "message you said you would deliver to room 11.");    draw(oRoomNote);    reset(HasRoom11Message);    drop("Message for room 11");    }  [ go back out into the street  new.room(rm.GreenPastures); [ ##LE001##  }  [ **************************************[ CHECK FOR AN EXIT CONDITION[ **************************************[ if Jerrod is a right edge along bottomif (posn(ego, 10, 121, 11, 143))  {  [ position Jerrod so he will be in correct location in new  [ room  position(ego, 100, 134);  set.loop(ego, 2);  egoDir = STOPPED;  [ move into hallway of first floor  new.room(rm.Hotel1stFloorRight); [ ##LE002##  }  [ if Jerrod is at right edge, on second floor ( along top[ edge)if (posn(ego, 42, 25, 44, 62))  {  [ position Jerrod so he will be in correct location in new  [ room  position(ego, 58, 73);  set.loop(ego, 2);  egoDir = STOPPED;  [ move into hallway of second floor  new.room(rm.Hotel2ndFloorRight); [ ##LE003##  }  [ **************************************[ PROCESS PLAYER INPUT[ **************************************[ if player hasn't provided input no need to do said testsif (!isset(haveInput))  {  goto(Done);  }  [ anytime player inputs anything, always restore input[ prompt to the default; it may have been changed during[ conversation with clerkset.string(inputPrompt, "%g69");[ force it to updateaccept.input();inputLength = 38;[ talk to manif ((said("speak", "boy") ||     said("speak")))  {  [ if Jerrod is by the desk  if (posn(ego, 25, 117, 95, 141))    {    [ if Jerrod has seen the letter about Jake's room here    [ at the hotel    if (isset(ScoreLetterClue))      {      print.at("The man says, \"Howdy! You look like ya know what yer lookin' "               "fer. What can I do fer ya?\"", 2, 5, 0);      }    else      {      print.at("\"It's written all over yer face stranger, you look lost! I "               "don't think you have a reason to be here right now!\"", 2, 5, 0);      }    }  else    {    print("Ya need to get closer so the man can hear ya.");    }  }  [ look manif (said("examine", "boy"))  {  print("There's a man working behind the counter.");  }  [ go aroundif (said("go", "around"))  {  if (posn(ego, 25, 117, 95, 141))    {    print.at("Ya need to be more specific!", 2, 5, 0);    }  else    {    print("Ya need to get closer so the man can hear ya.");    }  }  [ anything with room 12if ((said("anyword", "room 12") ||     said("anyword", "around", "room 12") ||     said("anyword", "house key", "room 12") ||     said("anyword", "house key", "around", "room 12") ||     said("anyword", "room 12", "house key") ||     said("anyword", "around", "room 12", "house key")))  {  [ if near the clerk  if (posn(ego, 25, 117, 95, 141))    {    print.at("\"I haven't been here long, but there's no room 12 that I know "             "of.\"", 2, 5, 0);    }  else    {    print("Ya need to get closer so the man can hear ya.");    }  }  [ anything with room elevenif ((said("anyword", "eleven") ||     said("anyword", "around", "eleven") ||     said("anyword", "house key", "eleven") ||     said("anyword", "house key", "around", "eleven") ||     said("anyword", "eleven", "house key") ||     said("anyword", "around", "eleven", "house key")))  {  [ if near the clerk  if (posn(ego, 25, 117, 95, 141))    {    [ if Jerrod is aware that Jake has a room here    if (isset(ScoreLetterClue))      {      print.at("\"Sorry fella, I just rented that room. The man didn't know how "               "long he'd be staying.\"", 2, 5, 0);      [ if Jerrod does not have the room message      if (!isset(HasRoom11Message))        {        [ clerk asks Jerrod to deliver the message        print.at("\"Oh my willikers! I nearly forgot!! I got a message to give "                 "that beggar stayin' in room 11. Would ya deliver it fer me?\"", 2, 5, 0);        [ change input prompt        set.string(inputPrompt, "Yes or no %g69");        [ force input line to update        accept.input();        inputLength = 29;                [ wait for Jerod to answer        vWaitForAnswer = 1;        }      }    else      {      print.at("\"Right now, you don't look like you know what yer doing, "               "stranger.\"", 2, 5, 0);      }    }  else    {    print("Ya need to get closer so the man can hear ya.");    }  }  [ anything room 10/anything room 11/anything about any other[ roomif ((said("anyword", "room 10") ||     said("anyword", "around", "room 10") ||     said("anyword", "house key", "room 10") ||     said("anyword", "house key", "around", "room 10") ||     said("anyword", "room 10", "house key") ||     said("anyword", "around", "room 10", "house key") ||     said("anyword", "room 13") ||     said("anyword", "around", "room 13") ||     said("anyword", "house key", "room 13") ||     said("anyword", "house key", "around", "room 13") ||     said("anyword", "room 13", "house key") ||     said("anyword", "around", "room 13", "house key") ||     said("anyword", "twenty", "one") ||     said("anyword", "around", "twenty", "one") ||     said("anyword", "house key", "twenty", "one") ||     said("anyword", "house key", "around", "twenty", "one") ||     said("anyword", "twenty", "one", "house key") ||     said("anyword", "around", "twenty", "one", "house key") ||     said("anyword", "room 21") ||     said("anyword", "around", "room 21") ||     said("anyword", "house key", "room 21") ||     said("anyword", "house key", "around", "room 21") ||     said("anyword", "room 21", "house key") ||     said("anyword", "around", "room 21", "house key") ||     said("anyword", "twenty", "two") ||     said("anyword", "around", "twenty", "two") ||     said("anyword", "house key", "twenty", "two") ||     said("anyword", "house key", "around", "twenty", "two") ||     said("anyword", "twenty", "two", "house key") ||     said("anyword", "around", "twenty", "two", "house key") ||     said("anyword", "room 22") ||     said("anyword", "around", "room 22") ||     said("anyword", "house key", "room 22") ||     said("anyword", "house key", "around", "room 22") ||     said("anyword", "room 22", "house key") ||     said("anyword", "around", "room 22", "house key") ||     said("anyword", "twenty", "three") ||     said("anyword", "around", "twenty", "three") ||     said("anyword", "house key", "twenty", "three") ||     said("anyword", "house key", "around", "twenty", "three") ||     said("anyword", "twenty", "three", "house key") ||     said("anyword", "around", "twenty", "three", "house key") ||     said("anyword", "room 23") ||     said("anyword", "around", "room 23") ||     said("anyword", "house key", "room 23") ||     said("anyword", "house key", "around", "room 23") ||     said("anyword", "room 23", "house key") ||     said("anyword", "around", "room 23", "house key")))  {  [ if by the clerk  if (posn(ego, 25, 117, 95, 141))    {    print.at("\"Sorry stranger, all the rooms are either occupied or "             "reserved.\"", 2, 5, 0);    }  else    {    print("Ya need to get closer so the man can hear ya.");    }  }  [ yesif (said("y"))  {  [ if clerk is waiting for an answer  if (vWaitForAnswer == 1)    {    [ Jerrod agrees to deliver the letter    print.at("\"Great! Hang on a second!\"", 2, 5, 0);    [ move clerk to room mailboxes    move.obj(oClerk, 47, 107, 2, fClerkMoved);    vClerkStatus = 1;        [ no longer waiting for answer    vWaitForAnswer = 0;    [ stop Jerrod while the clerk gets the letter    stop.motion(ego);    [ done processing    goto(Done);    }  [ in any other context, 'yes' makes no sense  print("Yes what?!");  }  [ noif (said("n"))  {  [ if clerk is waiting for an answer  if (vWaitForAnswer == 1)    {    [ Jerrod doesn't want to deliver the letter    print.at("\"I'll do it myself!\"", 2, 5, 0);    print.at("\"Later!!\"", 2, 5, 0);    [ done waiting for an answer    vWaitForAnswer = 0;    [ done processing    goto(Done);    }  [ in any other context 'no' makes no sense  print("No what?!");  }  [ get keyif (said("acquire", "house key"))  {  [ if near the clerk  if (posn(ego, 25, 117, 95, 141))    {    print.at("\"Keys are only fer folks rentin' a room.\"", 2, 5, 0);    }  else    {    print("Ya need to get closer so the man can hear ya.");    }  }  [rent a roomif ((said("rent", "around") ||     said("acquire", "around") ||     said("rent") ||     said("need", "around") ||     said("go", "around") ||     said("register", "around") ||     said("register")))  {  [ if near the clerk  if (posn(ego, 25, 117, 95, 141))    {    print.at("\"Right now all the rooms are rented!\"", 2, 5, 0);    }  else    {    print("Ya need to get closer so the man can hear ya.");    }  }  [ check messagesif ((said("check", "message") ||     said("acquire", "message") ||     said("check", "note") ||     said("acquire", "note") ||     said("check", "letter") ||     said("acquire", "letter")))  {  [ if near the clerk  if (posn(ego, 25, 117, 95, 141))    {    [ if Jerrod knows about Jake's room at the hotel    if (isset(ScoreLetterClue))      {      print.at("\"If ya ain't a registered renter, ya couldn't have a "               "message!\"", 2, 5, 0);      [ if Jerrod doesn't have the message for room 11      if (!isset(HasRoom11Message))        {        [ ask Jerrod to deliver the letter        print.at("\"Oh my willikers! I nearly forgot!! I got a message to give "                 "that beggar stayin' in room 11. Would ya deliver it fer me?\"", 2, 5, 0);        [ change input prompt        set.string(inputPrompt, "Yes or no %g69");        [ force it to update now        accept.input();        inputLength = 29;        [ and wait for Jerrod to answer        vWaitForAnswer = 1;        }      }    else      {      print.at("\"Right now, you don't look like you know what yer doing, "               "stranger.\"", 2, 5, 0);      }    }  else    {    print("Ya need to get closer so the man can hear ya.");    }  }  [ look messageif ((said("examine", "message") ||     said("read", "message") ||     said("open", "message")))  {  [ if Jerrod has the message for room 11  if (has("Message for room 11"))    {    print("The message is written on a folded piece of paper with only one word "          "visible on the outside...");    print("\n CONFIDENTIAL!! \n \n");    }  else    {    print("There are messages in the boxes.");    }  }  [ look carpet/look floorif ((said("examine", "carpet") ||     said("examine", "deck")))  {  print("It's a hardwood floor covered with fine carpet.");  }  [ look mailboxif ((said("examine", "box") ||     said("examine", "message", "box") ||     said("examine", "letter") ||     said("examine", "mailbox")))  {  print("There are messages in the boxes.");  }  [ make a reservation/rent a roomif ((said("make", "reservation") ||     said("reserve", "around") ||     said("rent", "around") ||     said("want", "around") ||     said("register")))  {  [ if near the clerk  if (posn(ego, 25, 117, 95, 141))    {    print.at("\"Sorry stranger, all the rooms are either occupied or "             "reserved.\"", 2, 5, 0);    }  else    {    print("Ya need to get closer so the man can hear ya.");    }  }  [ deliver messageif ((said("deliver", "message") ||     said("deliver", "message", "eleven") ||     said("deliver", "message", "around", "eleven")))  {  [ if near the clerk  if (posn(ego, 25, 117, 95, 141))    {    print.at("The man looks puzzled and says, \"I don't know what yer talkin' "             "about.\"", 2, 5, 0);    }  else    {    print("Ya need to get closer so the man can hear ya.");    }  }  [ look counterif (said("examine", "counter"))  {  print("This is a downright fancy counter, and a fancy hotel fer that matter, "        "considerin' it's in the middle of nowhere!");  }  [ look around/look lobbyif ((said("examine", "around") ||     said("examine", "lobby") ||     said("examine", "hotel", "lobby") ||     said("examine", "hotel") ||     said("examine") ||     said("examine", "green", "pasture", "hotel") ||     said("examine", "green", "pasture")))  {  print("Yer in the lobby of the prestigious, but hardly known, Green Pastures "        "Hotel! There is a man working behind the counter.");  }  [ look wallif (said("examine", "wall"))  {  print("Ya see message boxes on the wall behind the counter.");  }  [ look stairsif (said("examine", "stair"))  {  print("The stairs lead to the rooms upstairs.");  }  [ ring bellif (said("ring", "bell"))  {  print("There's no bell 'round here!");  }  [ show anythingif ((said("show", "anyword") ||     said("show", "anyword", "anyword")))  {  print("To that, the man says, \"That's real nice stranger!\"");  }  [ leave anything/give anythingif ((said("exit", "anyword") ||     said("exit", "anyword", "anyword") ||     said("contribute", "anyword") ||     said("contribute", "anyword", "anyword")))  {  print("To that, the man says, \"I don't want it stranger!\"");  }    Done:[ if Jerrod said something that wasn't parsed (this block[ isn't necessary - ANY input will force prompt back to [ normal, so when this block is run, input is already back[ to normal)if (unknownWordNum > 0)  {  [ force input prompt back to normal  set.string(inputPrompt, "%g69");  accept.input();  inputLength = 38;  }  return();[ **************************************[ MESSAGES[ **************************************#message 1 "The man says, \"Howdy! You look like ya know what yer lookin' fer. What can I do fer ya?\""#message 2 "Ya need to get closer so the man can hear ya."#message 3 "There's a man working behind the counter."#message 4 "\"I haven't been here long, but there's no room 12 that I know of.\""#message 5 "\"Sorry fella, I just rented that room. The man didn't know how long he'd be staying.\""#message 6 "\"Oh my willikers! I nearly forgot!! I got a message to give that beggar stayin' in room 11. Would ya deliver it fer me?\""#message 7 "%g69"#message 8 "Yes or no %g69"#message 9 "\"Here's the message. Thanks, I owe ya one!\""#message 10 "Yes what?!"#message 11 "\"Keys are only fer folks rentin' a room.\""#message 12 "\"Right now all the rooms are rented!\""#message 13 "\"If ya ain't a registered renter, ya couldn't have a message!\""#message 14 "Before you leave the hotel, you give the man at the counter the message you said you would deliver to room 11."#message 15 "\"I'll do it myself!\""#message 16 "\"Later!!\""#message 17 "No what?!"#message 18 "\"Great! Hang on a second!\""#message 19 "You reply, \"No problem.\""#message 20 "This is a downright fancy counter, and a fancy hotel fer that matter, considerin' it's in the middle of nowhere!"#message 21 "Yer in the lobby of the prestigious, but hardly known, Green Pastures Hotel! There is a man working behind the counter."#message 22 "Ya see message boxes on the wall behind the counter."#message 23 "The stairs lead to the rooms upstairs."#message 24 "The message is written on a folded piece of paper with only one word visible on the outside..."#message 25 "\n CONFIDENTIAL!! \n \n"#message 28 "It's a hardwood floor covered with fine carpet."#message 29 "There are messages in the boxes."#message 30 "Ya can see message boxes behind the counter."#message 31 "Ya need to be more specific!"#message 32 "\"Sorry stranger, all the rooms are either occupied or reserved.\""#message 33 "The man looks puzzled and says, \"I don't know what yer talkin' about.\""#message 34 "Ya gone off and left yer mule outside without tyin' it up! Now yer mule is gone!"#message 35 "There's no bell 'round here!"#message 36 "To that, the man says, \"That's real nice stranger!\""#message 37 "To that, the man says, \"I don't want it stranger!\""#message 38 "\"It's written all over yer face stranger, you look lost! I don't think you have a reason to be here right now!\""#message 40 "\"Right now, you don't look like you know what yer doing, stranger.\""
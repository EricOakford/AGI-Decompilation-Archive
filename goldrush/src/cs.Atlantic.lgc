[***********************************************************[[ cs.Atlantic[[ This logic manages the cutscenes and rooms that make up[ the Cape Horn route from New York to the South Atlantic[ Ocean.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oBlock1                      o1#define oBlock2                      o2#define oBlock3                      o3#define oBlock4                      o4#define oBlock5                      o5#define oBlock6                      o6#define oBlock7                      o7#define oBlock8                      o8#define oBlock9                      o9#define oBlock10                    o10#define oBlock11                    o11#define oBlock12                    o12#define oBlock13                    o13[ o14 through o19 are not used#define oMarker                     o20[ v220 thorough v231 are not used#define vMarkerX                   v232#define vMarkerY                   v233#define vMovePoint                 v234#define vTmpVar                    v235#define vTimeCounter               v236#define vMsgCounter                v237#define fMarkerMoved               f220[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load the main timing logic  load.logics(lgc.CapeTripTiming);    [ load picture for current room  load.pic(currentRoom);    [ load view with blocking markers and cursors  load.view(vw.CapeRouteArt);    [ draw the picture  draw.pic(currentRoom);    [ use blocks to cover up the marker route; they will be  [ removed as the marker moves to show the traced route  animate.obj(oBlock1);  set.view(oBlock1, vw.CapeRouteArt);  set.loop(oBlock1, 0);  set.cel(oBlock1, 0);  position(oBlock1, 64, 25);  set.priority(oBlock1, 5);  ignore.horizon(oBlock1);  draw(oBlock1);  stop.cycling(oBlock1);  [ block 2  animate.obj(oBlock2);  set.view(oBlock2, vw.CapeRouteArt);  set.loop(oBlock2, 0);  set.cel(oBlock2, 0);  position(oBlock2, 78, 31);  set.priority(oBlock2, 5);  ignore.horizon(oBlock2);  draw(oBlock2);  stop.cycling(oBlock2);  [block 3  animate.obj(oBlock3);  set.view(oBlock3, vw.CapeRouteArt);  set.loop(oBlock3, 0);  set.cel(oBlock3, 0);  position(oBlock3, 88, 41);  set.priority(oBlock3, 5);  draw(oBlock3);  stop.cycling(oBlock3);  [ block 4  animate.obj(oBlock4);  set.view(oBlock4, vw.CapeRouteArt);  set.loop(oBlock4, 0);  set.cel(oBlock4, 0);  position(oBlock4, 96, 49);  set.priority(oBlock4, 5);  draw(oBlock4);  stop.cycling(oBlock4);  [ block 5  animate.obj(oBlock5);  set.view(oBlock5, vw.CapeRouteArt);  set.loop(oBlock5, 0);  set.cel(oBlock5, 0);  position(oBlock5, 102, 60);  set.priority(oBlock5, 5);  draw(oBlock5);  stop.cycling(oBlock5);  [ block 6  animate.obj(oBlock6);  set.view(oBlock6, vw.CapeRouteArt);  set.loop(oBlock6, 0);  set.cel(oBlock6, 0);  position(oBlock6, 110, 70);  set.priority(oBlock6, 5);  draw(oBlock6);  stop.cycling(oBlock6);  [ block 7  animate.obj(oBlock7);  set.view(oBlock7, vw.CapeRouteArt);  set.loop(oBlock7, 0);  set.cel(oBlock7, 0);  position(oBlock7, 116, 81);  set.priority(oBlock7, 5);  draw(oBlock7);  stop.cycling(oBlock7);  [ block 8  animate.obj(oBlock8);  set.view(oBlock8, vw.CapeRouteArt);  set.loop(oBlock8, 0);  set.cel(oBlock8, 0);  position(oBlock8, 121, 92);  set.priority(oBlock8, 5);  draw(oBlock8);  stop.cycling(oBlock8);  [ block 9  animate.obj(oBlock9);  set.view(oBlock9, vw.CapeRouteArt);  set.loop(oBlock9, 0);  set.cel(oBlock9, 0);  position(oBlock9, 126, 103);  set.priority(oBlock9, 5);  draw(oBlock9);  stop.cycling(oBlock9);  [ block 10  animate.obj(oBlock10);  set.view(oBlock10, vw.CapeRouteArt);  set.loop(oBlock10, 0);  set.cel(oBlock10, 0);  position(oBlock10, 130, 115);  set.priority(oBlock10, 5);  draw(oBlock10);  stop.cycling(oBlock10);  [ block 11  animate.obj(oBlock11);  set.view(oBlock11, vw.CapeRouteArt);  set.loop(oBlock11, 0);  set.cel(oBlock11, 0);  position(oBlock11, 134, 128);  set.priority(oBlock11, 5);  draw(oBlock11);  stop.cycling(oBlock11);  [ block 12  animate.obj(oBlock12);  set.view(oBlock12, vw.CapeRouteArt);  set.loop(oBlock12, 0);  set.cel(oBlock12, 0);  position(oBlock12, 138, 138);  set.priority(oBlock12, 5);  draw(oBlock12);  stop.cycling(oBlock12);  [ block 13  animate.obj(oBlock13);  set.view(oBlock13, vw.CapeRouteArt);  set.loop(oBlock13, 0);  set.cel(oBlock13, 0);  position(oBlock13, 139, 146);  set.priority(oBlock13, 5);  draw(oBlock13);  stop.cycling(oBlock13);    [ flashing marker - the marker is of a special size and  [ shape that uses the priority value of the route on the  [ picture to show the marker as a single flashing pixel  [ that moves along the trip path line  animate.obj(oMarker);  set.view(oMarker, vw.CapeRouteArt);  set.loop(oMarker, 1);  fix.loop(oMarker);  position(oMarker, 50, 24);  set.priority(oMarker, 8);  ignore.horizon(oMarker);  ignore.objs(oMarker);  draw(oMarker);  vTmpVar = 2;  step.time(oMarker, vTmpVar);  move.obj(oMarker, 63, 24, 1, fMarkerMoved);  vMovePoint = 1;    [ now show the picture  show.pic();  }  [ **************************************[ EVERY CYCLE[ **************************************[ as marker reaches each destination point, move to the next[ pointif (isset(fMarkerMoved) && vMovePoint == 1)  {  reset(fMarkerMoved);  vMovePoint = 20;  move.obj(oMarker, 68, 25, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 20)  {  reset(fMarkerMoved);  vMovePoint = 2;  move.obj(oMarker, 101, 68, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 2)  {  reset(fMarkerMoved);  vMovePoint = 3;  move.obj(oMarker, 116, 101, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 3)  {  reset(fMarkerMoved);  vMovePoint = 4;  move.obj(oMarker, 128, 140, 1, fMarkerMoved);  }if (isset(fMarkerMoved) && vMovePoint == 4)  {  reset(fMarkerMoved);  vMovePoint = 5;  move.obj(oMarker, 134, 145, 1, fMarkerMoved);  }[ when marker reaches last pointif (isset(fMarkerMoved) && vMovePoint == 5)  {  [ set flag to continue journey  set(ContinueJourney);  }  [ use marker position to determine when to erase the blocksget.posn(oMarker, vMarkerX, vMarkerY);if (vMarkerY == 25)  {  erase(oBlock1);  }if (vMarkerY == 31)  {  erase(oBlock2);  }if (vMarkerY == 41)  {  erase(oBlock3);  }if (vMarkerY == 49)  {  erase(oBlock4);  }if (vMarkerY == 60)  {  erase(oBlock5);  }if (vMarkerY == 70)  {  erase(oBlock6);  }if (vMarkerY == 81)  {  erase(oBlock7);  }if (vMarkerY == 92)  {  erase(oBlock8);  }if (vMarkerY == 103)  {  erase(oBlock9);  }if (vMarkerY == 115)  {  erase(oBlock10);  }if (vMarkerY == 128)  {  erase(oBlock11);  }if (vMarkerY == 138)  {  erase(oBlock12);  }  [ at specific points along the journey show informational[ messages, unless player has suppressed themif (posn(oMarker, 51, 24, 51, 24) && vMsgCounter == 0)  {  ++vMsgCounter;  if (!isset(HideTripMsgs))    {    print("Land has just disappeared from view. The excitement, expectation, "          "and anticipation of your journey are gone. Now you are beginning to "          "wonder just exactly what you have gotten yourself into.");    print("You have left your home and friends behind, and you wonder if you "          "will ever see them again.");    }  }if (posn(oMarker, 68, 25, 68, 25) && vMsgCounter == 1)  {  ++vMsgCounter;  if (!isset(HideTripMsgs))    {    print("It hasn't taken long, and many of the passengers are sea sick.");    print("It will take a few days before the land-lovers get their \"sea "          "legs\".");    }  }if (posn(oMarker, 85, 42, 85, 42) && vMsgCounter == 2)  {  ++vMsgCounter;  if (!isset(HideTripMsgs))    {    print("The passengers, for now at least, are quiet and keep to themselves.");    print("But, as time goes on, people meet people and have a wonderful time "          "getting acquainted.");    print("From passing ships you hear rumors about gold being discovered in "          "California.");    }  }if (posn(oMarker, 101, 58, 101, 58) && vMsgCounter == 3)  {  ++vMsgCounter;  if (!isset(HideTripMsgs))    {    print("Most travelers left with great haste, but very few left without a "          "notebook, a pen, and an ink bottle.");    print("Many passengers on board are keeping journals of the experiences "          "they have on their journey.");    print("Playing cards, singing, reading, sunning, and wrestling are other "          "popular activities.");    print("Any reading material on board was read to tatters before the journey "          "had barely begun.");    }  }if (posn(oMarker, 103, 70, 103, 70) && vMsgCounter == 4)  {  ++vMsgCounter;  if (!isset(HideTripMsgs))    {    print("The captain is relatively young as captains go, but he is a wise and "          "frugal man.");    print("The captain makes use of the Northeast trade winds through the horse "          "latitudes.");    print("He makes use of the wind and sails at every opportunity, to conserve "          "the supply of coal and to prevent wear and tear on the steam engine.");    }  }if (posn(oMarker, 121, 106, 121, 106) && vMsgCounter == 5)  {  ++vMsgCounter;  if (!isset(HideTripMsgs))    {    print("The food on board is not as bad as expected.");    print("In fact, at times it is quite tasty! (If you are really hungry!)");    print("Rations that are provided in the galley are quite safe. Very few get "          "sick from eating them.");    print("The usual fare is hard-baked biscuit, salted beef, and boiled "          "pudding once a week.");    }  }if (posn(oMarker, 128, 123, 128, 123) && vMsgCounter == 6)  {  ++vMsgCounter;  if (!isset(HideTripMsgs))    {    print("In the course of the trip various activities begin to occur on "          "board.");    print("There are debating societies, clergymen have sermons and prayer "          "meetings on Sundays, a band has formed, a ship newspaper has been "          "started and professionals on board give lectures on scientific "          "subjects.");    print("There is also a group called \"SSA\"... ");    print("Which stands for \"Sea Sickness Anonymous\".");    print("This group meets at the aft railing of the ship.");    }  }if (posn(oMarker, 132, 144, 132, 144) && vMsgCounter == 7)  {  ++vMsgCounter;  if (!isset(HideTripMsgs))    {    print("When the Northeast trade winds die down around the equator, a seaman "          "finds himself in an area called the doldrums, or calms,");    print("a place definitely disliked by crews without steam.");    print("Many a sailing ship would lie still in the water for days, even "          "weeks, waiting to take advantage of even the slightest wind.");    print("This is one of the greatest advantages of steam!");    print("While other vessels lie motionless, with smoke belching from your "          "smokestack, you press on!");    print("The captain is proud of his ship because it makes way even in the "          "calm.");    print("But he is constantly aware of the danger of having that flammable "          "material in the hold.");    }  }  [ at specific points along the trip, increment the game time[ by the number of days on the tripif (posn(oMarker, 54, 24, 54, 24) && vTimeCounter == 0)  {  vTimeCounter = 1;  GameDays  += 2;  }if (posn(oMarker, 61, 24, 61, 24) && vTimeCounter == 1)  {  vTimeCounter = 2;  GameDays  += 2;  }if (posn(oMarker, 71, 28, 71, 28) && vTimeCounter == 2)  {  vTimeCounter = 3;  GameDays  += 2;  }if (posn(oMarker, 82, 39, 82, 39) && vTimeCounter == 3)  {  vTimeCounter = 4;  GameDays  += 2;  }if (posn(oMarker, 95, 52, 95, 52) && vTimeCounter == 4)  {  vTimeCounter = 5;  GameDays  += 3;  }if (posn(oMarker, 101, 67, 101, 67) && vTimeCounter == 5)  {  vTimeCounter = 6;  GameDays  += 2;  }if (posn(oMarker, 116, 87, 116, 87) && vTimeCounter == 6)  {  vTimeCounter = 7;  GameDays  += 2;  }if (posn(oMarker, 124, 109, 124, 109) && vTimeCounter == 7)  {  vTimeCounter = 8;  GameDays  += 3;  }if (posn(oMarker, 131, 143, 131, 143) && vTimeCounter == 8)  {  vTimeCounter = 9;  GameDays  += 3;  }  [ there is no input processed in this logic, so this[ boilerplate piece of code could have been removedif (!isset(haveInput))  {  goto(Done);  }Done:[ call the main timing logic; it will handle switching [ between the different segments of the tripcall(lgc.CapeTripTiming);return();[ **************************************[ MESSAGES[ **************************************#message 1 "Land has just disappeared from view. The excitement, expectation, and anticipation of your journey are gone. Now you are beginning to wonder just exactly what you have gotten yourself into."#message 2 "You have left your home and friends behind, and you wonder if you will ever see them again."#message 10 "It hasn't taken long, and many of the passengers are sea sick."#message 11 "It will take a few days before the land-lovers get their \"sea legs\"."#message 20 "The passengers, for now at least, are quiet and keep to themselves."#message 21 "But, as time goes on, people meet people and have a wonderful time getting acquainted."#message 22 "From passing ships you hear rumors about gold being discovered in California."#message 30 "Most travelers left with great haste, but very few left without a notebook, a pen, and an ink bottle."#message 31 "Many passengers on board are keeping journals of the experiences they have on their journey."#message 32 "Playing cards, singing, reading, sunning, and wrestling are other popular activities."#message 33 "Any reading material on board was read to tatters before the journey had barely begun."#message 40 "The captain is relatively young as captains go, but he is a wise and frugal man."#message 41 "The captain makes use of the Northeast trade winds through the horse latitudes."#message 42 "He makes use of the wind and sails at every opportunity, to conserve the supply of coal and to prevent wear and tear on the steam engine."#message 50 "The food on board is not as bad as expected."#message 51 "In fact, at times it is quite tasty! (If you are really hungry!)"#message 52 "Rations that are provided in the galley are quite safe. Very few get sick from eating them."#message 53 "The usual fare is hard-baked biscuit, salted beef, and boiled pudding once a week."#message 60 "In the course of the trip various activities begin to occur on board."#message 61 "There are debating societies, clergymen have sermons and prayer meetings on Sundays, a band has formed, a ship newspaper has been started and professionals on board give lectures on scientific subjects."#message 62 "There is also a group called \"SSA\"... "#message 63 "Which stands for \"Sea Sickness Anonymous\"."#message 64 "This group meets at the aft railing of the ship."#message 70 "When the Northeast trade winds die down around the equator, a seaman finds himself in an area called the doldrums, or calms,"#message 71 "a place definitely disliked by crews without steam."#message 72 "Many a sailing ship would lie still in the water for days, even weeks, waiting to take advantage of even the slightest wind."#message 73 "This is one of the greatest advantages of steam!"#message 74 "While other vessels lie motionless, with smoke belching from your smokestack, you press on!"#message 75 "The captain is proud of his ship because it makes way even in the calm."#message 76 "But he is constantly aware of the danger of having that flammable material in the hold."
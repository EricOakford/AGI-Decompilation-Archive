[***********************************************************[[ rm.NewsPaperOffice[[ This is the home of the Brooklyn Evening Star. Jerrod [ works here. There are a few clues/points to earn inside. [ Outside, Jerrod may run into the grocery store clerk, the[ midget who runs the livery, or the sophisticted Brooklyn[ lady.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oDoor                        o1#define oPedestrian                  o2#define vPedStatus                 v220#define vPedDist                   v221#define vPedX                      v222#define vPedY                      v223#define fDoorOpen                  f220#define fDoorMoved                 f221#define fPedMoved                  f222[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load, draw and discard the current room picture  load.pic(currentRoom);  draw.pic(currentRoom);  discard.pic(currentRoom);    [ load views with art to be added to the picture  load.view(vw.SkylineArt);  load.view(vw.CityArt);  [ add skyline art  add.to.pic(vw.SkylineArt, 0, 9, 140, 52, 4, 4);  [ add 'office' sign to front of building  add.to.pic(vw.CityArt, 0, 0, 38, 62, 10, 10);  [ skyline art not needed anymore (this also discards   [ vw.CityArt)  discard.view(vw.SkylineArt);    [ load views used in the room  load.view(vw.JerrodNY);  load.view(vw.NewsOfficeArt);  load.view(vw.GrocerClerk);  load.view(vw.Midget);  load.view(vw.Lady2D);    [ add the interior of office (behind the door)  add.to.pic(vw.NewsOfficeArt, 1, 0, 46, 99, 7, 7);    [ the door to the office  animate.obj(oDoor);  set.view(oDoor, vw.NewsOfficeArt);  set.loop(oDoor, 0);  ignore.objs(oDoor);  [ if coming from inside the office  if (previousRoom == rm.PaperOfficeInterior)    {    [ show the door open    set.cel(oDoor, 3);    set(fDoorOpen);    }  else    {    [ not coming from the office - show door closed    set.cel(oDoor, 0);    }  position(oDoor, 46, 99);  set.priority(oDoor, 8);  draw(oDoor);  stop.update(oDoor);    [ the pedestrian, can be one of three different people  animate.obj(oPedestrian);  [ pedestrian begins off screen  vPedStatus = 10;    [ Jerrod, in his normal Brooklyn attire  [ (setting the view BEFORE animating the object will work  [ without causing an error, but it's not good programming  [ practice; you should always animate the object before  [ making changes, because not all parameters work  [ correctly if changed before animation is initialized)  set.view(ego, vw.JerrodNY);  animate.obj(ego);    [ adjust Jerrod's position, depending on which room he  [ came from  if (previousRoom == rm.PostOffice)    {    if (posn(ego, 0, 35, 74, 40))      {      position(ego, 127, 96);      }    if (posn(ego, 75, 35, 127, 40))      {      position(ego, 142, 96);      }    }  if (previousRoom == rm.CemeteryEntrance)    {    position(ego, 89, 166);    }  if (previousRoom == rm.PaperOfficeInterior)    {    position(ego, 49, 102);    }  if (previousRoom == rm.Livery)    {    if (posn(ego, 74, 30, 160, 40))      {      position(ego, 2, 166);      }    }    [ add Jerrod to the picture  draw(ego);    [ now show the picture  show.pic();  }  [ **************************************[ EVERY CYCLE[ **************************************[ if Jerrod is just inside the door of the buildingif (posn(ego, 46, 91, 59, 91))  {  [ set door priority so it draws correctly  set.priority(oDoor, 9);    [ this appears to be a minor bug - there is no  [ corresponding code that will return priority to 8 when  [ Jerrod leaves the area near the door  }  [ if Jerrod is on an alarm line, and door is NOT openif (isset(egoHitSpecial) && !isset(fDoorOpen))  {  [ allow door to update  start.update(oDoor);  [ temporarily halt Jerrod while door is opening  stop.update(ego);  [ open the door  end.of.loop(oDoor, fDoorMoved);  set(fDoorOpen);  }  [ if Jerrod is NOT on alarm line, and door is openif (!isset(egoHitSpecial) && isset(fDoorOpen))  {  [ close it  start.update(oDoor);  reverse.loop(oDoor, fDoorMoved);  reset(fDoorOpen);  }  [ if door is done closing/openingif (isset(fDoorMoved))  {  [ stop the door  stop.update(oDoor);  [ allow Jerrod to continue moving  start.update(ego);  [ no need to use start.cycling; the start.update command  [ already enables the object for cycling  start.cycling(ego);  [ if Jerrod is not in the entrance (not sure why they have  [ this check here; it seems uncessary - the effect is that  [ when Jerrod is near the door and it finishes opening,   [ this block of code will run in every cycle until Jerrod  [ either goes back down the stairs, or enters the building  [ but once door finishes moving, this block only needs to  [ be run once, so checking Jerrod's position is completely  [ unnecessary)  if (!posn(ego, 48, 80, 59, 91))    {    [ reset door moved flag    reset(fDoorMoved);    }  }  [ if pedestrian is not on screenif (vPedStatus > 9)  {  [ if gold rush is public knowledge  if (isset(RushIsPublic))    {    [ random chance pedestrian comes back (one in 76)    random(25, 100, vPedStatus);    }  else    {    [ chance of pedestrian is less likely before gold rush    [ is made public (one in 216 chance)     random(25, 240, vPedStatus);    }  [ if pedestrian is ready to appear  if (vPedStatus == 77)    {    [ if gold rush is public knowledge    if (isset(RushIsPublic))      {      [ choose one of two pedestrians (grocery clerk does      [ not appear once gold rush is public)      random(0, 1, vPedStatus);      }    else      {      [ choose one of three pedestrians      random(0, 2, vPedStatus);      }    if (vPedStatus == 0)      {      set.view(oPedestrian, vw.Lady2D);      }    if (vPedStatus == 1)      {      set.view(oPedestrian, vw.Midget);      }    if (vPedStatus == 2)      {      set.view(oPedestrian, vw.GrocerClerk);      }          [ choose a random starting location    random(0, 1, vPedStatus);    if (vPedStatus == 0)      {      set.loop(oPedestrian, 1);      position(oPedestrian, 117, 167);      draw(oPedestrian);      move.obj(oPedestrian, 92, 141, 1, fPedMoved);      [ next destination is point 3      vPedStatus = 3;      }    if (vPedStatus == 1)      {      set.loop(oPedestrian, 0);      position(oPedestrian, 0, 141);      draw(oPedestrian);      move.obj(oPedestrian, 92, 141, 1, fPedMoved);      [ next destination is point 4      vPedStatus = 4;      }    }  }  [ when pedestrian reaches 'point 4'if (isset(fPedMoved) && vPedStatus == 4)  {  [ next destination is 'point 5'  reset(fPedMoved);  vPedStatus = 5;  move.obj(oPedestrian, 117, 167, 1, fPedMoved);  }  [ when pedestrian reaches 'point 3'if (isset(fPedMoved) && vPedStatus == 3)  {  [ next destination is 'point 6'  reset(fPedMoved);  move.obj(oPedestrian, 0, 141, 1, fPedMoved);  vPedStatus = 6;  }  [ when pedestrian reaches 'point 5'if (isset(fPedMoved) && vPedStatus == 5)  {  [ remove pedestrian from sceen  reset(fPedMoved);  vPedStatus = 10;  erase(oPedestrian);  }  [ when pedestrian reaches 'point 6'if (isset(fPedMoved) && vPedStatus == 6)  {  [ remove pedestrian from screen  reset(fPedMoved);  vPedStatus = 10;  erase(oPedestrian);  }  [ get pedestrian's current locationget.posn(oPedestrian, vPedX, vPedY);[ if pedestrian has not movedif (OldObj1X == vPedX && OldObj1Y == vPedY)  {  [ stop cycling when not moving  stop.cycling(oPedestrian);  }else  {  [ cycle when moving  start.cycling(oPedestrian);  }[ save pedestrian's current locationOldObj1X = vPedX;OldObj1Y = vPedY;[ **************************************[ CHECK FOR AN EXIT CONDITION[ **************************************[ going up leads to the post office exteriorif (posn(ego, 100, 94, 159, 94))  {  new.room(rm.PostOffice); [ ##LE001##  }  [ if in the doorway to paper office, and door is done movingif (posn(ego, 48, 80, 59, 91) && isset(fDoorMoved))  {  new.room(rm.PaperOfficeInterior); [ ##LE002##  }  [ if left or bottom edge hit, go to appropriate roomif (edgeEgoHit != NOT_HIT)  {  if (edgeEgoHit == LEFT_EDGE)    {    new.room(rm.Livery); [ ##LE003##    }  if (edgeEgoHit == BOTTOM_EDGE)    {    new.room(rm.CemeteryEntrance); [ ##LE004##    }  }  [ **************************************[ PROCESS PLAYER INPUT[ **************************************[ if player hasn't provided input no need to do said testsif (!isset(haveInput))  {  goto(Done);  }[ look building  [ (lots of ways to say 'look at building')if ((said("examine", "brooklyn", "evening", "star", "business", "office") ||     said("examine", "brooklyn", "evening", "star", "business") ||     said("examine", "brooklyn", "evening", "star", "office") ||     said("examine", "brooklyn", "evening", "business", "office") ||     said("examine", "brooklyn", "evening", "business") ||     said("examine", "brooklyn", "evening", "office") ||     said("examine", "brooklyn", "star", "business", "office") ||     said("examine", "brooklyn", "star", "business") ||     said("examine", "brooklyn", "star", "office") ||     said("examine", "brooklyn", "star") ||     said("examine", "evening", "star", "business", "office") ||     said("examine", "evening", "star", "business") ||     said("examine", "evening", "star", "office") ||     said("examine", "evening", "star") ||     said("examine", "star", "business", "office") ||     said("examine", "star", "business") ||     said("examine", "star", "office") ||     said("examine", "star") ||     said("examine", "building") ||     said("read", "building") ||     said("examine", "newspaper", "office") ||     said("examine", "office") ||     said("examine", "business", "office")))  {  print("As a child you visited this building often. You wanted to learn "        "everything you could about the newspaper business.");  }  [ look windowif (said("examine", "glass"))  {  print("There is nothing unusual about these windows.");  }  [ look streetlampif (said("examine", "lamp"))  {  print("There are streetlights all over town.");  }  [ look/look aroundif ((said("examine") || said("examine", "around")))  {  print("You are outside of the business office of the Brooklyn Evening Star.");  }  [ look roadif ((said("examine", "path") || said("examine", "anyword", "path")))  {  print("Fulton Street and Front Street intersect here.");  }  [ open doorif (said("open", "door"))  {  print("Just walk up to it.");  }  [ climb stairif (said("climb", "stair"))  {  print("Just walk up to it.");  }    [ look manif (said("examine", "boy"))  {  [ get distance to pedestrian  distance(ego, oPedestrian, vPedDist);  [ if close enough  if (vPedDist < 60)    {    [ use view number to determine response    current.view(oPedestrian, vPedDist);    if (vPedDist == vw.GrocerClerk)      {      print("There goes the young man from the grocery store.");      }    if (vPedDist == vw.Midget)      {      print("There is the midget you see around the livery.");      }    if (vPedDist == vw.Lady2D)      {      [ surpisingly, this room let's you say 'look at man'      [ when the lady is present; in rm.Bank, the code checks      [ for this, and gives a message  of "I beg your pardon,      [ sir. I'm a lady."      print("This is another of Brooklyn's beautiful ladies!");      }    }  else    {    [ if pedestrian is not on screen    if (vPedDist == 255)      {      print("There is no one around.");      }    else      {      [ check for man or woman      current.view(oPedestrian, vPedDist);      if (vPedDist == vw.Lady2D)        {        print("You see a lady in the distance.");        }      else        {        print("You see a man in the distance.");        }      }    }  }  [ speak to man (even if it's the lady!)if ((said("speak", "boy") || said("speak")))  {  [ get distance to pedestrian  distance(ego, oPedestrian, vPedDist);  [ if close enough  if (vPedDist < 40)    {    [ use view to determine response    current.view(oPedestrian, vPedDist);    if (vPedDist == vw.GrocerClerk)      {      print("The young man from the grocery store says, \"It's a beautiful day! "            "Isn't it, sir?\"");      }    if (vPedDist == vw.Midget)      {      print("The short man from the livery says, \"Drop by the livery "            "sometime.\"");      }    if (vPedDist == vw.Lady2D)      {      print("The sophisticated Brooklyn lady says, \"Hi, Jerrod! I thought a "            "strong, smart, young man like you would have already been gone to "            "California!\"");      }    }  else    {    [ if pedestrian is not on screen    if (vPedDist == 255)      {      print("There is no one around.");      }    else      {      print("You are not close enough.");      }    }  }  [ look lady (this response does distinguish between men and[ women, unlike the 'look man' input)if (said("examine", "girl"))  {  [ get distance to pedestrian  distance(ego, oPedestrian, vPedDist);  [ if close enough  if (vPedDist < 60)    {    [ use view to determine response    current.view(oPedestrian, vPedDist);    if (vPedDist == vw.GrocerClerk)      {      print("The man says, \"I beg your pardon!\"");      }    if (vPedDist == vw.Midget)      {      print("The midget says, \"I'm not a %w2, shorty!\"");      }    if (vPedDist == vw.Lady2D)      {      print("This is another of Brooklyn's beautiful ladies!");      }    }  else    {    [ if pedestrian is not on screen    if (vPedDist == 255)      {      print("There is no one around.");      }    else      {      current.view(oPedestrian, vPedDist);      if (vPedDist == vw.Lady2D)        {        print("You see a lady in the distance.");        }      else        {        print("You see a man in the distance.");        }      }    }  }  [ talk to lady (this response does distinguish between men[ and women, unlike the 'talk man' input)if (said("speak", "girl"))  {  [ get distance to pedestrian  distance(ego, oPedestrian, vPedDist);  [ if close enough  if (vPedDist < 40)    {    [ use view to determine response    current.view(oPedestrian, vPedDist);    if (vPedDist == vw.GrocerClerk)      {      print("The man says, \"I beg your pardon!\"");      }    if (vPedDist == vw.Midget)      {      print("The midget says, \"I'm not a %w2, shorty!\"");      }    if (vPedDist == vw.Lady2D)      {      print("The sophisticated Brooklyn lady says, \"Hi, Jerrod! I thought a "            "strong, smart, young man like you would have already been gone to "            "California!\"");      }    }  else    {    [ if pedestrian is off screen    if (vPedDist == 255)      {      print("There is no one around.");      }    else      {      print("You are not close enough.");      }    }  }  [ look grassif (said("examine", "grass"))  {  print("You can see this lawn from your office window.");  }  [ look fenceif (said("examine", "fence"))  {  print("The fence surrounds this nice yard.");  }  [ look post officeif (said("examine", "post office"))  {  print("The post office is behind the Brooklyn Evening Star business office.");  }  [ look stairsif (said("examine", "stair"))  {  print("The stairs lead to the front door of the newspaper office.");  }  Done:return();[ **************************************[ MESSAGES[ **************************************#message 1 "As a child you visited this building often. You wanted to learn everything you could about the newspaper business."#message 2 "There is nothing unusual about these windows."#message 4 "There are streetlights all over town."#message 5 "You are outside of the business office of the Brooklyn Evening Star."#message 6 "Fulton Street and Front Street intersect here."#message 9 "Just walk up to it."#message 10 "There goes the young man from the grocery store."#message 11 "There is the midget you see around the livery."#message 12 "This is another of Brooklyn's beautiful ladies!"#message 13 "There is no one around."#message 14 "You see a lady in the distance."#message 15 "You see a man in the distance."#message 16 "The young man from the grocery store says, \"It's a beautiful day! Isn't it, sir?\""#message 17 "The short man from the livery says, \"Drop by the livery sometime.\""#message 18 "The sophisticated Brooklyn lady says, \"Hi, Jerrod! I thought a strong, smart, young man like you would have already been gone to California!\""#message 19 "You are not close enough."#message 20 "The man says, \"I beg your pardon!\""#message 21 "The midget says, \"I'm not a %w2, shorty!\""#message 22 "You can see this lawn from your office window."#message 23 "The fence surrounds this nice yard."#message 24 "The post office is behind the Brooklyn Evening Star business office."#message 25 "The stairs lead to the front door of the newspaper office."
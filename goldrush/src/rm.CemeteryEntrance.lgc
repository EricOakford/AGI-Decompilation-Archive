[***********************************************************[[ rm.CemeteryEntance[[ This room leads to the cemetery, where Jerrod can visit[ his parents' graves.[[***********************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define oSteamship                   o1#define vShipCycle                 v220#define fBehindHill                f220#define fShipStart                 f221#define fShipMoved                 f222[ f223 - f225 are not used#define fShipVisible               f226[ **************************************[ FIRST CYCLE ONLY[ **************************************if (isset(newRoom))  {  [ load picture for current room  load.pic(currentRoom);    [ load views used in the room  load.view(vw.JerrodNY);  load.view(vw.DyingJerrodNY);  load.view(vw.SkylineArt);  load.view(vw.StmShipSmall);    [ this sound is loaded, but is never used  load.sound(s.UhOh);    [draw the picture, and add appropriate city skyline art  draw.pic(currentRoom);  add.to.pic(vw.SkylineArt, 0, 3, 0, 59, 4, 4);  add.to.pic(vw.SkylineArt, 0, 4, 20, 59, 4, 4);  add.to.pic(vw.SkylineArt, 0, 5, 40, 59, 4, 4);  add.to.pic(vw.SkylineArt, 0, 6, 60, 59, 4, 4);  add.to.pic(vw.SkylineArt, 0, 7, 80, 59, 4, 4);  add.to.pic(vw.SkylineArt, 0, 8, 100, 59, 4, 4);  add.to.pic(vw.SkylineArt, 0, 9, 120, 59, 4, 4);  add.to.pic(vw.SkylineArt, 0, 10, 140, 59, 4, 4);    [ if the ship has NOT sailed yet,  if (!isset(ShipSailed))    {    [ add it to screen, using small view (it's way off in    [ the distance)    animate.obj(oSteamship);    set.view(oSteamship, vw.StmShipSmall);    set.loop(oSteamship, 0);    fix.loop(oSteamship);    ignore.horizon(oSteamship);    ignore.objs(oSteamship);    ignore.blocks(oSteamship);    set.priority(oSteamship, 4);    position(oSteamship, 36, 70);    draw(oSteamship);    stop.update(oSteamship);    [ ship is visible, until it leaves    set(fShipVisible);    }    [ Jerrod, in normal Brooklyn attire  animate.obj(ego);  set.view(ego, vw.JerrodNY);    [ adjust Jerrod's position, based on which room he came  [ from  if (previousRoom == rm.NewspaperOffice)    {    position(ego, 40, 100);    [ there are no conditional control lines, nor any    [ block() commands used in this room, so ignoring or    [ observing blocks does nothing; it may be that at one    [ time there was something in the room that used blocks    [ to handle Jerrod's movement/positioning in this room    [ that was later removed    ignore.blocks(ego);    }  if (previousRoom == rm.Cemetery)    {    if (posn(ego, 150, 144, 159, 151))      {      position(ego, 152, 143);      }    if (posn(ego, 150, 121, 159, 127))      {      position(ego, 152, 120);      }    [ this command has no effect in this room (no    [ conditional control lines or block commands)    ignore.blocks(ego);    }      [ draw Jerrod on screen  draw(ego);    [ now show the picture  show.pic();  }[ **************************************[ EVERY CYCLE[ **************************************[ if Jerrod is behind the hill (on path to town) his motion[ needs to be adjusted to give illusion of going up/down the[ hill, which is actually opposite of normal ego motionif (isset(fBehindHill))  {  [ convert DOWN_RIGHT to UP_RIGHT  if (egoDir == DOWN_RIGHT)    {    egoDir = UP_RIGHT;    [ allow loop to be selected automatically    release.loop(ego);    }  else    {    [ convert DOWN to UP    if (egoDir == DOWN)      {      egoDir = UP;      [ but force loop to show ego moving to back      set.loop(ego, 2);      fix.loop(ego);      }    else      {      [ convert DOWN_LEFT to UP_LEFT      if (egoDir == DOWN_LEFT)        {        egoDir = UP_LEFT;        [ allow loop to be selected automatically        release.loop(ego);        }      else        {        [ convert UP_RIGHT to DOWN_RIGHT         if (egoDir == UP_RIGHT)          {          egoDir = DOWN_RIGHT;          [ allow loop to be selected automatically          release.loop(ego);          }        [ convert UP to DOWN        if (egoDir == UP)          {          egoDir = DOWN;          [ but force loop to show ego moving toward front          set.loop(ego, 3);          fix.loop(ego);          }        [ convert UP_LEFT to DOWN_LEFT        if (egoDir == UP_LEFT)          {          egoDir = DOWN_LEFT;          [ allow loop to be selected automatically          release.loop(ego);          }        if ((egoDir == LEFT || egoDir == RIGHT))          {          [ if just right or left, only need to          [ allow loop to be selected automatically          release.loop(ego);          }        }      }    }  }  [ if Jerrod is one pixel below top of hill AND behind-hill[ flag is not setif (posn(ego, 19, 99, 51, 99) && !isset(fBehindHill))  {  [ allow loop to cycle normally as Jerrod is on the near  [ side of the hill  release.loop(ego);  }[ if Jerrod is at the very top of the hill, and the behind-[ hill flag is setif (posn(ego, 20, 98, 50, 98) && isset(fBehindHill))  {  [ he's no longer behind the hill;  reset(fBehindHill);  [ restore automatic priority assignment  release.priority(ego);  [ this command has no effect in this room (no blocks or  [ conditional control lines)  ignore.blocks(ego);  [ bump Jerrod down one pixel so he doesn't stay stuck at  [ the top of the hill  TmpX = 0;  TmpY = 1;  reposition(ego, TmpX, TmpY);  }else  {  [ if Jerrod is at very top of the hill, and the behind-  [ hill flag is NOT set  if (posn(ego, 20, 98, 50, 98) && !isset(fBehindHill))    {    [ move Jerrod behind the hill    set(fBehindHill);    [ force priority so Jerrod will appear behind the hill    [ as he moves toward town    set.priority(ego, 5);    [ this command has no effect in this room (no blocks or    [ conditional control lines)    observe.blocks(ego);    [ bump Jerrod down one pixel so he doesn't stay stuck at    [ the top of the hill    TmpX = 0;    TmpY = 1;    reposition(ego, TmpX, TmpY);    }  }  [ if the ship is sailing, but hasn't moved yet in this roomif (isset(ShipSailed) && !isset(fShipStart))  {  [ begin moving the ship  set(fShipStart);  start.update(oSteamship);  [ move it to right, until it goes completely behind the  [ the landscape  move.obj(oSteamship, 94, 70, 1, fShipMoved);  vShipCycle = 8;  step.time(oSteamship, vShipCycle);  }[ when ship reaches its destinationif (isset(fShipMoved))  {  [ reset the flag  reset(fShipMoved);  [ remove ship from screen  erase(oSteamship);  [ and mark it as no longer visible here  reset(fShipVisible);  }[ **************************************[ CHECK FOR AN EXIT CONDITION[ **************************************[ if on path to townif (posn(ego, 24, 99, 57, 99))  {  new.room(rm.NewspaperOffice); [ ##LE001##  }if (edgeEgoHit == RIGHT_EDGE)  {  new.room(rm.Cemetery); [ ##LE002##  }  [ **************************************[ PROCESS PLAYER INPUT[ **************************************[ if player hasn't provided input no need to do said testsif (!isset(haveInput))  {  goto(Done);  }  [ read tombstoneif ((said("read", "gravestone") ||     said("read", "grave") ||     said("read", "rock") ||     said("read", "word") ||     said("examine", "word")))  {  [ response depends on which grave Jerrod is closest to  if ((posn(ego, 89, 81, 105, 91) ||       posn(ego, 132, 72, 153, 83) ||       posn(ego, 99, 96, 115, 106) ||       posn(ego, 119, 96, 138, 107) ||       posn(ego, 85, 146, 101, 167) ||       posn(ego, 102, 146, 120, 167) ||       posn(ego, 121, 146, 139, 167) ||       posn(ego, 140, 146, 159, 167) ||       posn(ego, 146, 84, 159, 99) ||       posn(ego, 139, 107, 159, 120)))    {    if (posn(ego, 89, 81, 105, 91))      {      print("       Resting in \n        this sod\n\n     Caleb Fletcher\n\n  "            "Who casually drowned\n         in the \n    Scungamug River\non "            "the 17th day of July\n         Age 47\n");      }    if (posn(ego, 132, 72, 153, 83))      {      print("    Beneath this\n      monument\nlies what remains of\n\n   "            "Benjamin Malone\n\n  Tragically taken \n   from this world\n   by "            "a wild horse\n        Age 32\n");      }    if (posn(ego, 99, 96, 115, 106))      {      print("    Under this stone\n    rest the decaying\n       remains of "            "\n\n      Harry Hartwig\n\nwho was born in New Haven\nand for the "            "last 20 years\n    of his life was a \n   respected inhabitant\n   "            "    of this town\n");      }    if (posn(ego, 119, 96, 138, 107))      {      print("    In Memory of\n\n       Joanna\n\nwho should have been\n    the "            "wife of\n  Jackson Porter\n\n Died in the 70th\n  year of her "            "age\n");      }    if (posn(ego, 85, 146, 101, 167))      {      print("      Here lies\nthe entombed body of\n\n    Tara Knowles\n\n  "            "Died in the 63rd\n   year of her age\n    May 5, 1839\n");      }    if (posn(ego, 102, 146, 120, 167))      {      print("  Here lies the\n  body of widow\n\nElizabeth Norwood\n\n\n  "            "Asleep in Dust\n\n");      }    if (posn(ego, 146, 84, 159, 99))      {      print("\n         In memory of \n     Capt. Thomas Stetson \nWho was "            "killed by the fall of     a tree Nov. 28, 1820 \n\nNearly 30 years "            "he was master  of a vessel and left that \n   employment at the "            "age of \n  48 for the less hazardous \n one of cultivating his "            "farm. \n   Man is never secure from \n     the arrest of death. \n");      }    if (posn(ego, 121, 146, 139, 167))      {      print("     Here lies\n as silent as clay\n\n     Ima Tyler\n\nSilence "            "was broken\n   Dec. 3, 1782\n\n   Silent since\n   Feb. 20, 1827\n");      }    if (posn(ego, 140, 146, 159, 167))      {      print("    Here lies\nIn a perfect state\n   of oblivion\n\n   Daniel "            "Riley\n\n     Who died\n February 2, 1829\n      Age 52\n");      }    if (posn(ego, 139, 107, 159, 120))      {      print("\n Here lie the \n  remains of \n\nHumphrey York \n 1790 - 1839 "            "\n\nI don't know \n how to die \n");      }    }  else    {    print("From here you cannot read a tombstone!");    }  }  [ look tombstoneif ((said("examine", "gravestone") ||     said("examine", "grave") ||     said("examine", "rock")))  {  print("This cemetery is filled with many tombstones.");  }  [ look Brooklyn/look {any building in Brooklyn}if ((said("examine", "brooklyn") ||     said("examine", "bank") ||     said("examine", "brooklyn", "bank") ||     said("examine", "post office") ||     said("examine", "warehouse") ||     said("examine", "city") ||     said("examine", "building") ||     said("examine", "scene") ||     said("scene") ||     said("acquire", "scene")))  {  print("You have a beautiful view of Brooklyn including the post office, bank "        "and warehouse.");  }  [ look river/look across riverif ((said("examine", "water") ||     said("examine", "east river") ||     said("examine", "creek") ||     said("examine", "ocean") ||     said("examine", "new york") ||     said("examine", "across") ||     said("examine", "across", "water") ||     said("examine", "across", "east river") ||     said("examine", "across", "creek") ||     said("examine", "across", "ocean")))  {  print("Across the East River is New York City.");  }  [ look fence/look brick wallif ((said("examine", "fence") ||     said("examine", "brick", "fence") ||     said("examine", "wall") ||     said("examine", "brick", "wall") ||     said("examine", "brick")))  {  print("The brick wall surrounds the cemetery.");  }  [ look treeif (said("examine", "forest"))  {  print("Trees surround the cemetery.");  }  [ look grassif (said("examine", "grass"))  {  print("The grass is well-clipped.");  }  [ look roadif (said("examine", "path"))  {  print("This is a dirt path.");  }  [ look/look around/look cemeteryif ((said("examine") ||     said("examine", "around") ||     said("examine", "cemetery")))  {  print("Although it is painful, you visit the cemetery occasionally. You have "        "loved ones buried here.");  }  [ look sign/read signif ((said("examine", "sign") ||     said("read", "sign") ||     said("examine", "iron") ||     said("read", "iron") ||     said("examine", "iron", "sign") ||     said("read", "iron", "sign")))  {  print("The sign reads \"Greenwood,\" but that's not important.");  }  [ look shipif (said("examine", "boat"))  {  [ if ship is on the move  if (isset(ShipSailed))    {    [ if still visible    if (isset(fShipVisible))      {      print("There goes the ship to California!");      }    else      {      print("The ship is gone.");      }    }  else    {    print("The ship is preparing for departure.");    }  }[ look crossif (said("examine", "cross"))  {  print("Many of the tombstones have crosses on them.");  }Done:return();[ **************************************[ MESSAGES[ **************************************#message 3 "From here you cannot read a tombstone!"#message 7 "       Resting in \n        this sod\n\n     Caleb Fletcher\n\n  Who casually drowned\n         in the \n    Scungamug River\non the 17th day of July\n         Age 47\n"#message 8 "    Beneath this\n      monument\nlies what remains of\n\n   Benjamin Malone\n\n  Tragically taken \n   from this world\n   by a wild horse\n        Age 32\n"#message 9 "    Under this stone\n    rest the decaying\n       remains of \n\n      Harry Hartwig\n\nwho was born in New Haven\nand for the last 20 years\n    of his life was a \n   respected inhabitant\n       of this town\n"#message 10 "    In Memory of\n\n       Joanna\n\nwho should have been\n    the wife of\n  Jackson Porter\n\n Died in the 70th\n  year of her age\n"#message 11 "      Here lies\nthe entombed body of\n\n    Tara Knowles\n\n  Died in the 63rd\n   year of her age\n    May 5, 1839\n"#message 12 "  Here lies the\n  body of widow\n\nElizabeth Norwood\n\n\n  Asleep in Dust\n\n"#message 13 "\n         In memory of \n     Capt. Thomas Stetson \nWho was killed by the fall of     a tree Nov. 28, 1820 \n\nNearly 30 years he was master  of a vessel and left that \n   employment at the age of \n  48 for the less hazardous \n one of cultivating his farm. \n   Man is never secure from \n     the arrest of death. \n"#message 14 "     Here lies\n as silent as clay\n\n     Ima Tyler\n\nSilence was broken\n   Dec. 3, 1782\n\n   Silent since\n   Feb. 20, 1827\n"#message 15 "    Here lies\nIn a perfect state\n   of oblivion\n\n   Daniel Riley\n\n     Who died\n February 2, 1829\n      Age 52\n"#message 16 "\n Here lie the \n  remains of \n\nHumphrey York \n 1790 - 1839 \n\nI don't know \n how to die \n"#message 18 "You have a beautiful view of Brooklyn including the post office, bank and warehouse."#message 19 "Across the East River is New York City."#message 22 "The brick wall surrounds the cemetery."#message 23 "Trees surround the cemetery."#message 24 "The grass is well-clipped."#message 25 "This is a dirt path."#message 30 "Although it is painful, you visit the cemetery occasionally. You have loved ones buried here."#message 31 "The sign reads \"Greenwood,\" but that's not important."#message 40 "The ship is preparing for departure."#message 41 "There goes the ship to California!"#message 42 "Many of the tombstones have crosses on them."#message 43 "This cemetery is filled with many tombstones."#message 44 "The ship is gone."
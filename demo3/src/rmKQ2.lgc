#define roomState v225if (isset(newRoom))  {  set.text.attribute(WHITE, BLACK);  v220 = 1;  work = 82;  load.pic(work);  load.view(vKQEgo);  load.view(vCastleDoors);  load.view(vCastleFlags);  load.view(vEgoGroom);  load.view(vValBride);  load.sound(mKQ2Title);  load.sound(mLoveTheme);  work = 85;  load.pic(work);  load.view(vLionRoar);  load.view(vLionEatEgo);  load.sound(sRoar);  load.sound(mKQDeath);  work = 84;  load.pic(work);  load.view(vDracCoffin);  load.view(vDracula);  load.sound(mKQ2BadGuy);  work = 83;  load.pic(work);  load.view(vMermaid);  load.view(vMermaidDive);  load.view(vEgoSeahorseDive);  load.sound(mMermaid);  work = 81;  load.pic(work);  load.view(vTitleEgoBow);  load.view(vTitleEgo);  set(f222);  animationInterval = 2;  }if (v220 == 1)  {  if (isset(f222))    {    reset(f222);    work = 81;    draw.pic(work);    v221 = 1;    sound(mKQ2Title, f232);    show.pic();    animate.obj(o1);    set.view(o1, vTitleEgo);    position(o1, 0, 160);    work = 1;    cycle.time(o1, work);    work = 3;    step.size(o1, work);    set.cel(o1, 0);    draw(o1);    display(22, 0, "King's Quest II - Romancing The Throne\n     (c) 1987 "            "Sierra On-Line, Inc.");    }  if (v221 == 1)    {    move.obj(o1, 76, 160, 0, f220);    }  if (isset(f220))    {    set.view(o1, vTitleEgoBow);    set.cel(o1, 0);    end.of.loop(o1, f223);    reset(f220);    ++v221;    }  if (isset(f223))    {    reverse.loop(o1, f224);    reset(f223);    }  if (isset(f224))    {    set.view(o1, vTitleEgo);    start.cycling(o1);    move.obj(o1, 140, 160, 0, f221);    reset(f224);    }  if (isset(f221))    {    erase(o1);    work = 81;    discard.pic(work);    reset(f220);    reset(f221);    ++v220;    set(f222);    }  }if (v220 == 2)  {  if (isset(f222))    {    reset(f222);    work = 82;    draw.pic(work);    animate.obj(o2);    set.view(o2, vCastleFlags);    ignore.horizon(o2);    position(o2, 116, 17);    draw(o2);    animate.obj(o3);    set.view(o3, vCastleDoors);    position(o3, 105, 119);    set.cel(o3, 0);    draw(o3);    stop.cycling(o3);    ignore.objs(o1);    set.view(o1, vKQEgo);    set.loop(o1, 2);    set.cel(o1, 0);    work = 1;    step.size(o1, work);    cycle.time(o1, work);    show.pic();    v224 = 0;    clear.lines(22, 24, BLACK);    display(22, 0, "Return to Daventry for the second\nchapter of the King's "            "Quest saga.\nYour Quest:  Find a princess.");    v223 = 20;    }  if (v223 != 0)    {    --v223;    }  if (v223 == 1)    {    set(f225);    v223 = 0;    }  if (isset(f225))    {    reset(f225);    work = 4;    cycle.time(o3, work);    end.of.loop(o3, f226);    }  if (isset(f226))    {    reset(f226);    position(o1, 113, 116);    draw(o1);    set(f220);    }  if (v224 == 1)    {    move.obj(o1, 113, 149, 1, f220);    reverse.loop(o3, f227);    }  if (v224 == 2)    {    move.obj(o1, 57, 149, 1, f220);    }  if (v224 == 3)    {    move.obj(o1, 40, 132, 1, f220);    }  if (v224 == 4)    {    move.obj(o1, 0, 132, 1, f220);    }  if (v224 == 5)    {    erase(o1);    reset(f220);    if (isset(f232))      {      ++v220;      set(f222);      }    }  if (isset(f220))    {    ++v224;    }  }if (v220 == 3)  {  if (isset(f222))    {    reset(f222);    work = 83;    draw.pic(work);    animate.obj(o4);    set.view(o4, vMermaid);    set.priority(o4, 15);    ignore.horizon(o4);    work = 3;    cycle.time(o4, work);    position(o4, 11, 58);    draw(o4);    set.view(o1, vEgoSeahorseDive);    ignore.objs(o1);    ignore.horizon(o1);    work = 4;    step.time(o1, work);    position(o1, 50, 114);    set.cel(o1, 0);    stop.cycling(o1);    draw(o1);    erase(o3);    erase(o2);    sound(mMermaid, f233);    show.pic();    v224 = 1;    clear.lines(22, 24, BLACK);    display(22, 0, "Along the way you'll frolic by the sea\nwith a mermaid.  "            "But don't get too\nfriendly, mermaids can be very fickle!");    }  if (v224 == 1)    {    move.obj(o1, 26, 90, 1, f220);    }  if (v224 == 2)    {    move.obj(o1, 18, 82, 1, f220);    }  if (v224 == 3)    {    set.view(o4, vMermaidDive);    position(o4, 11, 58);    set.cel(o4, 0);    end.of.loop(o4, f228);    }  if (v224 == 4)    {    if (isset(f220))      {      reset(f220);      }    if (isset(f228))      {      set(f220);      }    }  if (v224 == 5)    {    reset(f220);    if (isset(f233))      {      work = 83;      discard.pic(work);      ++v220;      set(f222);      }    }  if (isset(f220))    {    ++v224;    }  }if (v220 == 4)  {  if (isset(f222))    {    reset(f222);    work = 84;    draw.pic(work);    erase(o1);    add.to.pic(vDracCoffin, 0, 3, 65, 91, 0, 4);    animate.obj(o5);    set.view(o5, vDracula);    position(o5, 114, 113);    draw(o5);    animate.obj(o1);    set.view(o1, vKQEgo);    position(o1, 100, 113);    work = 1;    step.time(o1, work);    set.loop(o1, 1);    start.cycling(o1);    draw(o1);    sound(mKQ2BadGuy, f234);    show.pic();    v224 = 1;    roomState = 1;    clear.lines(22, 24, BLACK);    display(22, 0, "You'll need to be valiant (and fast)\nto escape unseemly "            "characters who don't\nappreciate your charm and good looks.");    }  if (v224 == 7 &&       !isset(f238))    {    sound(mKQ2BadGuy, f234);    }  if (v224 == 1)    {    move.obj(o1, 96, 113, 1, f220);    }  if (v224 == 2)    {    move.obj(o1, 69, 140, 1, f220);    }  if (v224 == 3)    {    move.obj(o1, 36, 140, 1, f220);    }  if (v224 == 4)    {    move.obj(o1, 36, 113, 1, f220);    }  if (v224 == 5)    {    move.obj(o1, 69, 113, 1, f220);    }  if (v224 == 6)    {    move.obj(o1, 82, 126, 1, f220);    }  if (v224 == 7)    {    move.obj(o1, 150, 126, 1, f220);    set(f238);    }  if (roomState == 1)    {    move.obj(o5, 96, 113, 1, f221);    }  if (roomState == 2)    {    move.obj(o5, 69, 140, 1, f221);    }  if (roomState == 3)    {    move.obj(o5, 36, 140, 1, f221);    }  if (roomState == 4)    {    move.obj(o5, 36, 113, 1, f221);    }  if (roomState == 5)    {    move.obj(o5, 69, 113, 1, f221);    }  if (roomState == 6)    {    move.obj(o5, 82, 126, 1, f221);    }  if (roomState == 7)    {    move.obj(o5, 150, 126, 1, f221);    }  if (v224 == 8)    {    work = 84;    discard.pic(work);    ++v220;    set(f222);    }  if (isset(f220))    {    ++v224;    }  if (isset(f221))    {    ++roomState;    }  }if (v220 == 5)  {  if (isset(f222))    {    reset(f222);    work = 85;    draw.pic(work);    position(o1, 37, 60);    draw(o1);    animate.obj(o7);    set.view(o7, vLionRoar);    position(o7, 89, 141);    work = 3;    cycle.time(o7, work);    set.cel(o7, 0);    stop.cycling(o7);    draw(o7);    erase(o5);    show.pic();    v223 = 20;    v224 = 1;    clear.lines(22, 24, BLACK);    display(22, 0, "Don't let success go to your head, or\nyou'll become a King "            "fit for a meal!");    }  if (v224 == 1)    {    move.obj(o1, 63, 60, 1, f220);    }  if (v224 == 2)    {    move.obj(o1, 63, 139, 1, f220);    }  if (v224 == 3)    {    move.obj(o1, 82, 139, 1, f220);    }  if (v224 == 4)    {    set.view(o7, vLionEatEgo);    position(o7, 84, 141);    work = 4;    cycle.time(o7, work);    set.cel(o7, 0);    erase(o1);    sound(mKQDeath, f236);    end.of.loop(o7, f229);    }  if (v224 == 5)    {    if (isset(f220))      {      reset(f220);      }    if (isset(f229))      {      set(f220);      }    }  if (v224 == 6)    {    reset(f220);    if (isset(f236))      {      work = 85;      discard.pic(work);      ++v220;      set(f222);      }    }  if (isset(f220))    {    ++v224;    }  if (v223 != 0)    {    --v223;    }  if (v223 == 1)    {    if (v227 < 2)      {      set(f230);      v223 = 0;      ++v227;      }    }  if (isset(f230))    {    end.of.loop(o7, f231);    sound(sRoar, f235);    reset(f230);    }  if (isset(f231))    {    set.cel(o7, 0);    stop.cycling(o7);    reset(f231);    v223 = 35;    }  }if (v220 == 6)  {  if (isset(f222))    {    reset(f222);    work = 82;    draw.pic(work);    draw(o2);    draw(o3);    stop.cycling(o3);    animate.obj(o8);    set.view(o8, vValBride);    set.loop(o8, 1);    ignore.objs(o8);    position(o8, 116, 155);    work = 2;    cycle.time(o8, work);    stop.cycling(o8);    draw(o8);    set.view(o1, vEgoGroom);    set.loop(o1, 1);    position(o1, 110, 155);    work = 2;    cycle.time(o1, work);    stop.cycling(o1);    draw(o1);    reset(f220);    reset(f225);    reset(f226);    reset(f227);    erase(o7);    sound(mLoveTheme, f237);    show.pic();    clear.lines(22, 24, BLACK);    display(22, 0, "But if you find yourself a princess,\nyou'll return to "            "Daventry and \n(what else?) live happily ever after.");    v224 = 0;    v223 = 20;    }  if (v223 != 0)    {    --v223;    }  if (v223 == 1)    {    set(f225);    v223 = 0;    }  if (isset(f225))    {    reset(f225);    work = 4;    cycle.time(o3, work);    end.of.loop(o3, f226);    }  if (isset(f226))    {    reset(f226);    set(f220);    }  if (v224 == 1)    {    start.cycling(o1);    start.cycling(o8);    move.obj(o8, 116, 116, 1, f221);    move.obj(o1, 110, 116, 1, f220);    }  if (v224 == 2)    {    stop.update(o1);    stop.update(o8);    reset(f220);    reverse.cycle(o3);    current.cel(o3, v226);    if (v226 == 0)      {      stop.cycling(o3);      set(f227);      set(f220);      }    }  if (v224 == 3)    {    work = 82;    discard.pic(work);    ++v220;    v223 = 75;    }  if (isset(f220))    {    ++v224;    }  }if (v220 == 7)  {  if (v223 != 0)    {    --v223;    }  if (v223 == 1)    {    new.room(rmDemoSelect);    }  }return();[ Messages#message 81 "King's Quest II - Romancing The Throne\n     (c) 1987 Sierra On-Line, Inc."#message 82 "Return to Daventry for the second\nchapter of the King's Quest saga.\nYour Quest:  Find a princess."#message 83 "Along the way you'll frolic by the sea\nwith a mermaid.  But don't get too\nfriendly, mermaids can be very fickle!"#message 84 "You'll need to be valiant (and fast)\nto escape unseemly characters who don't\nappreciate your charm and good looks."#message 85 "Don't let success go to your head, or\nyou'll become a King fit for a meal!"#message 86 "But if you find yourself a princess,\nyou'll return to Daventry and \n(what else?) live happily ever after."